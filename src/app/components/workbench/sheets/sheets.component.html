@if(isEmbedSDK){
    <div class="sheet-search">
        <div class="">
        </div>
        <div *ngIf="table &&(draggedRows?.length > 0 || draggedColumns?.length > 0 )" class="input-group mt-1 p-1 sheet-table-search">
            <input type="text" placeholder="Search" aria-describedby="button-addon2" [(ngModel)]="tableChartSearch" (keyup.enter)="tableDisplayPaginationSearch()" class="form-control border-end-0 ">
            <button type="button" id="button-addon2" class="btn btn-primary border me-2 search-icon-border-radius" (click)="tableDisplayPaginationSearch()" >
            <i class="fe fe-search"></i></button>
        </div>
       </div>
     <div class="card-body p-1 parent-table-card" >
        <!-- @for(tab of tabs;track tab; let index = $index){ -->
           
            <!-- @if((tab.sheet_name || tab) === sheetName){ -->
              
                <div class="body table-responsive sheet-table-responsive" id="pdfcontainer" #pdfcontainer>
                    
                    @if(table && chartId){
                    <table>
                        <thead>
                          <tr>
                            @for(column of tableColumnsDisplay;track column){
                            <th [ngStyle]="{ 'font-family': headerFontFamily, 'font-style': headerFontStyle, 'text-decoration': headerFontDecoration, 
                            'color': headerFontColor, 'text-align': headerFontAlignment, 'font-weight': headerFontWeight, 'font-size': headerFontSize }">{{ column }}
                                <!-- <span class=" p-1" style="float: inline-end;" ngbDropdown>
                                    <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button" ngbDropdownToggle
                                      aria-haspopup="true" aria-expanded="false" class=""><i
                                        class="fe fe-more-vertical fs-18 text-body-secondary"></i>
                                    </a>
                                    <div class="dropdown-menu" ngbDropdownMenu>
                                      <button class="dropdown-item" (click)="tableColumnSort('default', column)">Default</button>
                                      <button class="dropdown-item" (click)="tableColumnSort('ascending', column)">Ascending</button>
                                      <button class="dropdown-item" (click)="tableColumnSort('descending', column)">Descending</button>
                                    </div>
                                </span> -->
                            </th>
                            }
                          </tr>
                        </thead>
                        <tbody>
                        <tr *ngFor="let row of (tableDataDisplay| paginate: { itemsPerPage: itemsPerPage,
                                                    currentPage: page,
                                                    totalItems: totalItems }) ; let i = index"
                            [ngClass]="bandingSwitch ? (i % 2 === 0 ? 'even-row' : 'odd-row') : ''"
                            [ngStyle]="{ 'background-color': (i % 2 === 0 ? color1 : color2) }">
                            @for(column of tableColumnsDisplay;track column){
                            <td [ngStyle]="{ 'font-family': tableDataFontFamily, 'font-weight': tableDataFontWeight, 'font-style': tableDataFontStyle, 'text-decoration': tableDataFontDecoration, 
                            'color': tableDataFontColor, 'text-align': tableDataFontAlignment, 'font-size': tableDataFontSize }">{{row[column] | formatMeasure : decimalPlaces : prefix : suffix : displayUnits }}</td>
                            }
                        </tr>
                        
                        </tbody>
                      </table>
                      <pagination-controls *ngIf="table &&(draggedRows?.length > 0 || draggedColumns?.length > 0 )" previousLabel="Prev" nextLabel="Next" (pageChange)="pageChangeTableDisplay((page = $event))"></pagination-controls>
                    }
                    @if(pivotTable && chartId){
                        <div id="pivotTableContainer" #pivotTableContainer></div>                                }
                    @if(kpi && chartId){
                        <div class="big-number-container">
                            <!-- @for(data of tablePreviewRow;track data){ -->
                                <h1 class="big-number" [style.font-size]="getFontSize()" [style.color]="kpiColor">{{ KPINumber }}</h1>
                            <!-- } -->
                        </div>
                    }
 </div>
<!-- <app-custom-sheets
[table]="table"
[chartId]="chartId"
[kpi]="kpi"
[KPINumber]="KPINumber"
[kpiColor]="kpiColor"
[kpiFontSize]="kpiFontSize"
                          [tableColumnsDisplay]="tableColumnsDisplay"
                          [tableDataDisplay]="tableDataDisplay"
                          [itemsPerPage]="itemsPerPage"
                          [page]="page"
                          [totalItems]="totalItems"
                          [bandingSwitch]="bandingSwitch"
                          [color1]="color1"
                          [color2]="color2"
                          [headerFontFamily]="headerFontFamily"
                          [headerFontStyle]="headerFontStyle"
                          [headerFontDecoration]="headerFontDecoration"
                          [headerFontColor]="headerFontColor"
                          [headerFontAlignment]="headerFontAlignment"
                          [headerFontWeight]="headerFontWeight"
                          [headerFontSize]="headerFontSize"
                          [tableDataFontFamily]="tableDataFontFamily"
                          [tableDataFontWeight]="tableDataFontWeight"
                          [tableDataFontStyle]="tableDataFontStyle"
                          [tableDataFontDecoration]="tableDataFontDecoration"
                          [tableDataFontColor]="tableDataFontColor"
                          [tableDataFontAlignment]="tableDataFontAlignment"
                          [tableDataFontSize]="tableDataFontSize"
                          [decimalPlaces]="decimalPlaces"
                          [prefix]="prefix"
                          [suffix]="suffix"
                          [displayUnits]="displayUnits"
                          [draggedRows]="draggedRows"
                          [draggedColumns]="draggedColumns"
                          (pageChange)="pageChangeTableDisplay($event)">
                        </app-custom-sheets> -->
<!-- } -->
<!-- }-->
     </div>
} @else {
<div class="main-container container-fluid mt-5"> 
    <div class="row sheets-page-fixed">
        <div class="col-xxl-2 col-xl-2 col-lg-3 col-md-3 p-1 mt-3">
            <div class="card mb-0 border rounded-3 p-0 ConnectionsCardHeight" >
                <div class="card-body p-0 ">
                    <div class=" mb-0 p-2 br-0 border-bottom">
                        <div class="d-flex align-items-center justify-content-between ">
                            <h6 class="mb-0">Connections</h6>
                            <app-insights-button *ngIf="qrySetId" [buttonName]="'Edit'" [classesList]="'add-txt text-info'" [previledgeId]="2" [isBtn]="false"
                            (btnClickEvent)="goToDataSource()" [isIcon]="false"></app-insights-button>
                            <app-insights-button *ngIf="!qrySetId" [buttonName]="'Add'" [classesList]="'add-txt text-info'" [isIcon]="false" [previledgeId]="1" [isBtn]="false"
                            (btnClickEvent)="goToConnections()"></app-insights-button>
                        </div>
                        </div>
                        <div class=" mb-0 p-2 br-0 ">
                            <h6 class="mb-0">Database</h6>
                            <p class="mb-0" [ngbTooltip]="database_name?.length > 15 ? database_name : null">{{database_name?.length > 15 ? (database_name| slice:0:15)+'...':database_name}}</p>
                        </div>
                </div>
                <div class="card-body p-1">
                    <div class="input-group justify-content-between">
                    <h6 class="mb-0 p-1">Tables</h6>

                    <div class="dashboard-option">
                        <div class=" p-1" ngbDropdown [autoClose]="false" #level1="ngbDropdown">
                            <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button" ngbDropdownToggle
                                aria-haspopup="true" aria-expanded="false" class="" ><i
                                    class="fe fe-more-vertical fs-18 text-body-secondary"></i>
                            </a>
                            <div class="dropdown-menu" ngbDropdownMenu>
                                <div class="" ngbDropdown [autoClose]="false" #level2="ngbDropdown">
                                <a class="dropdown-item btn-primary-light" ngbDropdownToggle href="javascript:void(0);" (click)="addCalculatedField();" > {{isEditCalculatedField ? "Edit Calculated Field" : "Add Calculated Field"}} </a>
                                <div class="dropdown-menu Semantic-layer-card" ngbDropdownMenu>
                                    <!-- <div class="col-lg-12 col-md-10 col-sm-10 col-xl-10 p-0"> -->
                                        <div cdkDropList cdkDropListOrientation="horizontal" class="form-control calculated-parent-card" 
                                         
                                    #calculatedfields="cdkDropList" 
                                      
                                        (cdkDropListDropped)="calculatedFieldsDrop($event)">
                                            
                                            <div class="calculated-child-card">
                                                <div class="col-lg-12 col-md-12 p-0 m-0">
                                                    <div class="d-flex">
                                                        <div class="col-6 p-0">
                                                            <input type="text" placeholder="Calculated Field Name" [(ngModel)]="calculatedFieldName"
                                                            class="mb-1 form-control checkbox-color">
                                                        </div>
                                                        <div class="col-6 p-0">
                                                            <div class="input-group mb-1">
                                                                <div class="col-lg-6 col-md-6 p-0">
                                                                    <select class="form-select form-select select2 fs-14" [(ngModel)]="calculatedFieldFunction"
                                                                        (change)="calculatedFieldData()">
                                                                        <option [disabled]="true" value="">select Type</option>
                                                                        <option value="number">Number</option>
                                                                        <option value="string">String</option>
                                                                        <option value="arithematic">Arithmetic operation</option>
                                                                        <option value="date">Date</option>
                                                                        <option value="logical">Logical</option>
                                                                        <option value="aggregation">Aggregate</option>
                                                                        <option value="typeconversions">Type Conversions</option>
                                                                        <option value="Custom">Custom</option>
                                                                    </select>
                                                                </div>
                                                                <div *ngIf="calculatedFieldFunction === 'logical' || calculatedFieldFunction === 'number' || calculatedFieldFunction === 'string' || calculatedFieldFunction === 'date' || calculatedFieldFunction === 'aggregation' || calculatedFieldFunction === 'typeconversions'" class="col-lg-6 col-md-6 p-0">
                                                                    <select class="form-select form-select select2 fs-14" [(ngModel)]="nestedCalculatedFieldData"
                                                                        (change)="nestedCalculatedFieldFunction()">
                                                                        <option [disabled]="true" value="">select function</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'number'" value="abs">ABS</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'number'" value="ceiling">CEILING</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'number'" value="floor">FLOOR</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'number'" value="round">ROUND</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'number'" value="zn">ZN</option>


                                                                        <option *ngIf="calculatedFieldFunction === 'logical'" value="ifnull">IF NULL</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'logical'" value="case">CASE</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'logical'" value="ifelse">IF ELSE/ELSEIF</option>

                                                                        <option *ngIf="calculatedFieldFunction === 'aggregation'" value="average">AVG</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'aggregation'" value="count">COUNT</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'aggregation'" value="countd">COUNTD</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'aggregation'" value="max">MAX</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'aggregation'" value="min">MIN</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'aggregation'" value="sum">SUM</option>
                                            
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="left">LEFT</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="right">RIGHT</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="mid">MID</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="length">LENGTH</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="trim">TRIM</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="upper">UPPER</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="lower">LOWER</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="replace">REPLACE</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="split">SPLIT</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="find">FIND</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="concat">CONCAT</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="contains">CONTAINS</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="proper">PROPER</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="startswith">STARTSWITH</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="endswith">ENDSWITH</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="regexp_extract">REGEXP_EXTRACT</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="regexp_matches">REGEXP_MATCHES</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'string'" value="regexp_replace">REGEXP_REPLACE</option>

                                            
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="dateadd">DATEADD</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="datediff">DATEDIFF</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="datepart">DATEPART</option>

                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="datename">DATENAME</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="datetrunc">DATETRUNC</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="day">DAY</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="datemax">MAX</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="datemin">MIN</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="month">MONTH</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="quarter">QUARTER</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="week">WEEK</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="year">YEAR</option>


                                                                        <option *ngIf="calculatedFieldFunction === 'typeconversions'" value="date">DATE</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'typeconversions'" value="datetime">DATETIME</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'typeconversions'" value="float">FLOAT</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'typeconversions'" value="int">INT</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'typeconversions'" value="makedate">MAKEDATE</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'typeconversions'" value="str">STR</option>



                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="now">NOW</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="today">TODAY</option>
                                                                        <option *ngIf="calculatedFieldFunction === 'date'" value="parse">PARSE</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-12 col-md-12 p-0 m-0">
                                                        <div class="form-group p-0 mb-0">
                                                            <!-- <label class="form-label mb-2">Calculated Field Name <span class="text-red">*</span></label> -->
                                                            <div class="d-flex">
                                                                <div class="col-6 p-0">
                                                                    <textarea #sqlEditor [readonly]="nestedCalculatedFieldData == 'now' || nestedCalculatedFieldData == 'today'"
                                                                    (keydown)="onTextAreaKeyUp($event)"
                                                                    (click)="updateCaretPosition()"
                                                                    (blur)="hideSuggestions()"
                                                                        class="query-text mb-1 px-3" [(ngModel)]="calculatedFieldLogic" [style.width]="calculationfieldid.hidden ? '195%' : '100%'"
                                                                        placeholder="Drop Column or Enter Logic"></textarea>
                                                                        <ul *ngIf="filteredSuggestions.length && showSuggestions"
                                                                        class="suggestions-dropdown"
                                                                        [style.top.px]="caretTop"
                                                                        [style.left.px]="caretLeft">
                                                                        <li *ngFor="let suggestion of filteredSuggestions; let i = index"
                                                                        (mousedown)="selectSuggestion(suggestion)"
                                                                        [class.selected]="i === selectedSuggestionIndex">
                                                                      {{ suggestion.display }}
                                                                    </li>
                                                                    </ul>
                                                                </div>
                                                                <div #calculationfieldid [hidden]="true" class="col-6 p-0 d-flex">
                                                                    <div class="calculated-hide-card bg-light mb-1 border rounded-2 d-flex">
                                                                        <!-- <div class="calculated-hide-icon d-flex align-items-center">
                                                                            <i class="fa fa-angle-right"></i>
                                                                        </div> -->
                                                                        <div class="mb-0 p-2 description-text">
                                                                            @if(nestedCalculatedFieldData == 'abs'){
                                                                                <span > <p class="fw-600 mb-0">ABS(number) :<br> </p> Returns the absolute value.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> ABS("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  ABS(-2) = 2 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'ceiling'){
                                                                                <span > <p class="fw-600 mb-0">CEILING(number) :<br> </p> Rounds up to the nearest integer.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> CEILING("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  CEILING(2.63) = 3 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'floor'){
                                                                                <span > <p class="fw-600 mb-0">FLOOR(number) :<br> </p> Rounds down to the nearest integer.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> FLOOR("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  FLOOR(2.65) = 2 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'round'){
                                                                                <span > <p class="fw-600 mb-0">ROUND(number, [decimals]) :<br> </p> Rounds to a specified number of decimals.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> ROUND("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  ROUND(2.65,1) = 2.6 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'zn'){
                                                                                <span > <p class="fw-600 mb-0">ZN(number) :<br> </p> Returns the value if exists else return 0 for null values.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> ZN("tablename"."column_name", [decimals])</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> ZN(2)=2 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'ifnull'){
                                                                                <span > <p class="fw-600 mb-0">IFNULL(expression1, expression2) :<br> </p> Returns the first non-null expression.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> COALESCE("tablename"."column_name", 0)</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  COALESCE("finance"."Amount", 0) </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'case'){
                                                                                <span > <p class="fw-600 mb-0">CASE :<br> </p> executes conditional logical expression.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> CASE expression WHEN value THEN result ELSE default END</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  case  when "finance"."Amount" > 0 then 1 else 0 end </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'ifelse'){
                                                                                <span> <p class="fw-600 mb-0">IF / ELSE IF :<br></p>Executes conditional logic with if-else branching.</span><br><br>
                                                                                <span><p class="fw-600 mb-0">Syntax :<br></p> IF condition THEN result ELSE IF condition THEN result ELSE default END</span> <br><br>
                                                                                <span><p class="fw-600 mb-0">Example :<br></p>IF "finance"."Amount" > 1000 THEN 'High' ELSEIF "finance"."Amount" > 0 THEN 'Medium' ELSE 'Low' END </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'average'){
                                                                                <span > <p class="fw-600 mb-0">AVG(expression) :<br> </p> Returns the average.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> AVG("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  AVG("finance"."Amount") </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'count'){
                                                                                <span > <p class="fw-600 mb-0">COUNT(string) :<br> </p> Counts total number of non-null values.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> COUNT("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  COUNT("finance"."Name") </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'countd'){
                                                                                <span > <p class="fw-600 mb-0">COUNTD(string) :<br> </p> Counts distinct values.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> COUNT( DISTINCT "tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  COUNT(DISTINCT "finance"."Name") </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'max'){
                                                                                <span > <p class="fw-600 mb-0">MAX(expression) :<br> </p> Returns the maximum value.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> MAX("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  MAX("finance"."Amount")  </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'min'){
                                                                                <span > <p class="fw-600 mb-0">MIN(expression) :<br> </p> Returns the minimum value.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> MIN("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  MIN("finance"."Amount")  </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'sum'){
                                                                                <span > <p class="fw-600 mb-0">SUM(expression) :<br> </p> Returns the total sum.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> SUM("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  SUM("finance"."Amount")  </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'left'){
                                                                                <span > <p class="fw-600 mb-0">LEFT(string, number) :<br> </p> Returns the specified number of characters from left part of a string.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> LEFT("Tablename"."column_name", number)</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  LEFT('Electronics',3)=Ele </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'right'){
                                                                                <span > <p class="fw-600 mb-0">RIGHT(string, number) :<br> </p> Returns the specified number of characters from right part of a string.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> RIGHT("Tablename"."column_name", number)</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  RIGHT('Electronics',3)=ics </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'mid'){
                                                                                <span > <p class="fw-600 mb-0">substring(string, [from int], [for int]) :<br> </p> Extracts part of a string by giving starting position and the length of the string.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> substring("Tablename"."column_name" from [int] for [int])</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  substring('electronics' from 1 for 3)=ele </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'length'){
                                                                                <span > <p class="fw-600 mb-0">LENGTH(string) :<br> </p> Returns the length of a string.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> LENGTH("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  LENGTH('electronics') = 12 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'trim'){
                                                                                <span > <p class="fw-600 mb-0">TRIM(string) :<br> </p> Removes spaces at the beginning and end of a string.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> TRIM("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  TRIM('   electronics   ') = 'electronics' </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'upper'){
                                                                                <span > <p class="fw-600 mb-0">UPPER(number) :<br> </p>  Converts a string to uppercase.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> UPPER("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  UPPER('electronics') = ELECTRONICS </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'lower'){
                                                                                <span > <p class="fw-600 mb-0">LOWER(number) :<br> </p>  Converts a string to lowercase.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> LOWER("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  LOWER('ELECTRONICS') = electronics </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'replace'){
                                                                                <span > <p class="fw-600 mb-0">REPLACE(string, substring, replacement) :<br> </p> Replaces occurrences of substring with replacement.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> REPLACE("tablename"."column_name", substring, replacement)</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  REPLACE('I will do it', 'will do', 'did') = I did it </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'split'){
                                                                                <span > <p class="fw-600 mb-0">split_part(string text, delimiter text, field int) :<br> </p> Splits a given string at a specified character and returns the requested part.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> split_part("Tablename"."column_name", '$',[int])</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  split_part('I will$do it', '$',2) = do it </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'find'){
                                                                                <span > <p class="fw-600 mb-0">position(substring in string) :<br> </p> Returns the position of the first occurrence of substring.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> POSITION([string] in "tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> POSITION('ctr' IN 'electronics') = 4 </span>
                                                                            }

                                                                            @if(nestedCalculatedFieldData == 'concat'){
                                                                                <span > <p class="fw-600 mb-0">CONCAT(Concatenate strings) :<br> </p> Concatenates First Name and Last Name with a space in between.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> CONCAT("tablename"."column_name1",'_',"tablename"."column_name2")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> CONCAT('Test','_',123) = Test_123 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'contains'){
                                                                                <span > <p class="fw-600 mb-0">CONTAINS (Check if substring exists) :<br> </p> Returns true if the sub string exists.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> CONTAINS("tablename"."column_name",substring)</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> CONTAINS('electronics', 'tronic') = true </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'proper'){
                                                                                <span > <p class="fw-600 mb-0">PROPER(Capitalize first letter of each word):<br> </p> Capitalizes first letter of each word.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> PROPER("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> PROPER(TEST) = Test </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'startswith'){
                                                                                <span > <p class="fw-600 mb-0">STARTSWITH (Checks if substring starts with) :<br> </p> Returns true if the string starts with the substring(BOOLEAN) .</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> STARTSWITH("tablename"."column_name",substring)</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> STARTSWITH('electronics','ele') = true </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'endswith'){
                                                                                <span > <p class="fw-600 mb-0">ENDSWITH(Concatenate strings) :<br> </p> Concatenates First Name and Last Name with a space in between.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> ENDSWITH("tablename"."column_name",substring)</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> ENDSWITH('electronics','nics') = true</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'regexp_extract'){
                                                                                <span > <p class="fw-600 mb-0">REGEXP_EXTRACT(STRING, PATTERN) :<br> </p> Returns a substring of a given string that matches the capturing group within the regular expression pattern and requires exactly one capturing group.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> REGEXP_EXTRACT(STRING, PATTERN)</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> REGEXP_EXTRACT('xyz 2134', '[a-z]+\s+(\d+)') =2134</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'regexp_matches'){
                                                                                <span > <p class="fw-600 mb-0">REGEX_MATCHES(STRING, PATTERN):<br> </p> Returns true if a substring of the provided string matches the regular expression pattern.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p>REGEX_MATCHES(STRING, PATTERN)  </span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p><pre>{{ 'REGEXP_MATCH("(123) 456-7890", "^\\d{3}-\\d{3}-\\d{4}$")' }}</pre></span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'regexp_replace'){
                                                                                <span > <p class="fw-600 mb-0">REGEX_REPLACE(STRING, PATTERN,REPLACE) :<br> </p> Returns a copy of the given string where the matching pattern is substituted with the replacement string.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p>REGEX_REPLACE(STRING, PATTERN,REPLACE) </span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>REGEXP_REPLACE("Product_A", "Product_", "Item_") </span>
                                                                            }


                                                                            @if(nestedCalculatedFieldData == 'dateadd'){
                                                                                <span > <p class="fw-600 mb-0">DATEADD (date_field + interval date) :<br> </p> Adds a time interval to a date.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> "tablename"."columnname" + INTERVAL '[int] days' (days/months/years) </span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  current_date + INTERVAL '5 days'(days/months/years)  </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'datediff'){
                                                                                <span > <p class="fw-600 mb-0">DATEDIFF :<br> </p> Returns the difference between two dates.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> "tablename"."column_name" - "tablename"."column_name"</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  CURRENT_DATE - '2024-10-03' </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'datepart'){
                                                                                <span > <p class="fw-600 mb-0">DATEPART(date_part, date) :<br> </p> Returns a part of the date (year, month, day, etc.).</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> DATE_PART('year', "tablename"."column_name")/DATE_PART('month', "tablename"."column_name")/DATE_PART('date', "tablename"."column_name")
                                                                                    </span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  DATE_PART('year', current_timestamp)/DATE_PART('month', current_timestamp)/DATE_PART('date', current_timestamp)
                                                                                </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'datename'){
                                                                                <span > <p class="fw-600 mb-0">DATENAME :<br> </p> Returns a specific part of a date as a string.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> DATENAME('month',"tablename"."column_name" ) </span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  DATENAME('month', "08-04-2025") = April </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'datetrunc'){
                                                                                <span > <p class="fw-600 mb-0">DATETRUNC :<br> </p> Truncates a date to a specified date part (e.g., truncating to the first day of the month).</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> DATETRUNC('year',"tablename"."column_name" ) =Start date of the year</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> DATETRUNC('year', "2023-03-15") = 01-01-2023 00:00:00</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'day'){
                                                                                <span > <p class="fw-600 mb-0">DAY :<br> </p>Extracts the day of the month from a date.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> DAY("tablename"."column_name" ) =Extracts the day of the month from a date.</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> day("2023-04-01") = 1</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'datemax'){
                                                                                <span > <p class="fw-600 mb-0">MAX :<br> </p>Returns the maximum value from a set of values.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> MAX("tablename"."column_name") : highest date will be the output from the records.</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  max("2023-04-01","2023-04-05") =  2023-04-05</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'datemin'){
                                                                                <span > <p class="fw-600 mb-0">MIN :<br> </p>Returns the minimum value from a set of values.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> MIN("tablename"."column_name") : least date will be the output from the records.</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> min("2023-04-01","2023-04-05") =  2023-04-01</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'month'){
                                                                                <span > <p class="fw-600 mb-0">MONTH :<br> </p>Extracts the month (1-12) from a date.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> MONTH("tablename"."column_name") : highest date will be the output from the records.</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  MONTH("2023-04-01") = 4</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'quarter'){
                                                                                <span > <p class="fw-600 mb-0">QUARTER :<br> </p>Returns the quarter (1-4) of the year for a given date.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> QUARTER("tablename"."column_name") : highest date will be the output from the records.</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  max("2023-04-01","2023-04-05") =  2023-04-05</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'week'){
                                                                                <span > <p class="fw-600 mb-0">WEEK :<br> </p>Extracts the week number (1-52/53) from a date.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> WEEK("tablename"."column_name") : Extracts the week number (1-52/53) from a date.</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  WEEK("2023-04-01") = 13 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'year'){
                                                                                <span > <p class="fw-600 mb-0">YEAR :<br> </p>Extracts the year from a date.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> YEAR("tablename"."column_name") :Extracts the year from a date.</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  year("2023-04-01") = 2023 </span>
                                                                            }


                                                                           
                                                                            @if(nestedCalculatedFieldData == 'date'){
                                                                                <span > <p class="fw-600 mb-0">DATE :<br> </p>Converts a string or a number into a date.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> DATE("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  DATE("2023-04-01") = 01-04-2023 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'datetime'){
                                                                                <span > <p class="fw-600 mb-0">DATE :<br> </p>Converts a string or a date into a datetime (includes both date and time).</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> DATETIME("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  DATETIME(2023-04-01 10:30:00)  =01-04-2023 10:30:00 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'float'){
                                                                                <span > <p class="fw-600 mb-0">DATE :<br> </p>Converts a string or integer into a floating-point number.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> FLOAT("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  FLOAT("123.45") =123.5</span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'int'){
                                                                                <span > <p class="fw-600 mb-0">INT :<br> </p>Converts a string or a floating-point number to an integer.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> INT("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  INT(123.45) = 123 </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'makedate'){
                                                                                <span > <p class="fw-600 mb-0">MAKEDATE :<br> </p>Creates a date from year, month, and day values.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> DATE("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  MAKEDATE(2023, 4, 1) = 1 April 2023, MAKEDATE([Year],[Month],[Day]) </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'str'){
                                                                                <span > <p class="fw-600 mb-0">STR :<br> </p>The value (number, date, etc.) to convert into a string.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> STR("tablename"."column_name")</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  STR(123)  =123 </span>
                                                                            }


                                                                           

                                                                            @if(nestedCalculatedFieldData == 'now'){
                                                                                <span > <p class="fw-600 mb-0">NOW :<br> </p> Returns the current date and time.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> NOW()</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> NOW() </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'today'){
                                                                                <span > <p class="fw-600 mb-0">Current_date :<br> </p> Returns the current date without the time.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> CURRENT_DATE </span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p> CURRENT_DATE </span>
                                                                            }
                                                                            @if(nestedCalculatedFieldData == 'parse'){
                                                                                <span > <p class="fw-600 mb-0">dateparse :<br> </p> converts string to date in specific format .</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> TO_CHAR(Tablename.column_name, 'dd-mm-yyyy') </span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example :<br> </p>  TO_CHAR('2024-12-02', 'dd-mm-yyyy') </span>
                                                                            }
                                                                            @if(calculatedFieldFunction == 'arithematic'){
                                                                                <span > <p class="fw-600 mb-0">expression :<br> </p> evaluate the basic mathematical calculations.</span> <br><br>
                                                                                <span > <p class="fw-600 mb-0">Syntax :<br> </p> "tablename"."column_name" + "tablename"."column_name"</span><br><br>
                                                                                <span > <p class="fw-600 mb-0">Example : 2 + 2 = 4<br> </p>   </span>
                                                                            }
                                                                            @if(calculatedFieldFunction == 'Custom'){
                                                                                <span > <p class="fw-600 mb-0"><br> </p>Custom calculated field evaluates multiple conditions using logical operators (AND, OR, IF, CASE) and applies aggregation functions (like SUM, AVG, COUNT, MAX, MIN) to produce a summarized or conditional result</span> <br><br>
                                                                            }
                                                                        </div>
                                                                        
                                                                    </div>
                                                                    <!-- <div class="calculated-hide-icon d-flex align-items-center bg-light rounded-2 border mb-1">
                                                                        <i class="fa fa-angle-left"></i>
                                                                    </div> -->
                                                                </div>
                                                                <div (click)="calculationfieldid.hidden = !calculationfieldid.hidden" [style.pointer-events]="(((calculatedFieldFunction == 'aggregation' || calculatedFieldFunction == 'logical' || calculatedFieldFunction == 'date' || calculatedFieldFunction == 'string' || calculatedFieldFunction == 'number') &&  nestedCalculatedFieldData) || calculatedFieldFunction == 'arithematic' || calculatedFieldFunction == 'Custom' || calculatedFieldFunction == 'typeconversions') ? 'auto' : 'none' " class="calculated-hide-icon d-flex align-items-center bg-light rounded-2 border mb-1 calculated-hide-h">
                                                                    <i *ngIf="calculationfieldid.hidden" class="fa fa-angle-left cursor-pointer"></i>
                                                                    <i *ngIf="!calculationfieldid.hidden" class="fa fa-angle-right cursor-pointer"></i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div *ngIf="validationMessage" class="alert alert-card"
                                                                        [ngClass]="{'alert-success': isValidCalculatedField, 'alert-danger': !isValidCalculatedField}">
                                                                        {{ validationMessage }}
                                                                    </div>
                                                        <div class="mt-0 d-flex gap-2 calculated-footer-btn">
                                                            <div [ngbTooltip]="calculatedFieldLogic && !calculatedFieldName ? 'Enter Name' : null" placement="top" container="body">
                                                            <button
                                                                [disabled]="!(calculatedFieldLogic  && calculatedFieldName && (calculatedFieldLogic.length > 0 || calculatedFieldName.length > 0))"
                                                                class="btn btn-primary mt-0" (click)="applyCalculatedFields(level2,level1);">Apply </button>
                                                            </div>
                                                            <button class="btn btn-secondary mt-0"
                                                                (click)="isEditCalculatedField = false;level1.close();level2.close();calculationfieldid.hidden = true">Close </button>
                                                        </div>
                                                </div>
                                            </div>
                                        </div>             
                                        
                                    <!-- </div> -->
                                    <!-- <button class="dropdown-item filtersBtnWidth" ngbDropdownItem  (click)="test(calculatedfield)"> Create Calculated Field </button> -->
                                   <!-- <a class="dropdown-item" ngbDropdownItem href="javascript:void(0);"> Export</a>
                                    <a class="dropdown-item" ngbDropdownItem href="javascript:void(0);"> Delete</a>-->
                                </div>
                                </div>
                               <!-- <a class="dropdown-item" ngbDropdownItem href="javascript:void(0);"> Export</a>
                                <a class="dropdown-item" ngbDropdownItem href="javascript:void(0);"> Delete</a>-->
                            </div>
                        </div>
                      </div>
                        
                      
                      </div>
                    <div class="input-group">
                        <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="tableSearch"
                            (keyup.enter)="columnsData()" aria-describedby="button-addon2">
                        <button class="btn btn-primary border search-icon-border-radius" (click)="columnsData()" type="button" id="button-addon2"
                            ><i class="fe fe-search "></i></button>
                    </div>
                    <div class="sheet-table-h mt-1">
                        @defer (when tableColumnsData && tableColumnsData.length > 0) {
                            @if(tableColumnsData.length > 0) {
                        @for(columns of tableColumnsData; track columns){
                            @if(!columns.calculated_fields){
                            <div  class="menu-item mb-1">
                                
                            
                            <div class="menu-title" class="example-box bg-light border w-100 menu-title-font-weight py-3"  (click)="toggleSubMenu(columns)">
                                <span class="arrow"> <i *ngIf="!columns.expanded" class="fa fa-chevron-down"></i> <i *ngIf="columns.expanded" class="fa fa-chevron-up"></i>
                                    {{columns.table_alias}} </span>

                              </div>
                              
                              @if(columns.expanded){
                            <div  cdkDropList 
                            #originList="cdkDropList"
                            [cdkDropListData]="columns.dimensions"
                            [cdkDropListConnectedTo]="[calculatedfields,columnList,rowList,drilldownList,measureValuelist]"
                            (cdkDropListDropped)="columndrop($event)"
                            [cdkDropListDisabled]="canDrop" [ngClass]="{'drag-disabled': canDrop}">
                            
                           @for(dimensions of columns.dimensions; track dimensions){
                               <div class="d-flex justify-content-between border border-bottom">
                                <li class="example-box" ngbTooltip="{{dimensions.column}}"
                                (cdkDragStarted)="tableNameMethod(columns.schema,columns.table_name,columns.table_alias)" cdkDrag [cdkDragDisabled]="canDrop" >
                                <span *ngIf="!dateList.includes(dimensions.data_type) && !boolList.includes(dimensions.data_type)" class="abc-txt">abc</span>
                                <span *ngIf="dateList.includes(dimensions.data_type)" class="date-dtype"><i class="fa fa-clock"></i></span>
                                <span *ngIf="boolList.includes(dimensions.data_type)" class="date-dtype" style="font-family: 'Times New Roman', Times, serif; font-style: italic;">T|F</span>
                                {{ dimensions.column?.substr(0,15) }}{{ dimensions.column.length > 15 ? '...' : '' }}
                                </li>
                                <div class="dashboard-option">
                                    <div class=" p-1" ngbDropdown>
                                        <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button" ngbDropdownToggle
                                            aria-haspopup="true" aria-expanded="false" class="" (click)="editFilterCheck(dimensions.column)"><i
                                                class="fe fe-more-vertical fs-18 text-body-secondary"></i>
                                        </a>
                                        <div class="dropdown-menu filtersDropDown" ngbDropdownMenu>
                                            <button *ngIf="!filterAdded" class="dropdown-item filtersBtnWidth btn-primary-light border" ngbDropdownItem  (click)="formatExtractType = ''; filterSearch = ''; activeTabId = 1; defaultRelativeDates(); openSuperScaled(content,dimensions)"> Apply Filters </button>
                                            <a *ngIf="filterAdded" class="dropdown-item btn-primary-light border" ngbDropdownItem  (click)="formatExtractType = ''; editFilterSearch = ''; openSuperScalededitFilter(contentedit,dimensions)"> Edit Filters </a>
                                        </div>
                                    </div>
                                  </div>
                               </div>
                            }
                        </div>
                            <div cdkDropList
                            #originList="cdkDropList"
                            [cdkDropListData]="columns.measures"
                            [cdkDropListConnectedTo]="[calculatedfields,columnList,drilldownList]"
                            (cdkDropListDropped)="rowdrop($event)"
                            [cdkDropListDisabled]="canDrop"  [ngClass]="{'drag-disabled': canDrop}">
                            
                            @for(measures of columns.measures; track measures){ 
                                <div class="example-box1 border m-0 ps-3 pe-0" ngbTooltip="{{measures.column}}" (cdkDragStarted)="tableNameMethod(columns.schema,columns.table_name,columns.table_alias)" cdkDrag [cdkDragDisabled]="canDrop" ># 
                                    {{ measures.column?.substr(0,18) }}{{ measures.column.length > 18 ? '...' : '' }}
                                    <div class="dashboard-option">
                                        <div class=" p-1" ngbDropdown>
                                            <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button" ngbDropdownToggle
                                                aria-haspopup="true" aria-expanded="false" class="" (click)="editFilterCheck(measures.column)"><i
                                                    class="fe fe-more-vertical fs-18 text-body-secondary"></i>
                                            </a>
                                            <div class="dropdown-menu SelectDropDownCard" ngbDropdownMenu>
                                                <a *ngIf="!filterAdded" class="dropdown-item btn-primary-light border" ngbDropdownItem href="javascript:void(0);" (click)="formatExtractType = ''; filterSearch = ''; activeTabId = 1; defaultRelativeDates(); openSuperScaled(content,measures)"> Apply Filters </a>
                                                <a *ngIf="filterAdded" class="dropdown-item btn-primary-light" ngbDropdownItem href="javascript:void(0);" (click)="formatExtractType = ''; editFilterSearch = ''; openSuperScalededitFilter(contentedit,measures)"> Edit Filters </a>
                                            </div>
                                        </div>
                                      </div>
                                </div>
                            }
                            </div>
                      }
                            </div>
                        } @else if(columns.calculated_fields?.length){
                            <div  class="menu-item mb-1">
                                
                            
                                <div class="menu-title" class="example-box border w-100 bg-light py-3" style=" font-weight: 700;" (click)="toggleSubMenu(columns)">
                                    <span class="arrow"> <i *ngIf="!columns.expanded" class="fa fa-chevron-down"></i> <i *ngIf="columns.expanded" class="fa fa-chevron-up"></i>
                                        Calculated Fields </span>
    
                                  </div>
                                  <div cdkDropList
                                  #originList="cdkDropList"
                                  [cdkDropListData]="columns.calculated_fields"
                                  [cdkDropListConnectedTo]="[calculatedfields,columnList,rowList,drilldownList]"
                                  (cdkDropListDropped)="rowdrop($event)"
                                  >  
                                  @if(columns.expanded){    
                                                            
                                @for(measures of columns.calculated_fields; track measures){ 
                                    <div class="example-box1 border m-0 ps-3 pe-0" ngbTooltip="{{measures.field_name}}" (cdkDragStarted)="tableNameMethod(columns.schema,columns.table_name,columns.table_alias)" cdkDrag [cdkDragDisabled]="canDrop" ># 

                                    <!-- <div class="example-box1 border m-0 ps-3 pe-0" ngbTooltip="{{measures.field_name}}" >#  -->
                                        {{ measures.field_name?.substr(0,18) }}{{ measures.field_name.length > 18 ? '...' : '' }}
                                        <div class="dashboard-option">
                                            <div class=" p-1" ngbDropdown>
                                                <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button" ngbDropdownToggle
                                                aria-haspopup="true" aria-expanded="false" class="" (click)="editFilterCheck(measures.field_name)"><i
                                                    class="fe fe-more-vertical fs-18 text-body-secondary"></i>
                                            </a>
                                                <div class="dropdown-menu filtersDropDown" ngbDropdownMenu>
                                                    <button *ngIf="!filterAdded" class="dropdown-item filtersBtnWidth btn-primary-light" ngbDropdownItem  (click)="formatExtractType = ''; filterSearch = ''; activeTabId = 1; defaultRelativeDates(); openSuperScaled(content,measures)"> Apply Filters </button>
                                                    <a *ngIf="filterAdded" class="dropdown-item btn-primary-light border" ngbDropdownItem  (click)="formatExtractType = ''; editFilterSearch = ''; openSuperScalededitFilter(contentedit,measures)"> Edit Filters </a>
                                                    <a class="dropdown-item btn-primary-light border" ngbDropdownItem href="javascript:void(0);" (click)="level1.open();isEditCalculatedField = true;validationMessage = '';fetchCalculatedFields(measures.id);level2.open();"> Edit Calculated Field </a>
                                                    <a class="dropdown-item btn-secondary-light border" ngbDropdownItem href="javascript:void(0);" (click)="deleteCalculationField(measures.id)"> Delete </a>
                                                </div>
                                            </div>
                                          </div>
                                    <!-- </div> -->
                                    </div>
                                }
                                
                          }
                        </div>
                                </div>
                        }
                        }
                        }@else {
                        <p fs-16>No Data Found!</p>
                        }
                        }@placeholder {
                            <div class="text-center my-4">
                            <div class="spinner-border text-primary" role="status"></div>
                            <div>Loading Tables...</div>
                            </div>
                        } @error {
                            <div class="alert alert-danger">Failed to load data.</div>
                        }
                   
                      </div>
                      <ng-template #content let-modal>
                        <div class="modal-header">
                          <h6 class="modal-title">Filters</h6>
                          <button type="button"class="btn-close"aria-label="Close"(click)="isAllSelected = false;modal.dismiss('Cross click')">
                          </button>
                        </div>
                        <div class="modal-body sheet-filter-modal">
                            @if(dateList.includes(filterType)){
                                <div class="card panel panel-primary shadow-none">
                                    <div class="tab-menu-heading tab-menu-heading-boxed">
                                        <div class="tabs-menu-boxed">
                                            <ul ngbNav #nav="ngbNav" [(activeId)]="activeTabId" class="nav panel-tabs fs-14 pb-1" >
                                                <li [ngbNavItem]="1" (click)="formatExtractType = ''; filterSearch = ''; filterDataGet();">
                                                    <a ngbNavLink class="p-3 TabShadow">General</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane active" id="activetabs">
                                                            <div *ngIf="toggleTableSearch" class="d-flex">
                                                                <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="filterSearch"  aria-describedby="button-addon2" >
                                                                <button class="btn btn-primary border me-2 search-icon-border-radius"  type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                            </div>
                                                            <div class="form-check">
                                                                <input type="checkbox" id="selectAll" [(ngModel)]="isAllSelected" (change)="toggleEditAllRows($event)" class="form-check-input">
                                                                <label for="defaultCheck1" class="form-check-label"> Select All </label>
                                                            </div>
                                                            <!-- <div *ngFor="let data of filterData">
                                                                @if(data? data : (boolList.includes(filterType)? true: '')){
                                                                <div class="form-check">
                                                                    <input type="checkbox" name="checkbox" id="defaultCheck1" [checked]="data.selected" class="form-check-input"
                                                                        (click)="filterCheck($event,data.label)">
                                                                    <label for="defaultCheck1" class="form-check-label"> {{data.label}} </label>
                                                                </div>
                                                            }
                                                        </div> -->
                                                        <cdk-virtual-scroll-viewport itemSize="15" class="viewport" style="height: 510px;">
                                                            <div *cdkVirtualFor="let data of filterData | test:filterSearch:'label'; trackBy: trackByFn">
                                                                <div class="form-check d-flex" >
                                                                    <input type="checkbox" [id]="'checkbox' + data.id" [(ngModel)]="data.selected"
                                                                        class="form-check-input" (change)="filterCheck($event, data.label)">
                                                                    <label [for]="'checkbox' + data.id" class="form-check-label">{{ data.label }}</label>
                                                                </div>
                                                            </div>
                                                        </cdk-virtual-scroll-viewport>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                <li [ngbNavItem]="2" (click)="formatExtractType = ''; filterSearch = ''; filterDataGet()">
                                                    <a ngbNavLink class="p-3 TabShadow">Range of dates</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane" id="linktabs">
                                                            <div class="card-body">
                                                                <div class="date-box">
                                                                    <input type="text" id="input" [(ngModel)]="minDate" (keyup.enter)="updateDateRange(true)" (blur)="updateDateRange(true)" class="form-control date-box-width">
                                                                    <input type="text" id="input" [(ngModel)]="maxDate" (keyup.enter)="updateDateRange(true)" (blur)="updateDateRange(true)" class="form-control date-box-width">
                                                                </div>
                                                                <div id="merging-tooltips">
                                                                  <ngx-slider 
                                                                  [(value)]="minValue"
                                                                  [(highValue)]="maxValue"
                                                                  [options]="options"
                                                                  (valueChange)="updateDateRange(false)"
                                                                  (highValueChange)="updateDateRange(false)"
                                                                ></ngx-slider>
                                                                </div>
                                                                <span *ngIf="dateRangeError" class="text-danger"> *Note :- {{dateRangeError}} </span>
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                <li [ngbNavItem]="3" (click)="filterSearch = '';">
                                                    <a ngbNavLink class="p-3 TabShadow">Extract</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane" id="linktabs">
                                                            <div class="card-body p-0">
                                                                <ul *ngIf="!formatExtractType" class="mb-2">
                                                                  <li (click)="formatExtractType = 'year'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Years</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'quarter'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Quaters</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'month'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Months</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'day'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Days</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'week numbers'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Week numbers</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'weekdays'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Weekdays</label>
                                                                  </li>
                                                                </ul>
                                                                <!-- <ul *ngIf="!formatExtractType">
                                                                  <li (click)="formatExtractType = 'count'; filterDataGet()">
                                                                     <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Count</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'count_distinct'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                   <label for="defaultCheck1" class="form-check-label">Count (Distinct)</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'min'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                   <label for="defaultCheck1" class="form-check-label">Minimum</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'max'; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                   <label for="defaultCheck1" class="form-check-label">Maximum</label>
                                                                  </li>
                                                                </ul> -->
                                                                @if(formatExtractType){
                                                                <div class="d-flex" >
                                                                    <button class="btn btn-primary" (click)="formatExtractType = '';filterSearch = '';"><i class="fa fa-long-arrow-left"></i></button>
                                                                    <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="filterSearch" (keyup.enter)="searchFilterList()" aria-describedby="button-addon2" >
                                                                    <button class="btn btn-primary border me-2 search-icon-border-radius" (click)="searchFilterList()" type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                                </div>
                                                                <div *ngFor="let data of filterData">
                                                                    @if(data? data : (boolList.includes(filterType)? true: '')){
                                                                    <div class="form-check">
                                                                        <input type="checkbox" name="checkbox" id="defaultCheck1" [checked]="data.selected" class="form-check-input"
                                                                            (click)="filterCheck($event,data.label)">
                                                                        <label for="defaultCheck1" class="form-check-label"> {{data.label}} </label>
                                                                    </div>
                                                                    }
                                                                </div>
                                                                }
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                <li [ngbNavItem]="5" (click)="relativeDateType = 1;getYearPreview();">
                                                    <a ngbNavLink class="p-3 TabShadow">Relative Dates</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane" id="linktabs">
                                                            <div class="card-body p-0 border rounded-3">
                                                                <div class="d-lg-flex d-block">
                                                                    <div class="border-end">
                                                                        <ul ngbNav #nav="ngbNav" [(activeId)]="relativeDateType" class="nav flex-column nav-pills" id="vertical-tab"
                                                                            role="tablist" aria-orientation="vertical">
                                                                            <li [ngbNavItem]="1" (click)="selectedDateFormat = 'thisYear';getYearPreview()" className="nav-link text-start" id="years-tab"><a ngbNavLink>Years</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="years" role="tabpanel" aria-labelledby="years-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="previousYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousYear" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="previousYear"> Previous Year </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="thisYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisYear" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="thisYear"> This Year </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextYear" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="nextYear"> Next Year </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="yearToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="yearToDate" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="yearToDate"> Year to date</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastYearCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastYearCount" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="lastYearCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastYearCount'" [(ngModel)]="last" (input)="getYearPreview()">
                                                                                                    <label class="form-check-label ms-2"> Years</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextYearCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextYearCount" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="nextYearCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextYearCount'" [(ngModel)]="next" (input)="getYearPreview()">
                                                                                                    <label class="form-check-label ms-2"> Years</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="2" (click)="selectedDateFormat = 'thisQuarter';getQuarterPreview()" className="nav-link text-start" id="quarters-tab"><a ngbNavLink>Quarters</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="quarters" role="tabpanel" aria-labelledby="quarters-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="previousQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousQuarter" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="previousQuarter"> Previous Quarter </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="thisQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisQuarter" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="thisQuarter"> This Quarter </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextQuarter" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="nextQuarter"> Next Quarter </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="quarterToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="quarterToDate" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="quarterToDate"> Quarter to date</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastQuarterCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastQuarterCount" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="lastQuarterCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastQuarterCount'" [(ngModel)]="last" (input)="getQuarterPreview()">
                                                                                                    <label class="form-check-label ms-2"> Quarters</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextQuarterCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextQuarterCount" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="nextQuarterCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextQuarterCount'" [(ngModel)]="next" (input)="getQuarterPreview()">
                                                                                                    <label class="form-check-label ms-2"> Quarters</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="3" (click)="selectedDateFormat = 'thisMonth';getMonthsPreview()" className="nav-link text-start" id="month-tab"><a ngbNavLink>Months</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="month" role="tabpanel" aria-labelledby="month-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="previousMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousMonth" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="previousMonth"> Previous Month </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="thisMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisMonth" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="thisMonth"> This Month </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextMonth" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="nextMonth"> Next Month </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="monthToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="monthToDate" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="monthToDate"> Month to date</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastMonthCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastMonthCount" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="lastMonthCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastMonthCount'" [(ngModel)]="last" (input)="getMonthsPreview()">
                                                                                                    <label class="form-check-label ms-2"> months</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextMonthCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextMonthCount" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="nextMonthCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextMonthCount'" [(ngModel)]="next" (input)="getMonthsPreview()">
                                                                                                    <label class="form-check-label ms-2"> months</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="4" (click)="selectedDateFormat = 'thisWeek';getWeeksPreview()" className="nav-link text-start" id="weeks-tab"><a ngbNavLink>Weeks</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="weeks" role="tabpanel" aria-labelledby="weeks-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="previousWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousWeek" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="previousWeek"> Previous Week </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="thisWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisWeek" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="thisWeek"> This Week </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextWeek" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="nextWeek"> Next Week </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="weekToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="weekToDate" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="weekToDate"> Week to date</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastWeekCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastWeekCount" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="lastWeekCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastWeekCount'" [(ngModel)]="last" (input)="getWeeksPreview()">
                                                                                                    <label class="form-check-label ms-2"> weeks</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextWeekCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextWeekCount" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="nextWeekCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextWeekCount'" [(ngModel)]="next" (input)="getWeeksPreview()">
                                                                                                    <label class="form-check-label ms-2"> weeks</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="5" (click)="selectedDateFormat = 'today';getDaysPreview()" className="nav-link text-start" id="days-tab"><a ngbNavLink>Days</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="days" role="tabpanel" aria-labelledby="days-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="yesterday" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="yesterday" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="yesterday"> Yesterday </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="today" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="today" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="today"> Today </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="tomorrow" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="tomorrow" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="tomorrow"> Tomorrow </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastDaysCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastDaysCount" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="lastDaysCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastDaysCount'" [(ngModel)]="last" (input)="getDaysPreview()">
                                                                                                    <label class="form-check-label ms-2"> days</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextDaysCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextDaysCount" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="nextDaysCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextDaysCount'" [(ngModel)]="next" (input)="getDaysPreview()">
                                                                                                    <label class="form-check-label ms-2"> days</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                            
                                                                    <div class="p-2">
                                                                        <div class="tab-content" id="vertical-tabContent">
                                                                            <div [ngbNavOutlet]="nav"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row p-2">
                                                                <div class="col-xl-5 col-lg-5 col-md-5 d-flex align-items-center">
                                                                    <label class="form-check-label">Preview </label>
                                                                </div>
                                                                <div class="col-xl-7 col-lg-7 col-md-7">
                                                                   <div class="d-flex align-items-center">
                                                                    <input class="form-control" readonly="" disabled="" aria-label="Disabled input example" [(ngModel)]="previewFromDate" type="text">
                                                                    <label class="form-check-label ms-1 me-1">to </label>
                                                                    <input class="form-control" readonly="" disabled="" aria-label="Disabled input example" [(ngModel)]="previewToDate" type="text">
                                                                   </div>
                                                                </div>
                                                            </div>
                                                            <div class="row p-2">
                                                                <div class="col-xl-5 col-lg-5 col-md-5 d-flex align-items-center">
                                                                    <input type="checkbox" id="anchor" class="form-check-input" [(ngModel)]="isAnchor" (change)="setAnchorDate()">
                                                                    <label class="form-check-label" for="anchor"> Anchor relative to </label>
                                                                </div>
                                                                <div class="col-xl-7 col-lg-7 col-md-7">
                                                                    <div class="d-flex align-items-center">
                                                                        <input *ngIf="!isAnchor" type="text" id="input-label" disabled class="form-control w-50 border" value="Today">
                                                                        <input *ngIf="isAnchor" type="date" id="input-label" class="form-control w-50 border" [(ngModel)]="anchorDate" (change)="anchorDateChange()">
                                                                    </div>
                                                                 </div>
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                @if(is_sheet_Embed){
                                                <li [ngbNavItem]="7" (click)="SDKFilterName= '';">
                                                    <a ngbNavLink class="p-3 TabShadow">Embed SDK</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane active" id="activetabs">
                                                                <div class="form-group p-1 mb-0">
                                                                <label class="form-label">Filter Name <span  class="text-red">*</span>
                                                                </label>
                                                                <input type="text" placeholder="" [(ngModel)]="SDKFilterName" class="form-control border">
                                                                </div>
                                                                <div class="form-group p-1 mb-0">
                                                                <label for="embed" class="form-check-label">Embed SDK</label>
                                                                <div *ngIf="isEmbed" class="toggle toggle-sm on mb-0" (click)="isEmbed = !isEmbed">
                                                                    <span></span>
                                                                </div>
                                                                <div *ngIf="!isEmbed" class="toggle toggle-sm off mb-0" (click)="isEmbed = !isEmbed">
                                                                    <span></span>
                                                                </div>
                                                                </div>
                                                            </div>
                                                  </ng-template>
                                                </li>
                                            }
                                            </ul>
                                            <div class="panel-body tabs-menu-body p-0 panel-body-h">
                                                <div class="tab-content">
                                                    <div [ngbNavOutlet]="nav"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }@else{
                                <div class="card panel panel-primary">
                                    <div class="tab-menu-heading tab-menu-heading-boxed">
                                        <div class="tabs-menu-boxed">
                                            <ul ngbNav #nav="ngbNav" [(activeId)]="activeTabId" class="nav panel-tabs fs-14" >
                                                <li [ngbNavItem]="1" (click)="filterSearch = ''; filterDataGet();">
                                                    <a ngbNavLink class="p-3">General</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane active" id="activetabs">
                                                            <div class="d-flex">
                                                                <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="filterSearch"  aria-describedby="button-addon2" >
                                                                <button class="btn btn-primary border me-2 search-icon-border-radius"  type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                            </div>
                                                            <div class="form-check">
                                                                <input type="checkbox" id="selectAll" [(ngModel)]="isAllSelected" (change)="toggleEditAllRows($event)" class="form-check-input">
                                                                <label for="defaultCheck1" class="form-check-label"> Select All </label>
                                                            </div>
                                                          
                                                        
                                                              <cdk-virtual-scroll-viewport  itemSize="10" class="virtual-scroll-container" style="height: 410px;">
                                                                <div *cdkVirtualFor="let data of filterData | test:filterSearch:'label';" class="form-check-container">
                                                                  <div class="form-check">
                                                                    <input type="checkbox" [id]="'defaultCheck' + data.label"
                                                                           [(ngModel)]="data.selected"
                                                                           class="form-check-input"
                                                                           (change)="filterCheck($event, data.label)">
                                                                    <label [for]="'defaultCheck' + data.label" class="form-check-label">
                                                                      {{ data.label }}
                                                                    </label>
                                                                  </div>
                                                                </div>
                                                              </cdk-virtual-scroll-viewport>
                                                              

                                                        </div>
                                                    </ng-template>
                                                </li>
                                                @if( !(dateList.includes(filterType) || integerList.includes(filterType) || filterType == 'calculated') ){
                                                    @if(draggedRows.length === 0){
                                                        <li [ngbNavItem]="4" *ngIf="isTopFilter" [ngbTooltip]="draggedRows.length === 0 ? 'Drop a measure in Row Shelf to Enable.' : ''" container="body" position="top">
                                                            <a ngbNavLink class="p-3" [class.disabled]="draggedRows.length === 0">Top</a>
                                                        </li>
                                                    } @else{
                                                        <li [ngbNavItem]="4" *ngIf="isTopFilter" (click)="filterSearch = ''; filterDataGet()">
                                                            <a ngbNavLink class="p-3">Top</a>
                                                            <ng-template ngbNavContent>
                                                                <div class="tab-pane active" id="activetabs">
                                                                    <div class="filter-options">
                                                                        <!-- <label><input type="radio" name="filter" value="none" />None</label> -->
                                                                        <label><input type="radio" name="filter" value="by-field" checked />By field:</label>
                                                                    </div>
                                                                    <div class="ms-4">
                                                                        <div class="field-options">
                                                                            <select [(ngModel)]="topType">
                                                                              <option value="desc">Top</option>
                                                                              <option value="asc">Bottom</option>
                                                                            </select>
                                                                            <select [(ngModel)] = "topLimit">
                                                                                <option *ngIf="totalDataLength > 0" value="5">5</option>
                                                                                <option *ngIf="totalDataLength > 5" value="10">10</option>
                                                                                <option *ngIf="totalDataLength > 10" value="20">20</option>
                                                                                <option *ngIf="totalDataLength > 20" value="30">30</option>
                                                                                <option *ngIf="totalDataLength > 30" value="40">40</option>
                                                                                <option *ngIf="totalDataLength > 40" value="50">50</option>
                                                                                <option *ngIf="totalDataLength > 50" value="100">100</option>
                                                                                <option *ngIf="totalDataLength > 100" value="500">500</option>
                                                                                <option *ngIf="totalDataLength > 500" value="1000">1000</option>
                                                                                <option *ngIf="totalDataLength > 1000" value="2000">2000</option>
                                                                                <option *ngIf="totalDataLength > 2000"value="3000">3000</option>
                                                                                <option *ngIf="totalDataLength > 3000" value="4000">4000</option>
                                                                                <option *ngIf="totalDataLength > 4000" value="5000">5000</option>
                                                                              </select>
                                                                            <!-- <input type="number" value="10" /><span>by</span> -->
                                                                        </div>
                                                                        <div class="field-options ">
                                                                            <select class="field-options-width"  [(ngModel)]="selectedTopColumn">
                                                                                <option value="select" selected disabled> select </option>
                                                                                <option *ngFor="let measure of draggedRows" [value]="measure?.column"> {{measure?.column}} </option>
                                                                            </select>
                                                                            <select class="topAggregate-width" [(ngModel)] = "topAggregate" >
                                                                                <option value="sum">Sum</option>
                                                                                <option value="avg">Avg</option>
                                                                                <option value="min">Min</option>
                                                                                <option value="max">Max</option>
                                                                                <option value="count">Count</option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </ng-template>
                                                        </li>
                                                    }
                                                }
                                                @if(integerList.includes(filterType)){
                                                    <li [ngbNavItem]="6" (click)="filterSearch = ''; filterDataGet()">
                                                        <a ngbNavLink class="p-3 TabShadow">Range of Values</a>
                                                        <ng-template ngbNavContent>
                                                            <div class="tab-pane" id="linktabs">
                                                                <div class="card-body">
                                                                    <div class="date-box">
                                                                        <input type="number" step="1" id="input" [(ngModel)]="minRangeValueInput" (keyup.enter)="updateMeasureRange(true)" (blur)="updateMeasureRange(true)" class="form-control date-box-width">
                                                                        <input type="number" step="1" id="input" [(ngModel)]="maxRangeValueInput" (keyup.enter)="updateMeasureRange(true)" (blur)="updateMeasureRange(true)" class="form-control date-box-width">
                                                                    </div>
                                                                    <div id="merging-tooltips">
                                                                      <ngx-slider 
                                                                      [(value)]="minRangeValue"
                                                                      [(highValue)]="maxRangeValue"
                                                                      [options]="measureValuesOptions"
                                                                      (valueChange)="updateMeasureRange(false)"
                                                                      (highValueChange)="updateMeasureRange(false)"
                                                                    ></ngx-slider>
                                                                    </div>
                                                                    <span *ngIf="measureRangeError" class="text-danger"> *Note :- {{measureRangeError}} </span>
                                                                </div>
                                                            </div>
                                                        </ng-template>
                                                    </li>
                                                }
                                                @if(is_sheet_Embed){
                                                <li [ngbNavItem]="7" (click)="SDKFilterName= '';">
                                                    <a ngbNavLink class="p-3 TabShadow">Embed SDK</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane active" id="activetabs">
                                                                <div class="form-group p-1 mb-0">
                                                                <label class="form-label">Filter Name <span  class="text-red">*</span>
                                                                </label>
                                                                <input type="text" placeholder="" [(ngModel)]="SDKFilterName" class="form-control border">
                                                                </div>
                                                                <div class="form-group p-1 mb-0">
                                                                <label for="embed" class="form-check-label">Embed SDK</label>
                                                                <div *ngIf="isEmbed" class="toggle toggle-sm on mb-0" (click)="isEmbed = !isEmbed">
                                                                    <span></span>
                                                                </div>
                                                                <div *ngIf="!isEmbed" class="toggle toggle-sm off mb-0" (click)="isEmbed = !isEmbed">
                                                                    <span></span>
                                                                </div>
                                                            </div>
                                                            </div>
                                                  </ng-template>
                                                </li>
                                            }
                                            </ul>
                                            <div class="panel-body tabs-menu-body p-1 panel-body-h">
                                                <div class="tab-content">
                                                    <div [ngbNavOutlet]="nav"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                        <div class="modal-footer">
                            <div class="col text-left p-0" *ngIf="activeTabId === 1">
                                <input type="checkbox" id="exclude" [(ngModel)]="isExclude" class="form-check-input">
                                <label for="exclude" class="form-check-label">Exclude</label>
                            </div>
                            <div class="text-right">
                                <button [disabled]="((activeTabId === 1 || activeTabId === 3) && filterDataArray.size === 0) || (activeTabId === 2 && (filterDateRange.length === 0 || dateRangeError !== '')) || (activeTabId === 6 && ((minRangeValue === null || minRangeValue === undefined || maxRangeValue === null || maxRangeValue === undefined || measureRangeError !== ''))) || (activeTabId === 4 && selectedTopColumn == 'select') || (activeTabId === 5 && !isRelativeDateValid) ||(activeTabId == 7 &&(!SDKFilterName || !isEmbed))" type="button"
                                    class="btn ripple btn-primary me-2" (click)="filterDataPut();isAllSelected = false; modal.dismiss('Cross click')">Apply</button>
                                <button type="button" class="btn ripple btn-secondary" (click)="modal.close('Save click');isAllSelected = false;">
                                    Close
                                </button>
                            </div>
                        </div>
                      </ng-template>

                      <ng-template #contentedit let-modal>
                        <div class="modal-header">
                          <h6 class="modal-title"> Edit Filter</h6>
                          <button type="button"class="btn-close"aria-label="Close"(click)="isAllSelected = false;modal.dismiss('Cross click')">
                          </button>
                        </div>
                        <div class="modal-body edit-filter-modal">

                            @if(dateList.includes(filterType)){
                                <div class="card panel panel-primary">
                                    <div class="tab-menu-heading tab-menu-heading-boxed">
                                        <div class="tabs-menu-boxed">
                                            <ul ngbNav #nav="ngbNav" [(activeId)]="activeTabId" class="nav panel-tabs fs-14" >
                                                <li [ngbNavItem]="1" [class.disabled]="formatExtractType || (activeTabId !== 1)">
                                                    <a ngbNavLink class="p-3">General</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane active" id="activetabs">
                                                            <div class="d-flex">
                                                                <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="editFilterSearch" aria-describedby="button-addon2" >
                                                                <button class="btn btn-primary border me-2 search-icon-border-radius"  type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                            </div>
                                                            <!-- @for(data of filterData;track data){
                                                                @if(data? data : (boolList.includes(filterType)? true: '')){
                                                                    <div class="form-check">
                                                                        <input type="checkbox" name="checkbox" id="defaultCheck1" [(ngModel)]="data.selected" class="form-check-input" (click)="filterCheck($event,data.label)">    
                                                                        <label for="defaultCheck1" class="form-check-label"> {{data.label}} </label>
                                                                    </div>
                                                                }
                                                            } -->
                                                            <cdk-virtual-scroll-viewport itemSize="15" *ngIf="filterData.length > 0" class="virtual-scroll-container" style="height: 410px;">
                                                                <div *cdkVirtualFor="let data of filterData | test:editFilterSearch:'label'; trackBy: trackByFn" class="form-check-container">
                                                                  <div class="form-check">
                                                                    <input type="checkbox" [id]="'defaultCheck' + data.label"
                                                                           [(ngModel)]="data.selected"
                                                                           class="form-check-input"
                                                                           (change)="filterCheck($event, data.label)">
                                                                    <label [for]="'defaultCheck' + data.label" class="form-check-label">
                                                                      {{ data.label }}
                                                                    </label>
                                                                  </div>
                                                                </div>
                                                              </cdk-virtual-scroll-viewport>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                <li [ngbNavItem]="2" [class.disabled]="formatExtractType || (activeTabId !== 2)">
                                                    <a ngbNavLink class="p-3">Range of dates</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane" id="linktabs">
                                                            <div class="card-body">
                                                                <div class="date-box">
                                                                    <input type="text" id="input" [(ngModel)]="minDate" (keyup.enter)="updateDateRange(true)" (blur)="updateDateRange(true)" class="form-control date-box-width">
                                                                    <input type="text" id="input" [(ngModel)]="maxDate" (keyup.enter)="updateDateRange(true)" (blur)="updateDateRange(true)" class="form-control date-box-width">
                                                                </div>
                                                                <div id="merging-tooltips">
                                                                  <ngx-slider 
                                                                  [(value)]="minValue"
                                                                  [(highValue)]="maxValue"
                                                                  [options]="options"
                                                                  (valueChange)="updateDateRange(false)"
                                                                  (highValueChange)="updateDateRange(false)"
                                                                ></ngx-slider>
                                                                </div>
                                                                <span *ngIf="dateRangeError" class="text-danger"> *Note :- {{dateRangeError}} </span>
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                <li [ngbNavItem]="3" [class.disabled]="!formatExtractType || (activeTabId !== 3)">
                                                    <a ngbNavLink class="p-3">Extract</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane" id="linktabs">
                                                            <div class="card-body p-0">
                                                                <ul *ngIf="!formatExtractType" class="mb-2">
                                                                  <li (click)="formatExtractType = 'year'; filterDataArray.clear(); filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Years</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'quarter'; filterDataArray.clear(); filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Quaters</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'month'; filterDataArray.clear(); filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Months</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'day'; filterDataArray.clear(); filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Days</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'week numbers'; filterDataArray.clear(); filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Week numbers</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'weekdays'; filterDataArray.clear(); filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Weekdays</label>
                                                                  </li>
                                                                </ul>
                                                                <!-- <ul *ngIf="!formatExtractType">
                                                                  <li (click)="formatExtractType = 'count'; filterDataArray = []; filterDataGet()">
                                                                     <i class="fa fa-calendar-o me-1"></i>
                                                                    <label for="defaultCheck1" class="form-check-label">Count</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'count_distinct'; filterDataArray = []; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                   <label for="defaultCheck1" class="form-check-label">Count (Distinct)</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'min'; filterDataArray = []; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                   <label for="defaultCheck1" class="form-check-label">Minimum</label>
                                                                  </li>
                                                                  <li (click)="formatExtractType = 'max'; filterDataArray = []; filterDataGet()">
                                                                    <i class="fa fa-calendar-o me-1"></i>
                                                                   <label for="defaultCheck1" class="form-check-label">Maximum</label>
                                                                  </li>
                                                                </ul> -->
                                                                @if(formatExtractType){
                                                                    <div class="d-flex">
                                                                        <button class="btn btn-primary" (click)="formatExtractType = '';"><i class="fa fa-long-arrow-left"></i></button>
                                                                        <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="editFilterSearch" (keyup.enter)="editFilterList()" aria-describedby="button-addon2" >
                                                                        <button class="btn btn-primary border me-2 search-icon-border-radius" (click)="editFilterList()" type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                                    </div>
                                                                    @for(data of filterData;track data){
                                                                        @if(data? data : (boolList.includes(filterType)? true: '')){
                                                                            <div class="form-check">
                                                                                <input type="checkbox" name="checkbox" id="defaultCheck1" [(ngModel)]="data.selected" class="form-check-input" (click)="filterCheck($event,data.label)">    
                                                                                <label for="defaultCheck1" class="form-check-label"> {{data.label}} </label>
                                                                            </div>
                                                                        }
                                                                    }
                                                                }
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                <li [ngbNavItem]="5" [class.disabled]="activeTabId !== 5" (click)="relativeDateType = 1;getYearPreview();">
                                                    <a ngbNavLink class="p-3 TabShadow">Relative Dates</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane" id="linktabs">
                                                            <div class="card-body p-0 border rounded-3">
                                                                <div class="d-lg-flex d-block">
                                                                    <div class="border-end">
                                                                        <ul ngbNav #nav="ngbNav" [(activeId)]="relativeDateType" class="nav flex-column nav-pills" id="vertical-tab"
                                                                            role="tablist" aria-orientation="vertical">
                                                                            <li [ngbNavItem]="1" (click)="selectedDateFormat = 'thisYear';getYearPreview()" className="nav-link text-start" id="years-tab"><a ngbNavLink>Years</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="years" role="tabpanel" aria-labelledby="years-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="previousYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousYear" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="previousYear"> Previous Year </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="thisYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisYear" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="thisYear"> This Year </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextYear" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="nextYear"> Next Year </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="yearToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="yearToDate" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="yearToDate"> Year to date</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastYearCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastYearCount" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="lastYearCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastYearCount'" [(ngModel)]="last" (input)="getYearPreview()">
                                                                                                    <label class="form-check-label ms-2"> Years</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextYearCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextYearCount" (change)="getYearPreview()">
                                                                                                    <label class="form-check-label" for="nextYearCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextYearCount'" [(ngModel)]="next" (input)="getYearPreview()">
                                                                                                    <label class="form-check-label ms-2"> Years</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="2" (click)="selectedDateFormat = 'thisQuarter';getQuarterPreview()" className="nav-link text-start" id="quarters-tab"><a ngbNavLink>Quarters</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="quarters" role="tabpanel" aria-labelledby="quarters-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="previousQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousQuarter" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="previousQuarter"> Previous Quarter </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="thisQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisQuarter" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="thisQuarter"> This Quarter </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextQuarter" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="nextQuarter"> Next Quarter </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="quarterToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="quarterToDate" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="quarterToDate"> Quarter to date</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastQuarterCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastQuarterCount" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="lastQuarterCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastQuarterCount'" [(ngModel)]="last" (input)="getQuarterPreview()">
                                                                                                    <label class="form-check-label ms-2"> Quarters</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextQuarterCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextQuarterCount" (change)="getQuarterPreview()">
                                                                                                    <label class="form-check-label" for="nextQuarterCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextQuarterCount'" [(ngModel)]="next" (input)="getQuarterPreview()">
                                                                                                    <label class="form-check-label ms-2"> Quarters</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="3" (click)="selectedDateFormat = 'thisMonth';getMonthsPreview()" className="nav-link text-start" id="month-tab"><a ngbNavLink>Months</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="month" role="tabpanel" aria-labelledby="month-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="previousMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousMonth" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="previousMonth"> Previous Month </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="thisMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisMonth" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="thisMonth"> This Month </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextMonth" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="nextMonth"> Next Month </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="monthToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="monthToDate" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="monthToDate"> Month to date</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastMonthCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastMonthCount" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="lastMonthCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastMonthCount'" [(ngModel)]="last" (input)="getMonthsPreview()">
                                                                                                    <label class="form-check-label ms-2"> months</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextMonthCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextMonthCount" (change)="getMonthsPreview()">
                                                                                                    <label class="form-check-label" for="nextMonthCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextMonthCount'" [(ngModel)]="next" (input)="getMonthsPreview()">
                                                                                                    <label class="form-check-label ms-2"> months</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="4" (click)="selectedDateFormat = 'thisWeek';getWeeksPreview()" className="nav-link text-start" id="weeks-tab"><a ngbNavLink>Weeks</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="weeks" role="tabpanel" aria-labelledby="weeks-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="previousWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousWeek" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="previousWeek"> Previous Week </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="thisWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisWeek" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="thisWeek"> This Week </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextWeek" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="nextWeek"> Next Week </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="weekToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="weekToDate" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="weekToDate"> Week to date</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastWeekCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastWeekCount" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="lastWeekCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastWeekCount'" [(ngModel)]="last" (input)="getWeeksPreview()">
                                                                                                    <label class="form-check-label ms-2"> weeks</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextWeekCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextWeekCount" (change)="getWeeksPreview()">
                                                                                                    <label class="form-check-label" for="nextWeekCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextWeekCount'" [(ngModel)]="next" (input)="getWeeksPreview()">
                                                                                                    <label class="form-check-label ms-2"> weeks</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="5" (click)="selectedDateFormat = 'today';getDaysPreview()" className="nav-link text-start" id="days-tab"><a ngbNavLink>Days</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane " id="days" role="tabpanel" aria-labelledby="days-tab"tabindex="0">
                                                                                        <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                            <div class="previous-year-card">
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="yesterday" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="yesterday" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="yesterday"> Yesterday </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="today" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="today" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="today"> Today </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="tomorrow" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="tomorrow" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="tomorrow"> Tomorrow </label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="lastDaysCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastDaysCount" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="lastDaysCount"> Last</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastDaysCount'" [(ngModel)]="last" (input)="getDaysPreview()">
                                                                                                    <label class="form-check-label ms-2"> days</label>
                                                                                                </div>
                                                                                                <div class="form-check mb-3">
                                                                                                    <input  type="radio" id="nextDaysCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextDaysCount" (change)="getDaysPreview()">
                                                                                                    <label class="form-check-label" for="nextDaysCount"> Next</label>
                                                                                                    <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextDaysCount'" [(ngModel)]="next" (input)="getDaysPreview()">
                                                                                                    <label class="form-check-label ms-2"> days</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                            
                                                                    <div class="p-2">
                                                                        <div class="tab-content" id="vertical-tabContent">
                                                                            <div [ngbNavOutlet]="nav"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row p-2">
                                                                <div class="col-xl-5 col-lg-5 col-md-5 d-flex align-items-center">
                                                                    <label class="form-check-label">Preview </label>
                                                                </div>
                                                                <div class="col-xl-7 col-lg-7 col-md-7">
                                                                   <div class="d-flex align-items-center">
                                                                    <input class="form-control" readonly="" disabled="" aria-label="Disabled input example" [(ngModel)]="previewFromDate" type="text">
                                                                    <label class="form-check-label ms-1 me-1">to </label>
                                                                    <input class="form-control" readonly="" disabled="" aria-label="Disabled input example" [(ngModel)]="previewToDate" type="text">
                                                                   </div>
                                                                </div>
                                                            </div>
                                                            <div class="row p-2">
                                                                <div class="col-xl-5 col-lg-5 col-md-5 d-flex align-items-center">
                                                                    <input type="checkbox" id="anchor" class="form-check-input" [(ngModel)]="isAnchor" (change)="setAnchorDate()">
                                                                    <label class="form-check-label" for="anchor"> Anchor relative to </label>
                                                                </div>
                                                                <div class="col-xl-7 col-lg-7 col-md-7">
                                                                    <div class="d-flex align-items-center">
                                                                        <input *ngIf="!isAnchor" type="text" id="input-label" disabled class="form-control w-50 border" value="Today">
                                                                        <input *ngIf="isAnchor" type="date" id="input-label" class="form-control w-50 border" [(ngModel)]="anchorDate" (change)="anchorDateChange()">
                                                                    </div>
                                                                 </div>
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                @if(is_sheet_Embed){
                                                    <li [ngbNavItem]="7" [class.disabled]="activeTabId !== 7"  (click)="SDKFilterName= '';">
                                                        <a ngbNavLink class="p-3 TabShadow">Embed SDK</a>
                                                        <ng-template ngbNavContent>
                                                            <div class="tab-pane active" id="activetabs">
                                                                    <div class="form-group p-1 mb-0">
                                                                    <label class="form-label">Filter Name <span  class="text-red">*</span>
                                                                    </label>
                                                                    <input type="text" placeholder="" [(ngModel)]="SDKFilterName" class="form-control border">
                                                                    </div>
                                                                    <div class="form-group p-1 mb-0">
                                                                    <label for="embed" class="form-check-label">Embed SDK</label>
                                                                    <div *ngIf="isEmbed" class="toggle toggle-sm on mb-0" (click)="isEmbed = !isEmbed">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!isEmbed" class="toggle toggle-sm off mb-0" (click)="isEmbed = !isEmbed">
                                                                        <span></span>
                                                                    </div>
                                                                </div>
                                                                </div>
                                                      </ng-template>
                                                    </li>
                                                }
                                            </ul>
                                            <div class="panel-body tabs-menu-body p-1 ">
                                                <div class="tab-content">
                                                    <div [ngbNavOutlet]="nav"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }@else{
                                <div class="card panel panel-primary">
                                    <div class="tab-menu-heading tab-menu-heading-boxed">
                                        <div class="tabs-menu-boxed">
                                            <ul ngbNav #nav="ngbNav" [(activeId)]="activeTabId" class="nav panel-tabs fs-14" >
                                                <li [ngbNavItem]="1" [class.disabled]="activeTabId !== 1">
                                                    <a ngbNavLink class="p-3">General</a>
                                                    <ng-template ngbNavContent>
                                                        <div class="tab-pane active" id="activetabs">
                                                            <div class="d-flex">
                                                                <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="editFilterSearch"  aria-describedby="button-addon2" >
                                                                <button class="btn btn-primary border me-2 search-icon-border-radius"  type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                            </div>
                                                            <div class="form-check">
                                                                <input type="checkbox" id="selectAll" [(ngModel)]="isAllSelected" (change)="toggleEditAllRows($event)" class="form-check-input">
                                                                <label for="defaultCheck1" class="form-check-label"> Select All </label>
                                                            </div>
                                                            <!-- <div *ngFor="let data of filterData">
                                                                @if(data? data : (boolList.includes(filterType)? true: '')){
                                                                    <div class="form-check">
                                                                        <input type="checkbox" name="checkbox" id="defaultCheck1" [(ngModel)]="data.selected" class="form-check-input" (click)="filterCheck($event,data.label)">    
                                                                        <label for="defaultCheck1" class="form-check-label"> {{data.label}}</label>
                                                                    </div>
                                                                }
                                                                </div> -->
                                                                <cdk-virtual-scroll-viewport itemSize="15" *ngIf="filterData.length > 0" class="virtual-scroll-container" style="height: 410px;">
                                                                    <div *cdkVirtualFor="let data of filterData | test:editFilterSearch:'label';" class="form-check-container">
                                                                      <div class="form-check">
                                                                        <input type="checkbox" [id]="'defaultCheck' + data.label"
                                                                               [(ngModel)]="data.selected"
                                                                               class="form-check-input"
                                                                               (change)="filterCheck($event, data.label)">
                                                                        <label [for]="'defaultCheck' + data.label" class="form-check-label">
                                                                          {{ data.label }}
                                                                        </label>
                                                                      </div>
                                                                    </div>
                                                                  </cdk-virtual-scroll-viewport>
                                                        </div>
                                                    </ng-template>
                                                </li>
                                                @if( !(dateList.includes(filterType) || integerList.includes(filterType) || filterType == 'calculated') ){
                                                    <li [ngbNavItem]="4" [class.disabled]="activeTabId !== 4">
                                                        <a ngbNavLink class="p-3">Top</a>
                                                        <ng-template ngbNavContent>
                                                            <div class="tab-pane active" id="activetabs">
                                                                <div class="filter-options">
                                                                    <!-- <label><input type="radio" name="filter" value="none" />None</label> -->
                                                                    <label><input type="radio" name="filter" value="by-field" checked />By field:</label>
                                                                </div>
                                                                <div class="ms-4">
                                                                    <div class="field-options">
                                                                        <select [(ngModel)]="topType">
                                                                          <option value="desc">Top</option>
                                                                          <option value="asc">Bottom</option>
                                                                        </select>
                                                                        <select [(ngModel)] = "topLimit">
                                                                            <option *ngIf="totalDataLength > 0" value="5">5</option>
                                                                            <option *ngIf="totalDataLength > 5" value="10">10</option>
                                                                            <option *ngIf="totalDataLength > 10" value="20">20</option>
                                                                            <option *ngIf="totalDataLength > 20" value="30">30</option>
                                                                            <option *ngIf="totalDataLength > 30" value="40">40</option>
                                                                            <option *ngIf="totalDataLength > 40" value="50">50</option>
                                                                            <option *ngIf="totalDataLength > 50" value="100">100</option>
                                                                            <option *ngIf="totalDataLength > 100" value="500">500</option>
                                                                            <option *ngIf="totalDataLength > 500" value="1000">1000</option>
                                                                            <option *ngIf="totalDataLength > 1000" value="2000">2000</option>
                                                                            <option *ngIf="totalDataLength > 2000"value="3000">3000</option>
                                                                            <option *ngIf="totalDataLength > 3000" value="4000">4000</option>
                                                                            <option *ngIf="totalDataLength > 4000" value="5000">5000</option>
                                                                          </select>
                                                                        <!-- <input type="number" value="10" /><span>by</span> -->
                                                                    </div>
                                                                    <div class="field-options">
                                                                        <select class="field-options-width" [(ngModel)]="selectedTopColumn">
                                                                            <option value="select" selected disabled> select </option>
                                                                            <option *ngFor="let measure of draggedRows" [value]="measure?.column"> {{measure?.column}} </option>
                                                                        </select>
                                                                        <select class="topAggregate-width" [(ngModel)] = "topAggregate">
                                                                            <option value="sum">Sum</option>
                                                                            <option value="avg">Avg</option>
                                                                            <option value="min">Min</option>
                                                                            <option value="max">Max</option>
                                                                            <option value="count">Count</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </ng-template>
                                                    </li>
                                                }
                                                @if(integerList.includes(filterType)){
                                                    <li [ngbNavItem]="6" [class.disabled]="activeTabId !== 6">
                                                        <a ngbNavLink class="p-3 TabShadow">Range of Values</a>
                                                        <ng-template ngbNavContent>
                                                            <div class="tab-pane" id="linktabs">
                                                                <div class="card-body">
                                                                    <div class="date-box">
                                                                        <input type="number" step="1" id="input" [(ngModel)]="minRangeValueInput" (keyup.enter)="updateMeasureRange(true)" (blur)="updateMeasureRange(true)" class="form-control date-box-width">
                                                                        <input type="number" step="1" id="input" [(ngModel)]="maxRangeValueInput" (keyup.enter)="updateMeasureRange(true)" (blur)="updateMeasureRange(true)" class="form-control date-box-width">
                                                                    </div>
                                                                    <div id="merging-tooltips">
                                                                      <ngx-slider 
                                                                      [(value)]="minRangeValue"
                                                                      [(highValue)]="maxRangeValue"
                                                                      [options]="measureValuesOptions"
                                                                      (valueChange)="updateMeasureRange(false)"
                                                                      (highValueChange)="updateMeasureRange(false)"
                                                                    ></ngx-slider>
                                                                    </div>
                                                                    <span *ngIf="measureRangeError" class="text-danger"> *Note :- {{measureRangeError}} </span>
                                                                </div>
                                                            </div>
                                                        </ng-template>
                                                    </li>
                                                }
                                                @if(is_sheet_Embed){
                                                    <li [ngbNavItem]="7" [class.disabled]="activeTabId !== 7" >
                                                        <a ngbNavLink class="p-3 TabShadow">Embed SDK</a>
                                                        <ng-template ngbNavContent>
                                                            <div class="tab-pane active" id="activetabs">
                                                                    <div class="form-group p-1 mb-0">
                                                                    <label class="form-label">Filter Name <span  class="text-red">*</span>
                                                                    </label>
                                                                    <input type="text" placeholder="" [(ngModel)]="SDKFilterName" class="form-control border">
                                                                    </div>
                                                                    <div class="form-group p-1 mb-0">
                                                                    <label for="embed" class="form-check-label">Embed SDK</label>
                                                                    <div *ngIf="isEmbed" class="toggle toggle-sm on mb-0" (click)="isEmbed = !isEmbed">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!isEmbed" class="toggle toggle-sm off mb-0" (click)="isEmbed = !isEmbed">
                                                                        <span></span>
                                                                    </div>
                                                                    </div>
                                                                </div>
                                                      </ng-template>
                                                    </li>
                                                }
                                            </ul>
                                            <div class="panel-body tabs-menu-body p-1 panel-body-h">
                                                <div class="tab-content">
                                                    <div [ngbNavOutlet]="nav"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }

                            <!-- <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="editFilterSearch" (keyup.enter)="searchFilterList()" aria-describedby="button-addon2" >
                            <button class="btn btn-primary border me-2" (click)="searchFilterList()" type="button" id="button-addon2" ><i class="fe fe-search "></i></button>
                            @for(data of filterData;track data){
                            <div class="form-check">
                                <input type="checkbox" name="checkbox" id="defaultCheck1" [(ngModel)]="data.selected" class="form-check-input" (click)="filterCheck($event,data.label)">    
                                <label for="defaultCheck1" class="form-check-label"> {{data.label}} </label>
                            </div>
                        } -->
                        </div>
                        <div class="modal-footer">
                            <div class="col text-left p-0" *ngIf="activeTabId === 1">
                                <input type="checkbox" id="exclude" [(ngModel)]="isExclude" class="form-check-input">
                                <label for="exclude" class="form-check-label">Exclude</label>
                            </div>
                            <div class="text-right">
                                <button [disabled]="((activeTabId === 1 || activeTabId === 3) && filterDataArray.size === 0 && !isEmbed) || (activeTabId === 2 && (filterDateRange.length === 0 || dateRangeError !== '')) || (activeTabId === 6 && ((minRangeValue === null || minRangeValue === undefined || maxRangeValue === null || maxRangeValue === undefined || measureRangeError !== ''))) || (activeTabId === 4 && selectedTopColumn == 'select') || (activeTabId === 5 && !isRelativeDateValid)||(activeTabId == 7 &&(!SDKFilterName || !isEmbed))" type="button" class="btn ripple btn-primary me-2"
                                    (click)="filterDataEditPut();isAllSelected = false; modal.dismiss('Cross click')">Apply</button>
                                <button type="button" class="btn ripple btn-secondary" (click)="isAllSelected = false;modal.close('Save click');">
                                    Close
                                </button>
                            </div>
                        </div>
                      </ng-template>
                     
                     
                     
                </div>
                
            </div>
        </div>
        <div class="col-xxl-8 col-xl-8 col-lg-7 col-md-7 p-1 mt-3">
            <div class="ContentAreaCardHeight">
           <div class="card p-0 mb-1 border">
                <div class="card p-0 mb-1 bg-light" style="border: none !important;">
                    <div class="card-body title-padding">
                        <div class="row align-items-center">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xl-12 maind-flex" >
                            <div class="col-lg-8 col-md-8 col-sm-8 p-1" >
                                <div class="title-container border-0 rounded-2" *ngIf="!editor">
                                    <input *ngIf="!retriveDataSheet_id && titleShow && !editor" (click)="editor =true" id="inptele" type="text" placeholder="Sheet Name" aria-label="Sheet" class="form-control" [(ngModel)]="sheetTitle" (input)="sheetNameChange(sheetTitle,$event)">
                                    <span class="card mb-0 SearchBarCu" *ngIf="(retriveDataSheet_id || !titleShow) && !editor" (click)="titleShow =true; editor =true" id="htmlContent" [innerHtml]="sheetTagTitle" [ngStyle]="sheetTagName[0] === '<' ? { 'padding-left': '15px'} : {'padding': '0.8%'}" style="padding-left: 15px;cursor: text;height: 33px;"></span>
                                    <!-- <ckeditor *ngIf="editor" placeholder="Sheet Name" [editor]="Editor" [config]="editorConfig" [(ngModel)]="sheetTagName"></ckeditor> -->
                                    <span class="title-editor" (click)="toggleEditor()">
                                        <button class="btn btn-primary FaFaIconProperties"><i class="fa fa-pencil FaFaIconProperties"></i></button>
                                    </span>
                                </div> 
                                <ckeditor *ngIf="editor" placeholder="Sheet Name" (ready)="$event.editing.view.focus();" [editor]="Editor" [config]="editorConfig" [(ngModel)]="sheetTagName" (ngModelChange)="updateSheetName()"></ckeditor>
                            </div>
                            <div class="col-lg-4 col-md-4 col-sm-4 p-1 d-flex" >
                                <div [class.disabled]="draggedColumnsData.length == 0 && draggedRowsData.length == 0" class="me-1">
                                    <app-insights-button *ngIf="!retriveDataSheet_id" [buttonName]="'Save'" [classesList]="'btn btn-primary update-btn '" [isIcon]="false" [previledgeId]="17" [isBtn]="true"
                                    (btnClickEvent)="(table || kpi || pivotTable) ? sheetSave() : this.isSheetSaveOrUpdate = true; editor=false"></app-insights-button>
                                    <app-insights-button *ngIf="retriveDataSheet_id" [buttonName]="'Update'" [classesList]="'btn btn-primary update-btn '" [isIcon]="false" [previledgeId]="18" [isBtn]="true"
                                    (btnClickEvent)="(table || kpi || pivotTable) ? sheetSave() : this.isSheetSaveOrUpdate = true; editor=false" [ngClass]="{'disabled': sheetTagName.length<1}"></app-insights-button>
                                </div>
                                <div [class.disabled]="draggedColumnsData.length == 0 && draggedRowsData.length == 0" class="me-1">
                                    <!-- <app-insights-button [classesList]="'viewQueryImg'" [previledgeId]="72" [isBtn]="true"
                                        (btnClickEvent)="viewQuery(viewQueryModal)"  [isIcon]="false" [toolTip]="' View Query'"
                                        [ngClass]="{'disabled': sheetTagName.length < 1}" [imageUrl]="'./assets/images/icons/view-query.png'">
                                    </app-insights-button> -->
                                    <button class="viewQueryImg" container="body" ngbTooltip=" View Query" [ngClass]="{'disabled': sheetTagName.length < 1}" (click)="viewQuery(viewQueryModal)"> <img [src]="'./assets/images/icons/view-query.png'" alt="icon" /></button>
                                </div>
                                <button [class.disabled]="draggedColumnsData.length == 0 && draggedRowsData.length == 0" ngbTooltip="clear sheet" placement="bottom" triggers="hover"  type="button" class="btn btn-primary mt-0 me-1 IconProperties" (click)="clearSheetConfirmation();"><img src="./assets/images/icons/erase.png" alt="logo" class="w-4 h-4"></button>
                                <button [disabled]="!retriveDataSheet_id" triggers="hover" ngbTooltip="Refresh" container="body" type="button" class="btn btn-primary mt-0 ps-2 pe-2" (click)="refreshSheetData()"><i class="fa fa-refresh w-4 h-4"></i></button>

                                <!-- More Options Button -->
                                <div ngbDropdown class="ps-1">
                                    <button
                                    class="btn btn-primary mt-0"
                                    type="button"
                                    id="menuOptionsDropdown"
                                    ngbTooltip="Download Options"
                                    triggers="hover"
                                    container="body"
                                    ngbDropdownToggle
                                    [disabled]="!retriveDataSheet_id || (draggedColumnsData.length === 0 && draggedRowsData.length === 0)"
                                    >
                                    <i class="fa fa-download" aria-hidden="true"></i>
                                    </button>
                                    <div ngbDropdownMenu aria-labelledby="menuOptionsDropdown">
                                    <a class="dropdown-item" href="javascript:void(0)" (click)="downloadAsCSV()">Export to CSV</a>
                                    <a class="dropdown-item" href="javascript:void(0)" (click)="downloadAsPDFImage('pdf')">Download as PDF</a>
                                    <a class="dropdown-item" href="javascript:void(0)" (click)="downloadAsPDFImage('png')">Download as Image</a>
                                    <!-- <a class="dropdown-item" href="javascript:void(0)" (click)="downloadAsPDF()">Download as PDF</a>
                                    <a class="dropdown-item" href="javascript:void(0)" (click)="downloadAsImage()">Download Image</a> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
        
                <div class="card-body column-card" (click)="editor =false">
                    <div class="row align-items-center mb-1">
                        <div class="col-lg-2 col-md-2 col-sm-2 col-xl-2 p-0">
                            <div class="card-area d-flex gap-2">
                                <label for="inputName" class="form-control mb-0 column-text border">Columns</label>
                            </div>
                        </div>
                        <div class="col-lg-10 col-md-10 col-sm-10 col-xl-10 p-0" >
                            
                                <div cdkDropList cdkDropListOrientation="horizontal" class="example-list form-control border column-drag-items" 
                                
                                #columnList="cdkDropList" 
                                [cdkDropListData]="draggedColumns" 
                                (cdkDropListDropped)="columndrop($event)"
                                [cdkDropListDisabled]="canDrop"  [ngClass]="{'drag-disabled': canDrop}">
                                    @for(columns of draggedColumns;track columns;let index = $index){
                                    <div class="example-box  example-box-bg" (cdkDragStarted)="dragStartedColumn(index,columns.column)" cdkDrag >
                                        @if(columns.alias){
                                            {{ columns.alias }}
                                        } @else if(columns.type){
                                            {{ columns.type }} ({{columns.column}})
                                        } @else if(columns.field_name) {
                                            {{ columns.field_name }}
                                        } @else {   
                                            {{ columns.column }}
                                        }

                                     <div class="dropup" ngbDropdown style="line-height: 0;">
                                        <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                        <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                            <li  *ngIf="!isDimensionEdit" class="btn btn-primary-light alis-measure-width border" >@if(columns.alias){
                                                {{ columns.alias }}
                                            }
                                            @else if(columns.type){
                                                {{ columns.type }} ({{columns.column}})
                                            }@else if(columns.field_name){
                                                {{ columns.field_name }}
                                            }
                                            @else{   
                                                 {{ columns.column }}
                                            } <i (click)="isDimensionEdit = true;" class="fa fa-pencil ms-1 sum-pencil-icon"></i> </li>
                                            <li  *ngIf="isDimensionEdit"><input (blur)="onColumnAliasChange(columns, index)" type="text" placeholder="Enter Alias Name" [(ngModel)]="columns.alias" class="form-control checkbox-color">
                                            </li>
                                            <div  *ngIf="dateList.includes(columns.data_type)" class="dropup d-flex text-center p-0" ngbDropdown>
                                                <li class="btn btn-primary-light border dropdown-item Date-aggregation" ngbDropdownItem>Date</li>
                                                <i class="btn btn-primary-light border fe fe-chevron-right fs-18 text-body-secondary dropdown-toggle inline-block" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                    <li><a [ngClass]="columns.type === 'year' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'year')">Year (2024)</a></li>
                                                    <li><a [ngClass]="columns.type === 'quarter' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'quarter')">Quarter</a></li>
                                                    <li><a [ngClass]="columns.type === 'month' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'month')">Month (January)</a></li>
                                                    <li><a [ngClass]="columns.type === 'day' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'day')">Day (1-31)</a></li>
                                                    <li><a [ngClass]="columns.type === 'weekdays' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'weekdays')">Week Day (Mon-Sun)</a></li>
                                                    <li><a [ngClass]="columns.type === 'week numbers' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'week numbers')">Week Number (0-52)</a></li>
                                                    <li><a [ngClass]="columns.type === 'year/month/day' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'year/month/day')">Date (year/month/day)</a></li>
                                                    <!-- <li><a class="dropdown-item" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'weekname')">Week Name (Mon-Sun)</a></li> -->
                                                    <li><a [ngClass]="columns.type === '' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormat(columns,index,'')">None</a></li>  
                                                </ul>
                                            </div>
                                            <div  *ngIf="dateList.includes(columns.data_type)" class="dropup d-flex text-center p-0" ngbDropdown >
                                                <li class="btn btn-primary-light border dropdown-item Date-aggregation" ngbDropdownItem>Measure</li>
                                                <i class="btn btn-primary-light border fe fe-chevron-right fs-18 text-body-secondary dropdown-toggle inline-block" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                    <li><a [ngClass]="columns.type === 'min' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregation(columns,index,'min')">Min</a></li>
                                                    <li><a [ngClass]="columns.type === 'max' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregation(columns,index,'max')">Max</a></li>
                                                    <li><a [ngClass]="columns.type === 'count' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregation(columns,index,'count')">Count</a></li>
                                                    <li><a [ngClass]="columns.type === 'count_distinct' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregation(columns,index,'count_distinct')">Count (Distinct)</a></li>
                                                    <li><a [ngClass]="columns.type === '' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregation(columns,index,'')">None</a></li>  
                                                </ul>
                                            </div>
                                            <li><a class="btn btn-secondary-light mx-0 column-remove-btn"  (click)="dragStartedColumn(index,columns.column)"> Remove</a>  </li>
                                        </ul>
                                    </div>
                                        <ng-template #dateFunctionsModal let-modal>
                                            <div class="modal-header">
                                                <h6 class="modal-title">Date Functions</h6>
                                                <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                                                </button>
                                            </div>
                                        
                                            <div class="modal-body sheet-filter-modal">
                                                <div class="card-body p-0">
                                                    <div class="column-card">
                                                        <p class="fw-semibold mb-1 ">Row : {{columns.column}}</p>
                                                    </div>
                                                    <div class="aggregate-card mt-3">
                                                        <p class="fw-semibold mb-1 ">Date Extractions</p>
                                                        <select class="form-control" [(ngModel)]="dateValue" (change)="dateFormat(columns,index,dateValue)">
                                                            <option [selected] value="-Select-">-Select-</option>
                                                            <option value="year">Year (2024)</option>
                                                            <option value="month">Month (January)</option>
                                                            <option value="day">Day (1-31)</option>
                                                            <option value="weekdays">Week Day (1-7)</option>
                                                            <option value="week numbers">Week Number (0-52)</option>
                                                            <option value="weekname">Week Name (Mon-Sun)</option>
                                                            <option value="">None</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn ripple btn-secondary" (click)="modal.close('Save click')">
                                                    Close
                                                </button>
                                            </div>
                                        </ng-template>
                                    </div>
                                    }
                                </div>                                           
                        </div>
                    </div>
                    <div [ngStyle]="{'display': (pivotTable ? '' : 'none')}" class="row align-items-center mb-1">
                        <div class="col-lg-2 col-md-2 col-sm-2 col-xl-2 p-0" style="overflow: auto; white-space: nowrap;">
                           <div class="card-area d-flex gap-2">
                               <label for="inputName" class="form-control mb-0 border">Rows</label>
                           </div> 
                        </div>
                    <div class="col-lg-10 col-md-10 col-sm-10 col-xl-10 p-0">
                            <div cdkDropList cdkDropListOrientation="horizontal" class="example-list form-control border column-drag-items"  
                            #measureValuelist="cdkDropList" 
                            [cdkDropListData]="draggedMeasureValues" 
                            (cdkDropListDropped)="measureValuesdrop($event)">
                                @for(columns of draggedMeasureValues;track columns;let index = $index){
                                <div class="example-box example-box-bg" cdkDrag >
                                    @if(columns.alias){
                                        {{ columns.alias }}
                                    }
                                    @else if(columns.type){
                                        {{ columns.type }} ({{columns.column}})
                                    } @else if(columns.field_name) {
                                        {{ columns.field_name }}
                                    } @else {
                                        {{ columns.column }}
                                    }
                                    <div class="dropup" ngbDropdown style="line-height: 0;">
                                        <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                        <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                            <li  *ngIf="!isPivotRowEdit" class="btn btn-primary-light alis-measure-width border" >@if(columns.alias){
                                                {{ columns.alias }}
                                            }
                                            @else if(columns.type){
                                                {{ columns.type }} ({{columns.column}})
                                            }@else if(columns.field_name){
                                                {{ columns.field_name }}
                                            }
                                            @else{   
                                                 {{ columns.column }}
                                            } <i (click)="isPivotRowEdit = true;" class="fa fa-pencil ms-1 sum-pencil-icon"></i> </li>
                                            <li  *ngIf="isPivotRowEdit"><input (blur)="onPivotRowAliasChange(columns, index)" type="text" placeholder="Enter Alias Name" [(ngModel)]="columns.alias" class="form-control checkbox-color">
                                            </li>
                                            <div  *ngIf="dateList.includes(columns.data_type)" class="dropup d-flex text-center p-0" ngbDropdown>
                                                <li class="btn btn-primary-light border dropdown-item Date-aggregation" ngbDropdownItem>Date</li>
                                                <i class="btn btn-primary-light border fe fe-chevron-right fs-18 text-body-secondary dropdown-toggle inline-block" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                    <li><a [ngClass]="columns.type === 'year' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormatForPivotRow(columns,index,'year')">Year (2024)</a></li>
                                                    <li><a [ngClass]="columns.type === 'quarter' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormatForPivotRow(columns,index,'quarter')">Quarter</a></li>
                                                    <li><a [ngClass]="columns.type === 'month' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormatForPivotRow(columns,index,'month')">Month (January)</a></li>
                                                    <li><a [ngClass]="columns.type === 'day' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormatForPivotRow(columns,index,'day')">Day (1-31)</a></li>
                                                    <li><a [ngClass]="columns.type === 'weekdays' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormatForPivotRow(columns,index,'weekdays')">Week Day (Mon-Sun)</a></li>
                                                    <li><a [ngClass]="columns.type === 'week numbers' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormatForPivotRow(columns,index,'week numbers')">Week Number (0-52)</a></li>
                                                    <li><a [ngClass]="columns.type === 'year/month/day' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormatForPivotRow(columns,index,'year/month/day')">Date (year/month/day)</a></li>
                                                    <li><a [ngClass]="columns.type === '' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateFormatForPivotRow(columns,index,'')">None</a></li>  
                                                </ul>
                                            </div>
                                            <div  *ngIf="dateList.includes(columns.data_type)" class="dropup d-flex text-center p-0" ngbDropdown >
                                                <li class="btn btn-primary-light border dropdown-item Date-aggregation" ngbDropdownItem>Measure</li>
                                                <i class="btn btn-primary-light border fe fe-chevron-right fs-18 text-body-secondary dropdown-toggle inline-block" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                    <li><a [ngClass]="columns.type === 'min' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregationForPivotRow(columns,index,'min')">Min</a></li>
                                                    <li><a [ngClass]="columns.type === 'max' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregationForPivotRow(columns,index,'max')">Max</a></li>
                                                    <li><a [ngClass]="columns.type === 'count' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregationForPivotRow(columns,index,'count')">Count</a></li>
                                                    <li><a [ngClass]="columns.type === 'count_distinct' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregationForPivotRow(columns,index,'count_distinct')">Count (Distinct)</a></li>
                                                    <li><a [ngClass]="columns.type === '' ? 'aggregation-select' : ''" class="dropdown-item Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="dateAggregationForPivotRow(columns,index,'')">None</a></li>  
                                                </ul>
                                            </div>
                                            <li><a class="btn btn-secondary-light mx-0 column-remove-btn"  (click)="removemeasureValuesRow(index,columns)"> Remove</a>  </li>
                                        </ul>
                                    </div>
                                    <!-- <div class="" ngbDropdown style="margin-top: 5px;">
                                        <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button" ngbDropdownToggle
                                            aria-haspopup="true" aria-expanded="false" class=""><i class="fe fe-chevron-down fs-18 text-body-secondary"></i>
                                        <div class="dropdown-menu  cu" ngbDropdownMenu>
                                                <a class="btn btn-secondary-light mx-0"  (click)="removemeasureValuesRow(index,columns)"> Remove</a>     
                                            </div>
                                        </a>
                                </div> -->
                               </div>
                                }
                            </div>             
                            
                        </div>
                    </div>

                    <div class="row align-items-center mb-1">
                        <div class="col-lg-2 col-md-2 col-sm-2 col-xl-2 p-0">
                            <div class="card-area d-flex gap-2">
                                <label *ngIf="!pivotTable" for="inputName" class="form-control mb-0 row-text border">Rows</label>
                                <label *ngIf="pivotTable" for="inputName" class="form-control mb-0 row-text border">Measure Values</label>
                            </div> 
                        </div>
                        <div class="col-lg-10 col-md-10 col-sm-10 col-xl-10 p-0">
                           
                                <div cdkDropList cdkDropListOrientation="horizontal" class="example-list form-control border column-drag-items" 
                                #rowList="cdkDropList" 
                                [cdkDropListData]="draggedRows" 
                                (cdkDropListDropped)="rowdrop($event)"
                                [cdkDropListDisabled]="canDrop"  [ngClass]="{'drag-disabled': canDrop}">
                                    @for(rows of draggedRows;track rows;let index = $index){
                                    <div class="example-box1  example-box1-bg cursor-pointer" [ngbTooltip]="rows.alias ? rows.column : null"  (cdkDragStarted)="dragStartedRow(index,rows.column)"  cdkDrag>
                                        @if(rows.alias){
                                            {{ rows.alias }}
                                        } @else if(rows.field_name){
                                            {{ rows.field_name }}
                                        }
                                        @else if(rows.type){
                                            {{ rows.type }} ({{rows.column}})
                                        }@else{   
                                             {{ rows.column }}
                                        }
                                        <div class="dropup" ngbDropdown [autoClose]="'outside'" style="line-height: 0;">
                                            <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                            <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                <div class="dropup" ngbDropdown #aggDrop="ngbDropdown">
                                                    <li  *ngIf="!isMeasureEdit" class="btn btn-primary-light alis-measure-width border" >@if(rows.alias){
                                                        {{ rows.alias }}
                                                    }
                                                    @else if(rows.type){
                                                        {{ rows.type }} ({{rows.column}})
                                                    }@else if(rows.field_name){
                                                        {{ rows.field_name }}
                                                    }
                                                    @else{   
                                                         {{ rows.column }}
                                                    } <i (click)="isMeasureEdit = true;" class="fa fa-pencil ms-1 sum-pencil-icon"></i> </li>
                                                    <li  *ngIf="isMeasureEdit"><input (blur)="onAliasChange(rows, index)" type="text" placeholder="Enter Alias Name" [(ngModel)]="rows.alias" class="form-control checkbox-color">
                                                    </li>
                                                    <div *ngIf="rows?.data_type != 'calculated'" class="d-flex text-center p-0">
                                                    <li class="dropdown-item btn btn-primary-light Aggregation-text border" ngbDropdownItem >Aggregation</li>
                                                    <i class="fe fe-chevron-right fs-18 text-body-secondary btn btn-primary-light dropdown-toggle inline-block border "  ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                </div>
                                                    <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                        <li *ngIf="!stringList.includes(rows.data_type)"><a [ngClass]="rows.type === 'sum' ? 'aggregation-select' : ''" class="dropdown-item border Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="rowMeasuresCount(rows,index,'sum')">Sum</a></li>
                                                        <li *ngIf="!stringList.includes(rows.data_type)"><a [ngClass]="rows.type === 'avg' ? 'aggregation-select' : ''" class="dropdown-item border Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="rowMeasuresCount(rows,index,'avg')">Avg</a></li>
                                                        <li *ngIf="!stringList.includes(rows.data_type)"><a [ngClass]="rows.type === 'min' ? 'aggregation-select' : ''" class="dropdown-item border Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="rowMeasuresCount(rows,index,'min')">Min</a></li>
                                                        <li *ngIf="!stringList.includes(rows.data_type)"><a [ngClass]="rows.type === 'max' ? 'aggregation-select' : ''" class="dropdown-item border Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="rowMeasuresCount(rows,index,'max')">Max</a></li>
                                                        <li><a [ngClass]="rows.type === 'count' ? 'aggregation-select' : ''" class="dropdown-item border Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="rowMeasuresCount(rows,index,'count')">Count</a></li>
                                                        <li><a [ngClass]="rows.type === 'count_distinct' ? 'aggregation-select' : ''" class="dropdown-item border Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="rowMeasuresCount(rows,index,'count_distinct')">Count (Distinct)</a></li>
                                                        <li><a [ngClass]="rows.type === '' ? 'aggregation-select' : ''"class="dropdown-item border Aggregation-select-padding" ngbDropdownItem href="javascript:void(0);" (click)="rowMeasuresCount(rows,index,'')" >None</a></li>  
                                                    </ul>
                                                </div>

                                                
                                                        <!-- <div class="dropup" ngbDropdown #quickCalculation="ngbDropdown">
                                                            <div class="d-flex text-center">
                                                                <li class="dropdown-item btn btn-primary-light Aggregation-text border" ngbDropdownItem >Quick Calculation</li>
                                                                <i class="fe fe-chevron-right fs-18 text-body-secondary btn btn-primary-light dropdown-toggle inline-block border "  ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                            </div>
                                                            <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                <li ><a  class="dropdown-item border Aggregation-select-padding" ngbDropdownItem  >QOQ</a></li>
                                                                <li ><a  class="dropdown-item border Aggregation-select-padding" ngbDropdownItem  >YOY</a></li>
                                                                <li ><a  class="dropdown-item border Aggregation-select-padding" ngbDropdownItem  >MOM</a></li>

                                                            </ul>
                                                           
                                                        </div> -->
                                                        <div *ngIf="checkAggregateNotNone && integerList.includes(rows.data_type)" class="d-flex text-center" class="dropup" [autoClose]="'outside'" ngbDropdown>
                                                            <div class="d-flex text-center">
                                                              <li class="dropdown-item btn btn-primary-light Aggregation-text border" ngbDropdownItem>
                                                                Quick Calculation
                                                              </li>
                                                              <i class="fe fe-chevron-right fs-18 text-body-secondary btn btn-primary-light dropdown-toggle inline-block border"
                                                                 ngbDropdownToggle>
                                                              </i>
                                                            </div>
                                                         
                                                            <!-- Main Dropdown Menu -->
                                                            <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                             
                                                              <!-- Reusable dropdown option component -->
                                                              <li class="dropdown-submenu" ngbDropdown>
                                                                <a class="dropdown-item border d-flex justify-content-between align-items-center"
                                                                   ngbDropdownToggle [class.disabled]="!hasQuaterType"
                                                                   [attr.tabindex]="hasQuaterType ? '0' : '-1'"
                                                                   (click)="!hasQuaterType ? $event.preventDefault() : null">
                                                                  QOQ
                                                                  <i class="fe fe-chevron-right fs-12 ms-2"></i>
                                                                </a>
                                                                <ul ngbDropdownMenu class="dropdown-menu custom-dropdown">
                                                                  <li *ngFor="let column of quaterColumns" [ngClass]="draggedRowsData[index][2].split(':')[0] == column ? 'aggregation-select' : ''">
                                                                    <a class="dropdown-item border Aggregation-select-padding"
                                                                    (click)="selectedColumnForPeriodType=column;rowMeasuresCount(rows, index, 'qoq');">{{column}}(QOQ)</a>
                                                                  </li>
                                                                  <li>
                                                                    <a *ngIf="draggedRowsData[index][1] == 'qoq'" class="dropdown-item border Aggregation-select-padding" 
                                                                       (click)="selectedColumnForPeriodType='';rowMeasuresCount(rows,index,'qoqRemove')">Remove</a>
                                                                </li>
                                                                </ul>
                                                              </li>
                                                             
                                                         
                                                              <li class="dropdown-submenu" ngbDropdown>
                                                                <a class="dropdown-item border d-flex justify-content-between align-items-center"
                                                                   ngbDropdownToggle [class.disabled]="!hasMonthType"
                                                                   [attr.tabindex]="hasMonthType ? '0' : '-1'"
                                                                   (click)="!hasMonthType ? $event.preventDefault() : null">
                                                                  MOM
                                                                  <i class="fe fe-chevron-right fs-12 ms-2"></i>
                                                                </a>
                                                                <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                  <li *ngFor="let column of monthColumns" [ngClass]="draggedRowsData[index][2].split(':')[0] == column ? 'aggregation-select' : ''">
                                                                    <a class="dropdown-item border Aggregation-select-padding" 
                                                                    (click)="selectedColumnForPeriodType=column;rowMeasuresCount(rows, index, 'mom');">
                                                                    {{column}}(MOM)
                                                                    </a>
                                                                  </li>
                                                                  <li>
                                                                    <a *ngIf="draggedRowsData[index][1] == 'mom'" class="dropdown-item border Aggregation-select-padding" 
                                                                       (click)="selectedColumnForPeriodType='';rowMeasuresCount(rows,index,'momRemove')">Remove</a>
                                                                </li>
                                                                </ul>
                                                              </li>
                                                         
                                                              <li class="dropdown-submenu" ngbDropdown>
                                                                <a class="dropdown-item border d-flex justify-content-between align-items-center"
                                                                   ngbDropdownToggle [class.disabled]="!hasYearType"
                                                                   [attr.tabindex]="hasYearType ? '0' : '-1'"
                                                                   (click)="!hasYearType ? $event.preventDefault() : null">
                                                                  YOY
                                                                  <i class="fe fe-chevron-right fs-12 ms-2"></i>
                                                                </a>
                                                                <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                  <li *ngFor="let column of yearColumns" [ngClass]="draggedRowsData[index][2].split(':')[0] == column ? 'aggregation-select' : ''">
                                                                    <a class="dropdown-item border Aggregation-select-padding"
                                                                    (click)="selectedColumnForPeriodType=column;rowMeasuresCount(rows, index, 'yoy');">{{ column }}(yoy)</a>
                                                                  </li>
                                                                  <li>
                                                                    <a *ngIf="draggedRowsData[index][1] == 'yoy'" class="dropdown-item border Aggregation-select-padding" 
                                                                       (click)="selectedColumnForPeriodType='';rowMeasuresCount(rows,index,'yoyRemove')">Remove</a>
                                                                </li>
                                                                </ul>
                                                              </li>
                                                         
                                                            </ul>
                                                          </div>
                                                          

                                                <!-- <div *ngIf="checkdatetype && checkAggregateNotNone && integerList.includes(rows.data_type)" class="d-flex text-center" ngbDropdown #quickCalcDrop="ngbDropdown">
                                                <div *ngIf="checkdatetype && checkAggregateNotNone && integerList.includes(rows.data_type)" class="d-flex text-center p-0" ngbDropdown #quickCalcDrop="ngbDropdown">
                                                    <li class="dropdown-item btn btn-primary-light Quick-Calc-text border" ngbDropdownToggle>Quick Calculation</li>
                                       

                                                    <i class="fe fe-chevron-right fs-18 text-body-secondary btn btn-primary-light dropdown-toggle inline-block border"
                                                    ngbDropdownToggle (click)="toggleQuickCalculation()"></i>
                                             
                                                 <ul class="dropdown-menu custom-dropdown position-absolute dropdown-menu-end"
                                                     [ngClass]="{'show': quickCalcOpen}" style="top: 70px; left: 100%; min-width: 150px;">
                                        
                                                     <ng-container *ngIf="yearLength > 0; else singleYOY">
                                                        <li *ngFor="let column of yearColumns" [ngClass]=" draggedRowsData[index][2].split(':')[0] == column ? 'aggregation-select' : ''">
                                                            <a class="dropdown-item border Aggregation-select-padding" href="javascript:void(0);"
                                                               (click)="selectedColumnForYOY=column;rowMeasuresCount(rows, index, 'yoy');">{{ column }}(yoy)</a>
                                                        </li>
                                                        <li>
                                                            <a *ngIf="draggedRowsData[index][1] == 'yoy'" class="dropdown-item border Aggregation-select-padding" href="javascript:void(0);"
                                                               (click)="selectedColumnForYOY='';rowMeasuresCount(rows,index,'yoyRemove')">Remove</a>
                                                        </li>
                                                    </ng-container>
                                            
                                                    <ng-template #singleYOY>
                                                        <li>
                                                            <a class="dropdown-item border Aggregation-select-padding" href="javascript:void(0);"
                                                               (click)="rowMeasuresCount(rows, index, 'yoy')">Year Over Year (YOY)</a>
                                                        </li>
                                                    </ng-template>
                                                 </ul>
                                                </div> -->
                                                <li> <a class="btn btn-secondary-light mx-0 w-100" (click)="dragStartedRow(index,rows.column)"> Remove</a> </li>
                                            </ul>
                                        </div>
                                        
                                        <ng-template #aggregateUserModal let-modal>
                                            <div class="modal-header">
                                                <h6 class="modal-title">Aggregated measures</h6>
                                                <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                                                </button>
                                            </div>
                                        
                                            <div class="modal-body" style="height: 500px; overflow: auto;">
                                                <div class="card-body p-0">
                                                    <div class="column-card">
                                                        <p class="fw-semibold mb-1 ">Row : {{rows.column}}</p>
                                                    </div>
                                                    <div class="aggregate-card mt-3">
                                                        <p class="fw-semibold mb-1 ">Aggregate</p>
                                                        <select class="form-control" [(ngModel)]="measureValue"
                                                            (change)="rowMeasuresCount(rows,index,measureValue)">
                                                            <option [selected] value="-Select-">-Select-</option>
                                                            <option value="sum">Sum</option>
                                                            <option value="avg">Avg</option>
                                                            <option value="min">Min</option>
                                                            <option value="max">Max</option>
                                                            <option value="count">Count</option>
                                                            <option value="count_distinct">Count(Distinct)</option>
                                                            <option value="">None</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn ripple btn-secondary" (click)="modal.close('Save click')">
                                                    Close
                                                </button>
                                            </div>
                                        </ng-template>
                                        
                                        
                                    </div>
                                    }
                                </div>  
                               <!-- <ul style=" bottom: 15px; left: -5px;  position: relative;" class="nav nav-pills fs-12 justify-content-end" role="tablist" id="footer-tab border-1" ngbnav="" >
                                    <li role="presentation" class="nav-item">
                                        <button type="button" ngbnavlink="" data-bs-toggle="tab" role="tab" aria-selected="true" id="ngb-nav-24" aria-disabled="false" tabindex="-1" class="nav-link BtnRowStyle span-right">
                                            <i data-bs-toggle="tooltip" ngbtooltip="fa fa-caret-left" class="fa fa-caret-left"></i>
                                        </button>
                                    </li>
                                    <li role="presentation" class="nav-item">
                                        <button type="button" ngbnavlink="" data-bs-toggle="tab" role="tab" aria-selected="true" id="ngb-nav-24" aria-disabled="false" tabindex="-1" class="nav-link BtnRowStyle span-left">
                                            <i data-bs-toggle="tooltip" ngbtooltip="fa fa-caret-right" class="fa fa-caret-right"> </i>
                                        </button>
                                    </li>
                                </ul> -->                         
                            
                        </div>
                    </div>
                    <div  [ngStyle]="{'display': ((bar || pie || donut || map) && draggedColumns && draggedColumns?.length > 0 ? '' : 'none')}" class="row align-items-center">
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xl-2 p-0" style="overflow: auto; white-space: nowrap;">
                                                   <div class="card-area d-flex gap-2">
                                                       <label for="inputName" class="form-control mb-0 border">Hierarchy</label>
                                                   </div> 
                                                </div>
                                            <div class="col-lg-10 col-md-10 col-sm-10 col-xl-10 p-0">
                                                    <div cdkDropList cdkDropListOrientation="horizontal" class="example-list form-control border" 
                                                    style="position: relative;min-height: 33px; padding: 2px;" 
                                                #drilldownList="cdkDropList" 
                                                    [cdkDropListData]="draggedDrillDownColumns" 
                                                    (cdkDropListDropped)="drillDownColumndrop($event)">
                                                        @for(columns of draggedDrillDownColumns;track columns;let index = $index){
                                                        <div class="example-box Hierarchy-box-bg" cdkDrag >
                                                            {{ columns }}
                                                            <div class="" ngbDropdown >
                                                                <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button" ngbDropdownToggle
                                                                    aria-haspopup="true" aria-expanded="false" class=""><i class="fe fe-chevron-down fs-18 text-body-secondary"></i>
                                                                <div class="dropdown-menu  cu" ngbDropdownMenu>
                                                                        <a class="btn btn-secondary-light mx-0"  (click)="removeDrillDownColumn(index,columns)"> Remove</a>     
                                                                    </div>
                                                                </a>
                                                        </div>
                                                       </div>
                                                        }
                                                    </div>             
                                                    
                                                </div>
                                            </div>
                </div>
            </div>
                    
            <div class="card mb-0 border" [ngClass]="(bar || pie || donut || map || pivotTable) ? 'show-chart-card' : 'show-chart-card-no-heirarchy'">
                @if(!(table || kpi)){
                    <div class="input-group">
                <!-- <div class="col-lg-3 col-md-3 p-1">
                    <select class="form-select form-select select2 fs-14" [(ngModel)]="selectedChartPlugin"
                        (change)="changeChartPlugin()">
                        <option *ngIf="!(radar || calendar || map)" value="apex">Apex</option>
                        <option *ngIf="!(guage)" value="echart">EChart</option>
                    </select>
                </div> -->
                @if((pie || bar || donut || map) && draggedDrillDownColumns && draggedDrillDownColumns.length > 0){
                                    <div class="col-lg-3 col-md-3 p-1">
                                        <button class="btn btn-primary p-1" (click)="goDrillDownBack()">
                                            <img src="./assets/images/Tiled view sheet icons/Drill-Down.png" alt="logo" class="w-5 h-5"> </button>
                                   </div>
                                    @if(drillDownObject && drillDownObject.length > 0 && drillDownIndex > 0 && draggedDrillDownColumns && draggedDrillDownColumns.length > 0){
                                    <div class="col-lg-3 col-md-3 d-flex mt-2" >
                                        @for(column of drillDownObject;track column;let index = $index){
                                       <h6 class="ms-1 mb-0 p-1" > {{drillDownObject[index][draggedDrillDownColumns[index]]}}</h6> <span class="mt-1">--</span>
                                   }
                                    </div>
                                }
                                }
                                   </div>
                }
                @if(table && chartId){
                <div class="sheet-search">
                    <div class="">
                    </div>
                    <div *ngIf="table &&(draggedRows?.length > 0 || draggedColumns?.length > 0 ) && toggleTableSearch" class="input-group mt-1 p-1 sheet-table-search">
                        <input type="text" placeholder="Search" aria-describedby="button-addon2" [(ngModel)]="tableChartSearch" (keyup.enter)="tableDisplayPaginationSearch()" class="form-control border-end-0 ">
                        <button type="button" id="button-addon2" class="btn btn-primary border me-2 search-icon-border-radius" (click)="tableDisplayPaginationSearch()" >
                        <i class="fe fe-search"></i></button>
                    </div>
                   </div>
                }
                 <div class="card-body p-1 border-bottom parent-table-card" >
                    <!-- @for(tab of tabs;track tab; let index = $index){ -->
                       
                        <!-- @if((tab.sheet_name || tab) === sheetName){ -->
                          
                            <div class="body table-responsive sheet-table-responsive" id="pdfcontainer" #pdfcontainer>
                                
                                @if(table && chartId){
                                <table>
                                    <thead>
                                      <tr>
                                        @for(column of tableColumnsDisplay;track column){
                                        <th [ngStyle]="{ 'font-family': headerFontFamily, 'font-style': headerFontStyle, 'text-decoration': headerFontDecoration, 
                                        'color': headerFontColor, 'text-align': headerFontAlignment, 'font-weight': headerFontWeight, 'font-size': headerFontSize }">{{ column }}
                                            <!-- <span class=" p-1" style="float: inline-end;" ngbDropdown>
                                                <a href="javascript:void(0);" data-bs-toggle="dropdown" role="button" ngbDropdownToggle
                                                  aria-haspopup="true" aria-expanded="false" class=""><i
                                                    class="fe fe-more-vertical fs-18 text-body-secondary"></i>
                                                </a>
                                                <div class="dropdown-menu" ngbDropdownMenu>
                                                  <button class="dropdown-item" (click)="tableColumnSort('default', column)">Default</button>
                                                  <button class="dropdown-item" (click)="tableColumnSort('ascending', column)">Ascending</button>
                                                  <button class="dropdown-item" (click)="tableColumnSort('descending', column)">Descending</button>
                                                </div>
                                            </span> -->
                                        </th>
                                        }
                                      </tr>
                                    </thead>
                                    <tbody>
                                    <tr *ngFor="let row of (tableDataDisplay| paginate: { itemsPerPage: itemsPerPage,
                                                                currentPage: page,
                                                                totalItems: totalItems }) ; let i = index"
                                        [ngClass]="bandingSwitch ? (i % 2 === 0 ? 'even-row' : 'odd-row') : ''"
                                        [ngStyle]="{ 'background-color': (i % 2 === 0 ? color1 : color2) }">
                                        @for(column of tableColumnsDisplay;track column){
                                        <td [ngStyle]="{ 'font-family': tableDataFontFamily, 'font-weight': tableDataFontWeight, 'font-style': tableDataFontStyle, 'text-decoration': tableDataFontDecoration, 
                                        'color': tableDataFontColor, 'text-align': tableDataFontAlignment, 'font-size': tableDataFontSize }">{{row[column] | formatMeasure : decimalPlaces : prefix : suffix : displayUnits }}</td>
                                        }
                                    </tr>
                                    
                                    </tbody>
                                  </table>
                                  <pagination-controls *ngIf="table &&(draggedRows?.length > 0 || draggedColumns?.length > 0 ) && toggleTablePagination" previousLabel="Prev" nextLabel="Next" (pageChange)="pageChangeTableDisplay((page = $event))"></pagination-controls>
                                }
                                @if(pivotTable && chartId){
                                    <div id="pivotTableContainer" #pivotTableContainer></div>                                }
                                @if(kpi && chartId){
                                    <div class="big-number-container">
                                        <!-- @for(data of tablePreviewRow;track data){ -->
                                            <h1 class="big-number" [style.font-size]="getFontSize()" [style.color]="kpiColor">{{ KPINumber }}</h1>
                                        <!-- } -->
                                    </div>
                                }
                                @if(isApexCharts && !table && !kpi && !pivotTable){
              <!-- @if(bar && chartId){ -->

                <app-insight-apex [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData" [dualAxisColumnData]="dualAxisColumnData"
                [dualAxisRowData]="dualAxisRowData" [tablePreviewRow]="tablePreviewRow" [chartType]="chartType" [xGridSwitch]="xGridSwitch"
                [xLabelSwitch]="xLabelSwitch" [yLabelSwitch]="yLabelSwitch" [yGridSwitch]="yGridSwitch" [xLabelFontFamily]="xLabelFontFamily"
                [xLabelFontSize]="xLabelFontSize" [xlabelFontWeight]="xlabelFontWeight" [backgroundColor]="backgroundColor" [color]="color"
                [ylabelFontWeight]="ylabelFontWeight" [isBold]="isBold" [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize"
                [barColor]="barColor" [lineColor]="lineColor" [gridColor]="GridColor" [legendSwitch]="legendSwitch" [dataLabels]="dataLabels"
                [label]="label" [donutSize]="donutSize" [isDistributed]="isDistributed" [minValueGuage]="minValueGuage" [maxValueGuage]="maxValueGuage"
                [legendsAllignment]="legendsAllignment" [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsFontSize]="dataLabelsFontSize"
                [dataLabelsFontPosition]="dataLabelsFontPosition" [dataLabelsColor]="dataLabelsColor" [measureAlignment]="measureAlignment" 
                [dimensionAlignment]="dimensionAlignment" [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix"
                [donutDecimalPlaces]="donutDecimalPlaces" [drillDownIndex]="drillDownIndex" [draggedDrillDownColumns]="draggedDrillDownColumns"
                [drillDownObject]="drillDownObject" [sortType]="sortType" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" [dataLabelsBarFontPosition]="dataLabelsBarFontPosition"
                [dataLabelsLineFontPosition]="dataLabelsLineFontPosition" [selectedColorScheme]="selectedColorScheme"
                (saveOrUpdateChart)="setChartOptions($event)" (setDrilldowns)="setDrilldowns($event)">
                </app-insight-apex>
    
            } @else {
            @if(bar && chartId){         
            <div class="card-body">
                <!-- <div >
                    <div echarts [options]="eBarChartOptions" class="echart-charts"></div>
                </div> -->

                <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [chartType]="chartType" [dataLabelsFontPosition]="dataLabelsFontPosition" [dimensionAlignment] = "dimensionAlignment" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData"
                [backgroundColor]="backgroundColor" [xlabelAlignment]="xlabelAlignment" [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" [xLabelColor]="xLabelColor"
                [xLabelSwitch]="xLabelSwitch" [xLabelFontFamily]="xLabelFontFamily" [xLabelFontSize]="xLabelFontSize" [xlabelFontWeight]="xlabelFontWeight" [yLabelColor]="yLabelColor"
                [yGridSwitch]="yGridSwitch" [yLabelSwitch]="yLabelSwitch" [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                [yGridColor]="yGridColor" [yGridSwitch]="yGridSwitch" [color]="color" [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontSize]="dataLabelsFontSize" 
                [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsColor]="dataLabelsColor" [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" [sortType]="sortType"
                [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" [drillDownIndex]="drillDownIndex" [draggedDrillDownColumns]="draggedDrillDownColumns"[drillDownObject]="drillDownObject" [selectedColorScheme]="selectedColorScheme" [isDistributed]="isDistributed"
                (setDrilldowns)="setDrilldowns($event)" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
            </div>          
            }
            @else if(funnel && chartId){         
                <div class="card-body">
                    <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData" [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                    [color]="color" [backgroundColor]="backgroundColor" [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsColor]="dataLabelsColor" [selectedColorScheme]="selectedColorScheme" [isDistributed]="isDistributed"
                    [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                </div>
                }
            @else if(stocked && chartId){         
                <div class="card-body">
                    <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment"  [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                    [backgroundColor]="backgroundColor" [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" [xLabelColor]="xLabelColor" [xLabelSwitch]="xLabelSwitch"
                    [xLabelFontFamily]="xLabelFontFamily" [xLabelFontSize]="xLabelFontSize" [xlabelFontWeight]="xlabelFontWeight" [xlabelAlignment]="xlabelAlignment"
                    [xlabelAlignment]="xlabelAlignment" [yLabelColor]="yLabelColor" [yLabelSwitch]="yLabelSwitch" [yGridColor]="yGridColor" [yGridSwitch]="yGridSwitch" [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                    [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsFontSize]="dataLabelsFontSize" 
                    [dataLabelsColor]="dataLabelsColor"  [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" [selectedColorScheme]="selectedColorScheme"
                    [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                </div>
                }
            @else if(sidebyside && chartId){         
                    <div class="card-body">
                        <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData" [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                        [backgroundColor]="backgroundColor" [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" [xLabelColor]="xLabelColor" [xLabelSwitch]="xLabelSwitch" [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                        [xLabelFontFamily]="xLabelFontFamily" [xLabelFontSize]="xLabelFontSize" [xlabelFontWeight]="xlabelFontWeight" [xlabelAlignment]="xlabelAlignment" [selectedColorScheme]="selectedColorScheme"
                        [yLabelColor]="yLabelColor" [yLabelSwitch]="yLabelSwitch" [yGridSwitch]="yGridSwitch" [color]="color" [yGridColor]="yGridColor" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData"
                        [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsFontSize]="dataLabelsFontSize"
                        [dataLabelsColor]="dataLabelsColor"  [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix"
                        [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                    </div>
                    }
            @else if(grouped && chartId){         
                    <div class="card-body">
                        <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment"  [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                        [backgroundColor]="backgroundColor" [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" [xLabelColor]="xLabelColor" [xLabelSwitch]="xLabelSwitch"  [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                        [xLabelFontFamily]="xLabelFontFamily" [xLabelFontSize]="xLabelFontSize" [xlabelFontWeight]="xlabelFontWeight" [xlabelAlignment]="xlabelAlignment"
                        [yLabelColor]="yLabelColor" [yLabelSwitch]="yLabelSwitch" [yGridColor]="yGridColor" [yGridSwitch]="yGridSwitch" [selectedColorScheme]="selectedColorScheme"
                        [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsFontSize]="dataLabelsFontSize" 
                        [dataLabelsColor]="dataLabelsColor"  [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix"
                        [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                    </div>
            }
            @else if(horizentalStocked && chartId){         
                <div class="card-body">
                    <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment"  [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                    [backgroundColor]="backgroundColor" [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" [xLabelColor]="xLabelColor" [xLabelSwitch]="xLabelSwitch"  [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                    [xLabelSwitch]="xLabelSwitch" [xLabelFontFamily]="xLabelFontFamily" [xLabelFontSize]="xLabelFontSize" [xlabelFontWeight]="xlabelFontWeight" [xlabelAlignment]="xlabelAlignment" [selectedColorScheme]="selectedColorScheme"
                    [yLabelColor]="yLabelColor" [yGridColor]="yGridColor" [yLabelSwitch]="yLabelSwitch" [yGridSwitch]="yGridSwitch"  [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily"
                    [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsColor]="dataLabelsColor"  [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix"
                    [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                </div>
        }
                
            @else if(area && chartId){
            <div class="card-body">
                <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData"
                [backgroundColor]="backgroundColor" [xlabelAlignment]="xlabelAlignment" [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" 
                [xLabelColor]="xLabelColor" [xLabelSwitch]="xLabelSwitch" [xLabelFontFamily]="xLabelFontFamily" [xLabelFontSize]="xLabelFontSize"
                [xlabelFontWeight]="xlabelFontWeight" [yLabelColor]="yLabelColor" [yLabelSwitch]="yLabelSwitch" [yGridColor]="yGridColor"
                [yGridSwitch]="yGridSwitch" [color]="color"  [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily" 
                [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsColor]="dataLabelsColor" [yLabelFontFamily]="yLabelFontFamily"  [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                [ylabelFontWeight]="ylabelFontWeight"  [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
            </div>
            }
            @else if(line && chartId){
            <div class="card-body">
                <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData"
                [backgroundColor]="backgroundColor" [xlabelAlignment]="xlabelAlignment" [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" 
                [xLabelColor]="xLabelColor" [xLabelSwitch]="xLabelSwitch" [xLabelFontFamily]="xLabelFontFamily" [xLabelFontSize]="xLabelFontSize"
                [xlabelFontWeight]="xlabelFontWeight" [yLabelColor]="yLabelColor" [yLabelSwitch]="yLabelSwitch" [yGridColor]="yGridColor"
                [yGridSwitch]="yGridSwitch" [color]="color" [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily"
                 [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsColor]="dataLabelsColor" [yLabelFontFamily]="yLabelFontFamily"  [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                 [ylabelFontWeight]="ylabelFontWeight"  [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" 
                 [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
            </div>
            }
            @else if(pie && chartId){
            <div class="card-body">
                <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData"
                [backgroundColor]="backgroundColor" [legendSwitch]="legendSwitch" [dataLabels]="dataLabels"  [dataLabelsFontFamily]="dataLabelsFontFamily" [selectedColorScheme]="selectedColorScheme"
                [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsColor]="dataLabelsColor" [legendsAllignment]="legendsAllignment"  [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix"
                [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" [drillDownIndex]="drillDownIndex" [draggedDrillDownColumns]="draggedDrillDownColumns"[drillDownObject]="drillDownObject"
                (setDrilldowns)="setDrilldowns($event)" (saveOrUpdateChart)="setChartOptions($event)" [leftLegend]="leftLegend" [topLegend]="topLegend" [rightLegend]="rightLegend" [bottomLegend]="bottomLegend" [legendOrient]="legendOrient"></app-insight-echart>
            </div>
            }
            @else if(donut && chartId){
                <div class="card-body">
                    <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType" [donutSize]="donutSize" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData"
                    [backgroundColor]="backgroundColor" [legendSwitch]="legendSwitch" [dataLabels]="dataLabels" [dataLabelsFontFamily]="dataLabelsFontFamily" [selectedColorScheme]="selectedColorScheme"
                    [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsColor]="dataLabelsColor" [legendsAllignment]="legendsAllignment"
                    [donutDecimalPlaces]="donutDecimalPlaces" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" [drillDownIndex]="drillDownIndex" [draggedDrillDownColumns]="draggedDrillDownColumns"[drillDownObject]="drillDownObject"
                    (setDrilldowns)="setDrilldowns($event)" (saveOrUpdateChart)="setChartOptions($event)" [leftLegend]="leftLegend" [topLegend]="topLegend" [rightLegend]="rightLegend" [bottomLegend]="bottomLegend" [legendOrient]="legendOrient"
                    ></app-insight-echart>
                </div>
                }
            @else if(barLine && chartId){
                <div class="card-body">
                    <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment" [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                    [backgroundColor]="backgroundColor" [xLabelColor]="xLabelColor" [xLabelFontSize]="xLabelFontSize" [xLabelFontFamily]="xLabelFontFamily" [xLabelSwitch]="xLabelSwitch" [yLabelSwitch]="yLabelSwitch"
                    [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" [yGridColor]="yGridColor" [yGridSwitch]="yGridSwitch" [barColor]="barColor" [lineColor]="lineColor"  [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                    [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsColor]="dataLabelsColor"
                    [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" [dataLabelsBarFontPosition]="dataLabelsBarFontPosition" [dataLabelsLineFontPosition]="dataLabelsLineFontPosition"
                    [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                </div>
                }
                @else if(multiLine && chartId){
                    <div class="card-body">
                        <app-insight-echart [isZoom]="isZoom" [isBold]="isBold" [dataLabelsFontPosition]="dataLabelsFontPosition" [chartType]="chartType"  [dimensionAlignment] = "dimensionAlignment" [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                        [backgroundColor]="backgroundColor" [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" [xLabelColor]="xLabelColor" [xLabelSwitch]="xLabelSwitch"  [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight"
                        [xLabelFontFamily]="xLabelFontFamily" [xLabelFontSize]="xLabelFontSize" [xlabelFontWeight]="xlabelFontWeight" [xlabelAlignment]="xlabelAlignment"
                        [yLabelColor]="yLabelColor" [yLabelSwitch]="yLabelSwitch" [yGridColor]="yGridColor" [yGridSwitch]="yGridSwitch" [selectedColorScheme]="selectedColorScheme"
                        [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsFontSize]="dataLabelsFontSize" 
                        [dataLabelsColor]="dataLabelsColor"  [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix"
                        [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                    </div>
                    }
            @else if(radar && chartId){
                <div class="card-body">
                    <app-insight-echart  [chartType]="chartType" [color]="color"  [isBold]="isBold" [radarRowData]="radarRowData" [dataLabelsFontPosition]="dataLabelsFontPosition" [dimensionAlignment] = "dimensionAlignment" [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                    [backgroundColor]="backgroundColor" [legendSwitch]="legendSwitch" [xLabelColor]="xLabelColor" [dataLabels]="dataLabels" [dataLabelsFontFamily]="dataLabelsFontFamily"  [isRadarDistribution]="isRadarDistribution" [selectedColorScheme]="selectedColorScheme"
                    [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsColor]="dataLabelsColor" [legendsAllignment]="legendsAllignment" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData"
                    [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                </div>
                }
                @else if(map && chartId){
                    <div class="card-body">
                        <app-insight-echart  [isZoom]="isZoom" [isBold]="isBold"  [chartType]="chartType" [chartsColumnData]="chartsColumnData" [chartsRowData]="chartsRowData" [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                        [dataLabelsFontPosition]="dataLabelsFontPosition" [dimensionAlignment] = "dimensionAlignment" [backgroundColor]="backgroundColor" [xlabelAlignment]="xlabelAlignment"
                        [xGridColor]="xGridColor" [xGridSwitch]="xGridSwitch" [xLabelColor]="xLabelColor" [xLabelSwitch]="xLabelSwitch" [xLabelFontFamily]="xLabelFontFamily"
                        [xLabelFontSize]="xLabelFontSize" [xlabelFontWeight]="xlabelFontWeight" [yLabelColor]="yLabelColor" [yGridSwitch]="yGridSwitch" [yLabelSwitch]="yLabelSwitch"
                        [yLabelFontFamily]="yLabelFontFamily" [yLabelFontSize]="yLabelFontSize" [ylabelFontWeight]="ylabelFontWeight" [yGridColor]="yGridColor" [yGridSwitch]="yGridSwitch"
                        [color]="color" [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsFontFamily]="dataLabelsFontFamily"
                        [dataLabelsColor]="dataLabelsColor" [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" [sortType]="sortType"
                        [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" [drillDownIndex]="drillDownIndex" [draggedDrillDownColumns]="draggedDrillDownColumns"[drillDownObject]="drillDownObject"
                        (setDrilldowns)="setDrilldowns($event)" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                    </div>
                    }
                    
                @else if(calendar){
                    <div class="card-body">
                        <app-insight-echart [isZoom]="isZoom"  [chartType]="chartType" [chartsColumnData]="chartsColumnData" [chartsRowData]="chartsRowData" [selectedColorScheme]="selectedColorScheme"
                        [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                    </div>
                }
                @else if(heatMap){
                    <div class="card-body">
                        <app-insight-echart [isZoom]="isZoom" [isBold]="isBold"  [chartType]="chartType" [dataLabelsFontPosition]="dataLabelsFontPosition" [dimensionAlignment] = "dimensionAlignment" 
                        [decimalPlaces]="decimalPlaces" [displayUnits]="displayUnits"  [dualAxisRowData]="dualAxisRowData" [dualAxisColumnData]="dualAxisColumnData"
                        [backgroundColor]="backgroundColor" [xLabelSwitch]="xLabelSwitch" [xLabelColor]="xLabelColor" [xLabelFontSize]="xLabelFontSize" [xLabelFontFamily]="xLabelFontFamily" [selectedColorScheme]="selectedColorScheme"
                        [xlabelFontWeight]="xlabelFontWeight" [yLabelSwitch]="yLabelSwitch" [yLabelColor]="yLabelColor" [yLabelFontSize]="[yLabelFontSize]" [yLabelFontFamily]="yLabelFontFamily" [ylabelFontWeight]="ylabelFontWeight"
                        [measureColor]="measureColor" [dimensionColor]="dimensionColor" [dataLabelsFontFamily]="dataLabelsFontFamily" [dataLabelsFontSize]="dataLabelsFontSize" [dataLabelsColor]="dataLabelsColor"
                        [displayUnits]="displayUnits" [decimalPlaces]="decimalPlaces" [prefix]="prefix" [suffix]="suffix" [chartsRowData]="chartsRowData" [chartsColumnData]="chartsColumnData"
                        [isSheetSaveOrUpdate]="isSheetSaveOrUpdate" (saveOrUpdateChart)="setChartOptions($event)"></app-insight-echart>
                    </div>
                }
            }
            </div>
        <!-- }-->
                 </div>
                    <div class="card-footer d-flex p-1 sheets-footer-card">
                        <mat-tab-group [selectedIndex]="selectedTabIndex"
                        (selectedIndexChange)="selected.setValue($event)"
                        (selectedTabChange)="onChange($event);" 
                        >
                        @for(tab of tabs;track tab; let index = $index){
           <mat-tab  [label]="tab.sheet_name || tab">
          <!--  <br>  <br>
             Contents for {{tab}} tab
         
             <button mat-raised-button
                     class="example-delete-tab-button"
                     [disabled]="tabs.length === 1"
                     (click)="removeTab(index)">
               Delete Tab
             </button>
              <br> <br> <br>-->
           </mat-tab>
         }
         </mat-tab-group>
         
                        <ul ngbnav="" id="footer-tab border-1 " role="tablist" class="nav nav-pills fs-12 " style=" display: contents;">
                            
                            <div>
                                <li role="presentation" class="nav-item me-1 ms-1">
                                    <button type="button" ngbnavlink="" ngbTooltip="Add Sheet" [class.disabled]="SheetSavePlusEnabled.length>0" data-bs-toggle="tab"
                                        role="tab" aria-selected="true" id="ngb-nav-24" aria-disabled="false" tabindex="-1"
                                        class="btn-sm btn-info-light" (click)="addSheet(false)" >
                                        <i class="fa fa-plus-square"></i>
                                    </button>
                                </li>
                            </div>
                            <li role="presentation" class="nav-item me-1">
                                <button type="button" ngbnavlink="" ngbTooltip="Delete Sheet" [class.disabled]="!retriveDataSheet_id && SheetIndex === 0 && !deleteSheetInSheetComponent" data-bs-toggle="tab" role="tab"
                                    aria-selected="true" id="ngb-nav-24" aria-disabled="false" tabindex="-1" class="btn-sm btn-danger-light"
                                    (click)="removeTab()" >
                                    <i class="fe fe-trash"></i>
                                </button>
                            </li>
                            <li role="presentation" class="nav-item me-1">
                                <button type="button" ngbnavlink="" ngbTooltip="Duplicate Sheet" [class.disabled]="!retriveDataSheet_id" data-bs-toggle="tab" role="tab"
                                    aria-selected="true" id="ngb-nav-24" aria-disabled="false" tabindex="-1" class="btn-sm btn-info-light"
                                    (click)="sheetDuplicate()" >
                                    <i class="fa fa-copy"></i>
                                </button>
                            </li>
                        </ul>
                        <div *ngIf="!sheetsDashboard && database_name" [class.disabled]="!retriveDataSheet_id" ><button (click)="openSelectDashboard(content)" class="btn-sm btn-info-light move-text" >Move to Dashboard</button>
                            <ng-template #content let-modal>
                                <div class="modal-header">
                                    <h6 class="modal-title">Move to Dashboard</h6>
                                    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Add to Dashboard</p>
                                    <div class="form-group select2-sm">
                                        <select id="inputGroupSelect013" class="form-select form-select select2 fs-14"  [(ngModel)]="selectedDashboardId">
                                            <option value="0" disabled selected>Select a Dashboard</option>
                                            <option *ngFor="let dashboard of dashboardList" [value]="dashboard.dashboard_id">{{dashboard.dashboard_name}}</option>
                                        </select>
                                    </div>
                                    <app-insights-button [buttonName]="' New Dashboard'" [classesList]="'btn btn-primary'" [previledgeId]="34" [isBtn]="true"
                                    (btnClickEvent)="gotoDashboard();modal.close('Save click')" [gotoSheetButton]="!retriveDataSheet_id" [isIcon]="true" [faIconList]="'fa fa-plus'"></app-insights-button>
                                </div>
                            
                            
                                <div class="modal-footer">
                            
                                    <button type="button" class="btn ripple btn-secondary" (click)="modal.close('Save click')">
                                        Cancel
                                    </button>
                                    <button type="button" class="btn ripple btn-primary" [disabled]="!retriveDataSheet_id || !selectedDashboardId" (click)="moveToDashboard(); modal.close('Save click')">Ok</button>
                                </div>
                            </ng-template>
                        </div>
                        <div *ngIf="sheetsDashboard"  class="movetodashboard-text-btn"><button (click)="moveToDashboard()" class="nav-link  btn-sm btn-info-light border move-text">View Dashboard</button></div>        
                    </div>
                </div>

             </div>
             </div>
             <div class="col-xxl-2 col-xl-2 col-lg-2 col-md-2 mt-3 p-1">
                <div class="card panel panel-primary border dataCuCardHeight">
                    <div class="tab-menu-heading tab-menu-heading-boxed">
                        <div class="tabs-menu1">
                            <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav panel-tabs fs-14 justify-content-between">

                                <li [ngbNavItem]="1">
                                    <a ngbNavLink class="p-1">Data</a>
                                    <ng-template ngbNavContent>
                                        <div class="tab-pane active" id="activetabs">
                                            <div class="border rounded-3 mb-1 filter-card-height" >
                                                <div class="card-header  bg-light justify-content-start align-items-center p-2">
                                                    <div class="card-title fs-12">Filters </div>
                                                </div>
                                                <div class="card-body p-1">
                                                    @for(dimen of dimetionMeasure;track dimen;let index = $index){
                                                    <div class="example-box justify-content-between border-bottom cursor-pointer"
                                                     [ngbTooltip]="dimen.col_name.length > 15 ? dimen.col_name : null"> 
                                                       {{ dimen.col_name.length > 15 ? (dimen.col_name | slice:0:15) + '...' : dimen.col_name }}
                                                       <div class="filter-icons">
                                                        <a aria-label="anchor" ngbTooltip="Edit" class="btn btn-icon btn-sm btn-info-light btn-wave waves-effect waves-light me-2">
                                                            <i class="ri-edit-line"  (click)="openSuperScalededitFilter(contentedit,dimen)"></i>
                                                        </a>
                                                        <a aria-label="anchor" ngbTooltip="Delete" class="btn btn-icon btn-sm btn-danger-light btn-wave waves-effect waves-light">
                                                            <i class="ri-delete-bin-7-line" (click)="filterDelete(index,dimen.filter_id)"></i>
                                                        </a>
                                                        <!-- <i class="fe fe-edit fs-12 text-body-secondary ms-2" ></i>
                                                        <i class="ri-delete-bin-7-line" ></i> -->
                                                    </div>
                                                    </div>
                                                }
                                                </div>
                                                <ng-template #contentedit let-modal>
                                                    <div class="modal-header">
                                                      <h6 class="modal-title"> Edit Filter</h6>
                                                      <button type="button"class="btn-close"aria-label="Close"(click)="isAllSelected = false;modal.dismiss('Cross click')">
                                                      </button>
                                                    </div>
                                                    <div class="modal-body edit-filter-modal"  >
                                                        <!-- <div class="input-group">
                                                            <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="editFilterSearch"
                                                                (keyup.enter)="editFilterList()" aria-describedby="button-addon2">
                                                            <button class="btn btn-primary border me-2" (click)="editFilterList()" type="button" id="button-addon2"
                                                               ><i class="fe fe-search "></i></button>
                                                        </div> -->
                                                        @if(dateList.includes(filterType)){
                                                            <div class="card panel panel-primary">
                                                                <div class="tab-menu-heading tab-menu-heading-boxed">
                                                                    <div class="tabs-menu-boxed">
                                                                        <ul ngbNav #nav="ngbNav" [(activeId)]="activeTabId" class="nav panel-tabs fs-14 pb-1" >
                                                                            <li [ngbNavItem]="1" [class.disabled]="formatExtractType || (activeTabId !== 1)">
                                                                                <a ngbNavLink class="p-3">General</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane active" id="activetabs">
                                                                                        <div class="d-flex">
                                                                                            <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="editFilterSearch"  aria-describedby="button-addon2" >
                                                                                            <button class="btn btn-primary border me-2 search-icon-border-radius"  type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                                                        </div>
                                                                                        <!-- @for(data of filterData;track data){
                                                                                            @if(data? data : (boolList.includes(filterType)? true: '')){
                                                                                                <div class="form-check">
                                                                                                    <input type="checkbox" name="checkbox" id="defaultCheck1" [(ngModel)]="data.selected" class="form-check-input" (click)="filterCheck($event,data.label)">    
                                                                                                    <label for="defaultCheck1" class="form-check-label"> {{data.label}} </label>
                                                                                                </div>
                                                                                            }
                                                                                        } -->
                                                                                        <cdk-virtual-scroll-viewport itemSize="15" *ngIf="filterData.length > 0" class="viewport" style="height: 510px;">
                                                                                            <div *cdkVirtualFor="let data of filterData | test:editFilterSearch:'label'; trackBy: trackByFn">
                                                                                                <div class="form-check d-flex">
                                                                                                    <input type="checkbox" [id]="'checkbox' + data.id" [(ngModel)]="data.selected"
                                                                                                        class="form-check-input" (change)="filterCheck($event, data.label)">
                                                                                                    <label [for]="'checkbox' + data.id" class="form-check-label">{{ data.label }}</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </cdk-virtual-scroll-viewport>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="2" [class.disabled]="formatExtractType || (activeTabId !== 2)">
                                                                                <a ngbNavLink class="p-3">Range of dates</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane" id="linktabs">
                                                                                        <div class="card-body">
                                                                                            <div class="date-box">
                                                                                                <input type="text" id="input" [(ngModel)]="minDate" (keyup.enter)="updateDateRange(true)" (blur)="updateDateRange(true)" class="form-control date-box-width">
                                                                                                <input type="text" id="input" [(ngModel)]="maxDate" (keyup.enter)="updateDateRange(true)" (blur)="updateDateRange(true)" class="form-control date-box-width">
                                                                                            </div>
                                                                                            <div id="merging-tooltips">
                                                                                              <ngx-slider 
                                                                                              [(value)]="minValue"
                                                                                              [(highValue)]="maxValue"
                                                                                              [options]="options"
                                                                                              (valueChange)="updateDateRange(false)"
                                                                                              (highValueChange)="updateDateRange(false)"
                                                                                            ></ngx-slider>
                                                                                            </div>
                                                                                            <span *ngIf="dateRangeError" class="text-danger"> *Note :- {{dateRangeError}} </span>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="3" [class.disabled]="!formatExtractType || (activeTabId !== 3)">
                                                                                <a ngbNavLink class="p-3">Extract</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane" id="linktabs">
                                                                                        <div class="card-body p-0">
                                                                                            <ul *ngIf="!formatExtractType" class="mb-2">
                                                                                              <li (click)="formatExtractType = 'year'; filterDataArray.clear(); filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                                <label for="defaultCheck1" class="form-check-label">Years</label>
                                                                                              </li>
                                                                                              <li (click)="formatExtractType = 'quarter';filterDataArray.clear(); filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                                <label for="defaultCheck1" class="form-check-label">Quaters</label>
                                                                                              </li>
                                                                                              <li (click)="formatExtractType = 'month'; filterDataArray.clear(); filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                                <label for="defaultCheck1" class="form-check-label">Months</label>
                                                                                              </li>
                                                                                              <li (click)="formatExtractType = 'day'; filterDataArray.clear(); filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                                <label for="defaultCheck1" class="form-check-label">Days</label>
                                                                                              </li>
                                                                                              <li (click)="formatExtractType = 'week numbers'; filterDataArray.clear(); filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                                <label for="defaultCheck1" class="form-check-label">Week numbers</label>
                                                                                              </li>
                                                                                              <li (click)="formatExtractType = 'weekdays'; filterDataArray.clear(); filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                                <label for="defaultCheck1" class="form-check-label">Weekdays</label>
                                                                                              </li>
                                                                                            </ul>
                                                                                            <!-- <ul *ngIf="!formatExtractType">
                                                                                              <li (click)="formatExtractType = 'count'; filterDataArray = []; filterDataGet()">
                                                                                                 <i class="fa fa-calendar-o me-1"></i>
                                                                                                <label for="defaultCheck1" class="form-check-label">Count</label>
                                                                                              </li>
                                                                                              <li (click)="formatExtractType = 'count_distinct'; filterDataArray = []; filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                               <label for="defaultCheck1" class="form-check-label">Count (Distinct)</label>
                                                                                              </li>
                                                                                              <li (click)="formatExtractType = 'min'; filterDataArray = []; filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                               <label for="defaultCheck1" class="form-check-label">Minimum</label>
                                                                                              </li>
                                                                                              <li (click)="formatExtractType = 'max'; filterDataArray = []; filterDataGet()">
                                                                                                <i class="fa fa-calendar-o me-1"></i>
                                                                                               <label for="defaultCheck1" class="form-check-label">Maximum</label>
                                                                                              </li>
                                                                                            </ul> -->
                                                                                            @if(formatExtractType){
                                                                                                <div class="d-flex">
                                                                                                    <button class="btn btn-primary" (click)="formatExtractType = '';"><i class="fa fa-long-arrow-left"></i></button>
                                                                                                    <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="editFilterSearch" (keyup.enter)="editFilterList()" aria-describedby="button-addon2" >
                                                                                                    <button class="btn btn-primary border me-2 search-icon-border-radius" (click)="editFilterList()" type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                                                                </div>
                                                                                                @for(data of filterData;track data){
                                                                                                    @if(data? data : (boolList.includes(filterType)? true: '')){
                                                                                                        <div class="form-check">
                                                                                                            <input type="checkbox" name="checkbox" id="defaultCheck1" [(ngModel)]="data.selected" class="form-check-input" (click)="filterCheck($event,data.label)">    
                                                                                                            <label for="defaultCheck1" class="form-check-label"> {{data.label}} </label>
                                                                                                        </div>
                                                                                                    }
                                                                                                }
                                                                                            }
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            <li [ngbNavItem]="5" [class.disabled]="activeTabId !== 5">
                                                                                <a ngbNavLink class="p-3 TabShadow">Relative Dates</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane" id="linktabs">
                                                                                        <div class="card-body p-0 border rounded-3">
                                                                                            <div class="d-lg-flex d-block">
                                                                                                <div class="border-end">
                                                                                                    <ul ngbNav #nav="ngbNav" [(activeId)]="relativeDateType" class="nav flex-column nav-pills" id="vertical-tab"
                                                                                                        role="tablist" aria-orientation="vertical">
                                                                                                        <li [ngbNavItem]="1" (click)="selectedDateFormat = 'thisYear';getYearPreview()" className="nav-link text-start" id="years-tab"><a ngbNavLink>Years</a>
                                                                                                            <ng-template ngbNavContent>
                                                                                                                <div class="tab-pane " id="years" role="tabpanel" aria-labelledby="years-tab"tabindex="0">
                                                                                                                    <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                                                        <div class="previous-year-card">
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="previousYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousYear" (change)="getYearPreview()">
                                                                                                                                <label class="form-check-label" for="previousYear"> Previous Year </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="thisYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisYear" (change)="getYearPreview()">
                                                                                                                                <label class="form-check-label" for="thisYear"> This Year </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextYear" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextYear" (change)="getYearPreview()">
                                                                                                                                <label class="form-check-label" for="nextYear"> Next Year </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="yearToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="yearToDate" (change)="getYearPreview()">
                                                                                                                                <label class="form-check-label" for="yearToDate"> Year to date</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="lastYearCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastYearCount" (change)="getYearPreview()">
                                                                                                                                <label class="form-check-label" for="lastYearCount"> Last</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastYearCount'" [(ngModel)]="last" (input)="getYearPreview()">
                                                                                                                                <label class="form-check-label ms-2"> Years</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextYearCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextYearCount" (change)="getYearPreview()">
                                                                                                                                <label class="form-check-label" for="nextYearCount"> Next</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextYearCount'" [(ngModel)]="next" (input)="getYearPreview()">
                                                                                                                                <label class="form-check-label ms-2"> Years</label>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </ng-template>
                                                                                                        </li>
                                                                                                        <li [ngbNavItem]="2" (click)="selectedDateFormat = 'thisQuarter';getQuarterPreview()" className="nav-link text-start" id="quarters-tab"><a ngbNavLink>Quarters</a>
                                                                                                            <ng-template ngbNavContent>
                                                                                                                <div class="tab-pane " id="quarters" role="tabpanel" aria-labelledby="quarters-tab"tabindex="0">
                                                                                                                    <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                                                        <div class="previous-year-card">
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="previousQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousQuarter" (change)="getQuarterPreview()">
                                                                                                                                <label class="form-check-label" for="previousQuarter"> Previous Quarter </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="thisQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisQuarter" (change)="getQuarterPreview()">
                                                                                                                                <label class="form-check-label" for="thisQuarter"> This Quarter </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextQuarter" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextQuarter" (change)="getQuarterPreview()">
                                                                                                                                <label class="form-check-label" for="nextQuarter"> Next Quarter </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="quarterToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="quarterToDate" (change)="getQuarterPreview()">
                                                                                                                                <label class="form-check-label" for="quarterToDate"> Quarter to date</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="lastQuarterCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastQuarterCount" (change)="getQuarterPreview()">
                                                                                                                                <label class="form-check-label" for="lastQuarterCount"> Last</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastQuarterCount'" [(ngModel)]="last" (input)="getQuarterPreview()">
                                                                                                                                <label class="form-check-label ms-2"> Quarters</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextQuarterCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextQuarterCount" (change)="getQuarterPreview()">
                                                                                                                                <label class="form-check-label" for="nextQuarterCount"> Next</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextQuarterCount'" [(ngModel)]="next" (input)="getQuarterPreview()">
                                                                                                                                <label class="form-check-label ms-2"> Quarters</label>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </ng-template>
                                                                                                        </li>
                                                                                                        <li [ngbNavItem]="3" (click)="selectedDateFormat = 'thisMonth';getMonthsPreview()" className="nav-link text-start" id="month-tab"><a ngbNavLink>Months</a>
                                                                                                            <ng-template ngbNavContent>
                                                                                                                <div class="tab-pane " id="month" role="tabpanel" aria-labelledby="month-tab"tabindex="0">
                                                                                                                    <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                                                        <div class="previous-year-card">
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="previousMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousMonth" (change)="getMonthsPreview()">
                                                                                                                                <label class="form-check-label" for="previousMonth"> Previous Month </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="thisMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisMonth" (change)="getMonthsPreview()">
                                                                                                                                <label class="form-check-label" for="thisMonth"> This Month </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextMonth" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextMonth" (change)="getMonthsPreview()">
                                                                                                                                <label class="form-check-label" for="nextMonth"> Next Month </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="monthToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="monthToDate" (change)="getMonthsPreview()">
                                                                                                                                <label class="form-check-label" for="monthToDate"> Month to date</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="lastMonthCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastMonthCount" (change)="getMonthsPreview()">
                                                                                                                                <label class="form-check-label" for="lastMonthCount"> Last</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastMonthCount'" [(ngModel)]="last" (input)="getMonthsPreview()">
                                                                                                                                <label class="form-check-label ms-2"> months</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextMonthCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextMonthCount" (change)="getMonthsPreview()">
                                                                                                                                <label class="form-check-label" for="nextMonthCount"> Next</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextMonthCount'" [(ngModel)]="next" (input)="getMonthsPreview()">
                                                                                                                                <label class="form-check-label ms-2"> months</label>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </ng-template>
                                                                                                        </li>
                                                                                                        <li [ngbNavItem]="4" (click)="selectedDateFormat = 'thisWeek';getWeeksPreview()" className="nav-link text-start" id="weeks-tab"><a ngbNavLink>Weeks</a>
                                                                                                            <ng-template ngbNavContent>
                                                                                                                <div class="tab-pane " id="weeks" role="tabpanel" aria-labelledby="weeks-tab"tabindex="0">
                                                                                                                    <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                                                        <div class="previous-year-card">
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="previousWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="previousWeek" (change)="getWeeksPreview()">
                                                                                                                                <label class="form-check-label" for="previousWeek"> Previous Week </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="thisWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="thisWeek" (change)="getWeeksPreview()">
                                                                                                                                <label class="form-check-label" for="thisWeek"> This Week </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextWeek" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextWeek" (change)="getWeeksPreview()">
                                                                                                                                <label class="form-check-label" for="nextWeek"> Next Week </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="weekToDate" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="weekToDate" (change)="getWeeksPreview()">
                                                                                                                                <label class="form-check-label" for="weekToDate"> Week to date</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="lastWeekCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastWeekCount" (change)="getWeeksPreview()">
                                                                                                                                <label class="form-check-label" for="lastWeekCount"> Last</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastWeekCount'" [(ngModel)]="last" (input)="getWeeksPreview()">
                                                                                                                                <label class="form-check-label ms-2"> weeks</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextWeekCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextWeekCount" (change)="getWeeksPreview()">
                                                                                                                                <label class="form-check-label" for="nextWeekCount"> Next</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextWeekCount'" [(ngModel)]="next" (input)="getWeeksPreview()">
                                                                                                                                <label class="form-check-label ms-2"> weeks</label>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </ng-template>
                                                                                                        </li>
                                                                                                        <li [ngbNavItem]="5" (click)="selectedDateFormat = 'today';getDaysPreview()" className="nav-link text-start" id="days-tab"><a ngbNavLink>Days</a>
                                                                                                            <ng-template ngbNavContent>
                                                                                                                <div class="tab-pane " id="days" role="tabpanel" aria-labelledby="days-tab"tabindex="0">
                                                                                                                    <div class="col-xl-12 col-lg-12 col-md-12">
                                                                                                                        <div class="previous-year-card">
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="yesterday" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="yesterday" (change)="getDaysPreview()">
                                                                                                                                <label class="form-check-label" for="yesterday"> Yesterday </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="today" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="today" (change)="getDaysPreview()">
                                                                                                                                <label class="form-check-label" for="today"> Today </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="tomorrow" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="tomorrow" (change)="getDaysPreview()">
                                                                                                                                <label class="form-check-label" for="tomorrow"> Tomorrow </label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="lastDaysCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="lastDaysCount" (change)="getDaysPreview()">
                                                                                                                                <label class="form-check-label" for="lastDaysCount"> Last</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 BitSpace text-center" min="1" [disabled]="selectedDateFormat !== 'lastDaysCount'" [(ngModel)]="last" (input)="getDaysPreview()">
                                                                                                                                <label class="form-check-label ms-2"> days</label>
                                                                                                                            </div>
                                                                                                                            <div class="form-check mb-3">
                                                                                                                                <input  type="radio" id="nextDaysCount" name="relativeDates" class="form-check-input" [(ngModel)]="selectedDateFormat" value="nextDaysCount" (change)="getDaysPreview()">
                                                                                                                                <label class="form-check-label" for="nextDaysCount"> Next</label>
                                                                                                                                <input type="number" class="w-20 ms-2 p-0 rounded-2 text-center" min="1" [disabled]="selectedDateFormat !== 'nextDaysCount'" [(ngModel)]="next" (input)="getDaysPreview()">
                                                                                                                                <label class="form-check-label ms-2"> days</label>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </ng-template>
                                                                                                        </li>
                                                                                                        @if(is_sheet_Embed){
                                                                                                            <li [ngbNavItem]="7" (click)="SDKFilterName= '';">
                                                                                                                <a ngbNavLink class="p-3 TabShadow">Embed SDK</a>
                                                                                                                <ng-template ngbNavContent>
                                                                                                                    <div class="tab-pane active" id="activetabs">
                                                                                                                            <div class="form-group p-1 mb-0">
                                                                                                                            <label class="form-label">Filter Name <span  class="text-red">*</span>
                                                                                                                            </label>
                                                                                                                            <input type="text" placeholder="" [(ngModel)]="SDKFilterName" class="form-control border">
                                                                                                                            </div>
                                                                                                                            <div class="form-group p-1 mb-0">
                                                                                                                            <label for="embed" class="form-check-label">Embed SDK</label>
                                                                                                                            <div *ngIf="isEmbed" class="toggle toggle-sm on mb-0" (click)="isEmbed = !isEmbed">
                                                                                                                                <span></span>
                                                                                                                            </div>
                                                                                                                            <div *ngIf="!isEmbed" class="toggle toggle-sm off mb-0" (click)="isEmbed = !isEmbed">
                                                                                                                                <span></span>
                                                                                                                            </div>
                                                                                                                            </div>
                                                                                                                        </div>
                                                                                                              </ng-template>
                                                                                                            </li>
                                                                                                        }
                                                                                                    </ul>
                                                                                                </div>
                                                                                        
                                                                                                <div class="p-2">
                                                                                                    <div class="tab-content" id="vertical-tabContent">
                                                                                                        <div [ngbNavOutlet]="nav"></div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="row p-2">
                                                                                            <div class="col-xl-5 col-lg-5 col-md-5 d-flex align-items-center">
                                                                                                <label class="form-check-label">Preview </label>
                                                                                            </div>
                                                                                            <div class="col-xl-7 col-lg-7 col-md-7">
                                                                                               <div class="d-flex align-items-center">
                                                                                                <input class="form-control" readonly="" disabled="" aria-label="Disabled input example" [(ngModel)]="previewFromDate" type="text">
                                                                                                <label class="form-check-label ms-1 me-1">to </label>
                                                                                                <input class="form-control" readonly="" disabled="" aria-label="Disabled input example" [(ngModel)]="previewToDate" type="text">
                                                                                               </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="row p-2">
                                                                                            <div class="col-xl-5 col-lg-5 col-md-5 d-flex align-items-center">
                                                                                                <input type="checkbox" id="anchor" class="form-check-input" [(ngModel)]="isAnchor" (change)="setAnchorDate()">
                                                                                                <label class="form-check-label" for="anchor"> Anchor relative to </label>
                                                                                            </div>
                                                                                            <div class="col-xl-7 col-lg-7 col-md-7">
                                                                                                <div class="d-flex align-items-center">
                                                                                                    <input *ngIf="!isAnchor" type="text" id="input-label" disabled class="form-control w-50 border" value="Today">
                                                                                                    <input *ngIf="isAnchor" type="date" id="input-label" class="form-control w-50 border" [(ngModel)]="anchorDate" (change)="anchorDateChange()">
                                                                                                </div>
                                                                                             </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            @if(is_sheet_Embed){
                                                                                <li [ngbNavItem]="7" [class.disabled]="activeTabId !== 7"  (click)="SDKFilterName= '';">
                                                                                    <a ngbNavLink class="p-3 TabShadow">Embed SDK</a>
                                                                                    <ng-template ngbNavContent>
                                                                                        <div class="tab-pane active" id="activetabs">
                                                                                                <div class="form-group p-1 mb-0">
                                                                                                <label class="form-label">Filter Name <span  class="text-red">*</span>
                                                                                                </label>
                                                                                                <input type="text" placeholder="" [(ngModel)]="SDKFilterName" class="form-control border">
                                                                                                </div>
                                                                                                <div class="form-group p-1 mb-0">
                                                                                                <label for="embed" class="form-check-label">Embed SDK</label>
                                                                                                <div *ngIf="isEmbed" class="toggle toggle-sm on mb-0" (click)="isEmbed = !isEmbed">
                                                                                                    <span></span>
                                                                                                </div>
                                                                                                <div *ngIf="!isEmbed" class="toggle toggle-sm off mb-0" (click)="isEmbed = !isEmbed">
                                                                                                    <span></span>
                                                                                                </div>
                                                                                            </div>
                                                                                            </div>
                                                                                  </ng-template>
                                                                                </li>
                                                                            }
                                                                        </ul>
                                                                        <div class="panel-body tabs-menu-body p-1" >
                                                                            <div class="tab-content">
                                                                                <div [ngbNavOutlet]="nav"></div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }@else{                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                            <div class="card panel panel-primary">
                                                                <div class="tab-menu-heading tab-menu-heading-boxed">
                                                                    <div class="tabs-menu-boxed">
                                                                        <ul ngbNav #nav="ngbNav" [(activeId)]="activeTabId" class="nav panel-tabs fs-14 pb-1" >
                                                                            <li [ngbNavItem]="1" [class.disabled]="activeTabId !== 1">
                                                                                <a ngbNavLink class="p-3">General</a>
                                                                                <ng-template ngbNavContent>
                                                                                    <div class="tab-pane active" id="activetabs">
                                                                                        <div class="d-flex">
                                                                                            <input type="text" class="form-control border-end-0 " placeholder="Search" [(ngModel)]="editFilterSearch" aria-describedby="button-addon2" >
                                                                                            <button class="btn btn-primary border me-2 search-icon-border-radius"  type="button" id="button-addon2"><i class="fe fe-search "></i></button>
                                                                                        </div>
                                                                                        <div class="form-check">
                                                                                            <input type="checkbox" id="selectAll" [(ngModel)]="isAllSelected" (change)="toggleEditAllRows($event)" class="form-check-input">
                                                                                            <label for="defaultCheck1" class="form-check-label"> Select All </label>
                                                                                        </div>
                                                                                        <!-- <div *ngFor="let data of filterData">
                                                                                            @if(data? data : (boolList.includes(filterType)? true: '')){
                                                                                                <div class="form-check">
                                                                                                    <input type="checkbox" name="checkbox" id="defaultCheck1" [(ngModel)]="data.selected" class="form-check-input" (click)="filterCheck($event,data.label)">    
                                                                                                    <label for="defaultCheck1" class="form-check-label"> {{data.label}}</label>
                                                                                                </div>
                                                                                            }
                                                                                        </div> -->
                                                                                        <cdk-virtual-scroll-viewport itemSize="15" class="viewport" style="height: 510px;">
                                                                                            <div *cdkVirtualFor="let data of filterData | test:editFilterSearch:'label'; trackBy: trackByFn">
                                                                                                <div class="form-check d-flex" >
                                                                                                    <input type="checkbox" [id]="'checkbox' + data.id" [(ngModel)]="data.selected"
                                                                                                        class="form-check-input" (change)="filterCheck($event, data.label)">
                                                                                                    <label [for]="'checkbox' + data.id" class="form-check-label">{{ data.label }}</label>
                                                                                                </div>
                                                                                            </div>
                                                                                        </cdk-virtual-scroll-viewport>
                                                                                    </div>
                                                                                </ng-template>
                                                                            </li>
                                                                            @if( !(dateList.includes(filterType) || integerList.includes(filterType) || filterType == 'calculated') ){
                                                                                <li [ngbNavItem]="4" [class.disabled]="activeTabId !== 4">
                                                                                    <a ngbNavLink class="p-3">Top</a>
                                                                                    <ng-template ngbNavContent>
                                                                                        <div class="tab-pane active" id="activetabs">
                                                                                            <div class="filter-options">
                                                                                                <!-- <label><input type="radio" name="filter" value="none" />None</label> -->
                                                                                                <label><input type="radio" name="filter" value="by-field" checked />By field:</label>
                                                                                            </div>
                                                                                            <div class="ms-4">
                                                                                                <div class="field-options">
                                                                                                    <select [(ngModel)]="topType">
                                                                                                      <option value="desc">Top</option>
                                                                                                      <option value="asc">Bottom</option>
                                                                                                    </select>
                                                                                                    <select [(ngModel)] = "topLimit">
                                                                                                        <option *ngIf="totalDataLength > 0" value="5">5</option>
                                                                                                        <option *ngIf="totalDataLength > 5" value="10">10</option>
                                                                                                        <option *ngIf="totalDataLength > 10" value="20">20</option>
                                                                                                        <option *ngIf="totalDataLength > 20" value="30">30</option>
                                                                                                        <option *ngIf="totalDataLength > 30" value="40">40</option>
                                                                                                        <option *ngIf="totalDataLength > 40" value="50">50</option>
                                                                                                        <option *ngIf="totalDataLength > 50" value="100">100</option>
                                                                                                        <option *ngIf="totalDataLength > 100" value="500">500</option>
                                                                                                        <option *ngIf="totalDataLength > 500" value="1000">1000</option>
                                                                                                        <option *ngIf="totalDataLength > 1000" value="2000">2000</option>
                                                                                                        <option *ngIf="totalDataLength > 2000" value="3000">3000</option>
                                                                                                        <option *ngIf="totalDataLength > 3000" value="4000">4000</option>
                                                                                                        <option *ngIf="totalDataLength > 4000" value="5000">5000</option>
                                                                                                      </select>
                                                                                                    <!-- <input type="number" value="10" /><span>by</span> -->
                                                                                                </div>
                                                                                                <div class="field-options">
                                                                                                    <select class="field-options-width" [(ngModel)]="selectedTopColumn">
                                                                                                        <option value="select" selected disabled> select </option>
                                                                                                        <option *ngFor="let measure of draggedRows" [value]="measure?.column"> {{measure?.column}} </option>
                                                                                                    </select>
                                                                                                    <select class="topAggregate-width" [(ngModel)] = "topAggregate" >
                                                                                                        <option value="sum">Sum</option>
                                                                                                        <option value="avg">Avg</option>
                                                                                                        <option value="min">Min</option>
                                                                                                        <option value="max">Max</option>
                                                                                                        <option value="count">Count</option>
                                                                                                    </select>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </ng-template>
                                                                                </li>
                                                                            }
                                                                            @if(integerList.includes(filterType)){
                                                                                <li [ngbNavItem]="6" [class.disabled]="activeTabId !== 6">
                                                                                    <a ngbNavLink class="p-3 TabShadow">Range of Values</a>
                                                                                    <ng-template ngbNavContent>
                                                                                        <div class="tab-pane" id="linktabs">
                                                                                            <div class="card-body">
                                                                                                <div class="date-box">
                                                                                                    <input type="number" step="1" id="input" [(ngModel)]="minRangeValueInput" (keyup.enter)="updateMeasureRange(true)" (blur)="updateMeasureRange(true)" class="form-control date-box-width">
                                                                                                    <input type="number" step="1" id="input" [(ngModel)]="maxRangeValueInput" (keyup.enter)="updateMeasureRange(true)" (blur)="updateMeasureRange(true)" class="form-control date-box-width">
                                                                                                </div>
                                                                                                <div id="merging-tooltips">
                                                                                                  <ngx-slider 
                                                                                                  [(value)]="minRangeValue"
                                                                                                  [(highValue)]="maxRangeValue"
                                                                                                  [options]="measureValuesOptions"
                                                                                                  (valueChange)="updateMeasureRange(false)"
                                                                                                  (highValueChange)="updateMeasureRange(false)"
                                                                                                ></ngx-slider>
                                                                                                </div>
                                                                                                <span *ngIf="measureRangeError" class="text-danger"> *Note :- {{measureRangeError}} </span>
                                                                                            </div>
                                                                                        </div>
                                                                                    </ng-template>
                                                                                </li>
                                                                            }
                                                                            @if(is_sheet_Embed){
                                                                                <li [ngbNavItem]="7" [class.disabled]="activeTabId !== 7"  (click)="SDKFilterName= '';">
                                                                                    <a ngbNavLink class="p-3 TabShadow">Embed SDK</a>
                                                                                    <ng-template ngbNavContent>
                                                                                        <div class="tab-pane active" id="activetabs">
                                                                                                <div class="form-group p-1 mb-0">
                                                                                                <label class="form-label">Filter Name <span  class="text-red">*</span>
                                                                                                </label>
                                                                                                <input type="text" placeholder="" [(ngModel)]="SDKFilterName" class="form-control border">
                                                                                                </div>
                                                                                                <div class="form-group p-1 mb-0">
                                                                                                <label for="embed" class="form-check-label">Embed SDK</label>
                                                                                                <div *ngIf="isEmbed" class="toggle toggle-sm on mb-0" (click)="isEmbed = !isEmbed">
                                                                                                    <span></span>
                                                                                                </div>
                                                                                                <div *ngIf="!isEmbed" class="toggle toggle-sm off mb-0" (click)="isEmbed = !isEmbed">
                                                                                                    <span></span>
                                                                                                </div>
                                                                                            </div>
                                                                                            </div>
                                                                                  </ng-template>
                                                                                </li>
                                                                            }
                                                                        </ul>
                                                                        <div class="panel-body tabs-menu-body p-1 panel-body-h">
                                                                            <div class="tab-content">
                                                                                <div [ngbNavOutlet]="nav"></div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }

                                                        <!-- @for(data of filterData;track data){
                                                        <div class="form-check">
                                                            <input type="checkbox" name="checkbox" id="defaultCheck1" [(ngModel)]="data.selected" class="form-check-input" (click)="filterCheck($event,data.label)">    
                                                            <label for="defaultCheck1" class="form-check-label"> {{data.label}} </label>
                                                        </div>
                                                    } -->
                                                    </div>
                                                    <div class="modal-footer">
                                                        <div class="col text-left p-0" *ngIf="activeTabId === 1">
                                                            <input type="checkbox" id="exclude" [(ngModel)]="isExclude" class="form-check-input">
                                                            <label for="exclude" class="form-check-label">Exclude</label>
                                                        </div>
                                                        <div class="text-right">
                                                            <button [disabled]="((activeTabId === 1 || activeTabId === 3) && filterDataArray.size === 0 && !isEmbed) || (activeTabId === 2 && (filterDateRange.length === 0 || dateRangeError !== '')) || (activeTabId === 6 && ((minRangeValue === null || minRangeValue === undefined || maxRangeValue === null || maxRangeValue === undefined || measureRangeError !== ''))) || (activeTabId === 4 && selectedTopColumn == 'select') || (activeTabId === 5 && !isRelativeDateValid)||(activeTabId == 7 &&(!SDKFilterName || !isEmbed))" type="button"
                                                                class="btn ripple btn-primary me-2" (click)="filterDataEditPut(); isAllSelected = false;modal.dismiss('Cross click')">Apply</button>
                                                            <button type="button" class="btn ripple btn-secondary" (click)="isAllSelected = false;modal.close('Save click')">
                                                                Close
                                                            </button>
                                                        </div>
                                                    </div>
                                                  </ng-template>
                                            </div>
                                            <div class="border mb-1 rounded-3 charts-card-height">
                                                <div class="card-header  bg-light justify-content-between align-items-center p-2">
                                                    <div class="card-title fs-12">Charts</div>
                                                </div>
                                                <div class="card-body single-axis-card">
                                                    <div class="row">
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': draggedRows?.length<1 && draggedColumns?.length<1}">
                                                            <a href="javascript:void(0);"  triggers="hover" ngbTooltip="Table" tooltipClass="tooltip-primary" (click)="chartDisplay(true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,1);tableDisplayPagination(false);"><img src="./assets/images/charts/Table-chart.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': table}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': draggedRows?.length<1 && draggedColumns?.length<1}">
                                                            <a href="javascript:void(0);"  triggers="hover" ngbTooltip="Pivot Table" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,9);pivotTableDatatransform(false);"><img src="./assets/images/charts/pivot-chart.jpg" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': pivotTable}"></a>
                                                        </div>
                                                        <div class="card-title fs-12 mt-2 mb-1 border bg-light text-center" >Single Axis</div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': (draggedRows?.length>1 || draggedColumns?.length>1) || ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Bar" tooltipClass="tooltip-primary" (click)="chartDisplay(false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,6)"><img src="./assets/images/charts/Bar-chart.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': bar}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': (draggedRows?.length>1 || draggedColumns?.length>1) || ( draggedRows?.length<1 || draggedColumns?.length<1)} ">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Area" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,17)"><img src="./assets/images/charts/area-chart.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': area}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': (draggedRows?.length>1 || draggedColumns?.length>1) || ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Line" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,13)"><img src="./assets/images/charts/Line-chart.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': line}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': (draggedRows?.length>1 || draggedColumns?.length>1) || ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Pie" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,24)"><img src="./assets/images/charts/pie-chart.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon " [ngClass]="{'active': pie}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled':  (draggedRows?.length>1 || draggedColumns?.length>1) || ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Donut" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,10)"><img src="./assets/images/charts/doughnut-chart.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon " [ngClass]="{'active': donut}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled':  (draggedRows?.length>1 || draggedColumns?.length>1) || draggedRows?.length<1 || draggedColumns?.length>0}">
                                                            <a href="javascript:void(0);"  triggers="hover" ngbTooltip="Kpi" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,25)"><img src="./assets/images/charts/kpi-icon.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': kpi}"></a>
                                                        </div>
                                                        <div *ngIf="isApexCharts" class="col-3 px-2 mt-2" [ngClass]="{'disabled':  (draggedRows?.length>1 || draggedColumns?.length>1) || draggedRows?.length<1 || draggedColumns?.length>0 || guagechartRowData > 1 }">
                                                            <a href="javascript:void(0);"  triggers="hover" ngbTooltip="guage" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,28)"><img src="./assets/images/charts/gauge-icon-new.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': guage}"></a>
                                                        </div>
                                                        <div *ngIf="isEChatrts" class="col-3 px-2 mt-2" [ngClass]="{'disabled': !(dateList.includes(draggedColumnsData[0]?.[1]) && draggedRows?.length ===1 && draggedColumns?.length === 1) }">
                                                            <a href="javascript:void(0);"  triggers="hover" [ngbTooltip]="draggedColumnsData[0]?.[2] === '' ? 'Calendar Chart' : 'change Date Extract to None'" tooltipClass="tooltip-primary" container="body" placement="top" (click)="(draggedColumnsData[0]?.[2] === '') ? chartDisplay(false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,11) : null">
                                                                <img src="./assets/images/charts/calendar-chart.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': calendar, 'disabled': draggedColumnsData[0]?.[2] !== ''}">
                                                            </a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': (draggedRows?.length>1 || draggedColumns?.length>1) || ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);"  triggers="hover" ngbTooltip="Funnel Chart" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,27)"><img src="./assets/images/charts/funnelChart-icon.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': funnel}"></a>
                                                        </div>
                                                        <div class="card-title fs-12 mt-2 mb-1 border bg-light text-center ">Dual Axis</div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Side-Bar" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,7)"><img src="./assets/images/charts/bar-bar.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': sidebyside}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Stacked-Bar" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,5)"><img src="./assets/images/charts/stocked_bar.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon " [ngClass]="{'active': stocked}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': draggedRows?.length !== 2 || draggedColumns?.length<1}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Bar-Line" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,4)"><img src="./assets/images/charts/Bar-line.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': barLine}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="HStacked" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,2)"><img src="./assets/images/charts/horizental-stacked.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': horizentalStocked}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="HGrouped" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,3)"><img src="./assets/images/charts/Bar-bar-horizental.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': grouped}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);" triggers="hover" ngbTooltip="Multi-Line" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,8)"><img src="./assets/images/charts/multi-line-new.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': multiLine}"></a>
                                                        </div>
                                                        <div *ngIf="isEChatrts" class="col-3 px-2 mt-2" [ngClass]="{'disabled': ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);"  triggers="hover" ngbTooltip="Radar" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,12)"><img src="./assets/images/charts/spider.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': radar}"></a>
                                                        </div>
                                                        <div class="col-3 px-2 mt-2" [ngClass]="{'disabled': ( draggedRows?.length<1 || draggedColumns?.length<1)}">
                                                            <a href="javascript:void(0);"  triggers="hover" ngbTooltip="Heat Map" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,26)"><img src="./assets/images/charts/heatmap-new.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': heatMap}"></a>
                                                        </div>
                                                        <div *ngIf="isEChatrts" class="col-3 px-2 mt-2" [ngClass]="{'disabled': ( draggedRows?.length<1 || draggedColumns?.length!=1)}">
                                                            <a href="javascript:void(0);"  triggers="hover" ngbTooltip="World Map" tooltipClass="tooltip-primary" (click)="chartDisplay(false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,29)"><img src="./assets/images/charts/world-map.png" class="rounded-2 w-90 mrk-t border p-1 chart-icon" [ngClass]="{'active': map}"></a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                          
                                        </div>
                                    </ng-template>
                                </li>
                                <li [ngbNavItem]="2" [class.disabled]="(draggedColumns?.length === 0 && draggedRows?.length ===0)">
                                     <a ngbNavLink class="p-1">Customize</a>
                                        <ng-template ngbNavContent>
                                            <div class="tab-pane" id="linktabs">
                                                 <div ngbAccordion [closeOthers]="true" class="accordion" id="accordionExample">
                                                    <div *ngIf="(((table && chartId) || (pivotTable && chartId) )&& (draggedColumns?.length !== 0 || draggedRows?.length !==0))" ngbAccordionItem class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                            <button ngbAccordionButton class="accordion-button p-2 border-0 rounded-2 fw-500 border d-flex justify-content-between" type="button" data-bs-toggle="collapse"
                                                                data-bs-target="#collapse" aria-expanded="true" aria-controls="collapse">
                                                                Header
                                                            </button>
                                                    
                                                        </h6>
                                                        <div ngbAccordionCollapse id="collapse" class="accordion-collapse collapse customize-accordion-h" aria-labelledby="heading"
                                                            data-bs-parent="#accordionExample">
                                                            <div class="accordion-body p-0  database-dropdown" ngbAccordionBody>
                                                                <ng-template>
                                                                    <div>
                                                                        <div class="sub-menu-item   mb-0 p-0">
                                                                            <div class="row">
                                                                                <div class="">
                                                                                    <div class="font-color-card mb-1">
                                                                                        <p class="mb-0">Fonts</p>
                                                                                        <div class="dropup" ngbDropdown>
                                                                                            <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2"
                                                                                                ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                            <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                                <div class="dropup" ngbDropdown>
                                                                                                    <div class="form-group mb-0 p-1">
                                                                                                        <select class="form-select form-select select2 fs-14"
                                                                                                            [(ngModel)]="headerFontFamily" (change)="pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                            <option value="'Arial', sans-serif">Arial</option>
                                                                                                            <option value="'Helvetica', sans-serif">Helvetica</option>
                                                                                                            <option value="'Verdana', sans-serif">Verdana</option>
                                                                                                            <option value="'Open Sans', sans-serif">Open Sans</option>
                                                                                                            <option value="'Times New Roman', serif">Times New Roman</option>
                                                                                                            <option value="'Georgia', serif">Georgia</option>
                                                                                                            <option value="'Merriweather', serif">Merriweather</option>
                                                                                                            <option value="'Roboto', sans-serif">Roboto</option>
                                                                                                            <option value="Algerian">Algerian</option>
                                                                                                            <option value="Bahnschrift">Bahnschrift</option>
                                                                                                            <option value="sans-serif">Sans Serif</option>
                                                                                                            <option value="Calibri">Calibri</option>
                                                                                                        </select>
                                                                                                    </div>
                                                                                                    <div class="bold-italic p-1">
                                                                                                        <div class="row">
                                                                                                            <div class="form-group mb-0 d-flex">
                                                                                                                <select class="form-select form-select select2 fs-14"
                                                                                                                     [(ngModel)]="headerFontSize" (change)="pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <option value="10px">10px</option>
                                                                                                                    <option value="11px">11px</option>
                                                                                                                    <option value="12px">12px</option>
                                                                                                                    <option value="13px">13px</option>
                                                                                                                    <option value="14px">14px</option>
                                                                                                                    <option value="15px">15px</option>
                                                                                                                    <option value="16px">16px</option>
                                                                                                                    <option value="17px">17px</option>
                                                                                                                    <option value="18px">18px</option>
                                                                                                                    <option value="19px">19px</option>
                                                                                                                    <option value="20px">20px</option>
                                                                                                                </select>
                                                                                                                <div class="bold-text"
                                                                                                                    [ngStyle]="{'background-color': headerFontWeight === 700 ? 'var(--primary-color)': '#fafcfc'}"
                                                                                                                    (click)="isTableHeaderBold = !isTableHeaderBold;headerFontWeight = isTableHeaderBold ? 700 : 400 ;pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <p>B</p>
                                                                                                                </div>
                                                                                                                <div class="italic-text"
                                                                                                                    [ngStyle]="{'background-color': headerFontStyle === 'italic' ? 'var(--primary-color)': '#fafcfc'}"
                                                                                                                    (click)="isItalic = !isItalic;headerFontStyle = isItalic ? 'italic' : 'normal';pivotTable ? applyDynamicStylesToPivot() : null ">
                                                                                                                    <p>I</p>
                                                                                                                </div>
                                                                                                                <div class="underline-text"
                                                                                                                    [ngStyle]="{'background-color': headerFontDecoration === 'underline' ? 'var(--primary-color)': '#fafcfc'}"
                                                                                                                    (click)="isUnderline = !isUnderline;headerFontDecoration = isUnderline ? 'underline' : 'none';pivotTable ? applyDynamicStylesToPivot() : null ">
                                                                                                                    <p>U</p>
                                                                                                                </div>
                                                                                                            </div>
                                                        
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div class="color-shade-card p-1">
                                                                                                        <div *ngFor="let row of colorPalette" class="row px-4">
                                                                                                            <div *ngFor="let colorClass of row" [class]="colorClass"
                                                                                                                (click)="headerColorChange($event)">
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                        
                                                                                                </div>
                                                                                                <li *ngIf="false">
                                                                                                    <p class="more-color-text">More colors...</p>
                                                                                                </li>
                                                                                            </ul>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <span ngbTooltip=""></span>
                                                                            </div>
                                                                            <div class="sub-menu-item mb-0 p-0">
                                                                                <div class="row">
                                                                                  <div class="">
                                                                                      <div class="font-color-card">
                                                                                          <p class="mb-0">Alignments</p>
                                                                                          <div class="dropup" ngbDropdown>
                                                                                              <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                              <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                                  <div class="dropup" ngbDropdown >
                                                                                                      <div class=" p-1">
                                                                                                              <div class="form-group mb-0 text-center" (click)="headerFontAlignment = 'left';pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                <button class="btn btn-blue-light Automatic-btn">Automatic</button>                                                                                                 
                                                                                                              </div>
                                                                                                              <div class="form-group mb-0 alignment-sides">
                                                                                                                 <div class="align-left" [ngStyle]="{'background-color': headerFontAlignment == 'left' ? 'var(--primary-color)': '#fafcfc'}" (click)="headerFontAlignment = 'left';pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <i class="fa fa-align-left"></i>
                                                                                                                </div>
                                                                                                                <div  class="align-center" [ngStyle]="{'background-color': headerFontAlignment == 'center' ? 'var(--primary-color)': '#fafcfc'}" (click)="headerFontAlignment = 'center';pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <i class="fa fa-align-center"></i>
                                                                                                                </div>
                                                                                                                <div class="align-right" [ngStyle]="{'background-color': headerFontAlignment == 'right' ? 'var(--primary-color)': '#fafcfc'}" (click)="headerFontAlignment = 'right';pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <i class="fa fa-align-right"></i>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>                                                                                    
                                                                                                  </div>
                                                                                              </ul>
                                                                                          </div>
                                                                                  </div>
                                                                                </div>
                                                                              </div>
                                                                            </div>
                                                                            <span ngbTooltip=""></span>
                                                                        </div>
                                                                    </div>
                                                                </ng-template>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="((table && chartId || pivotTable && chartId) && (draggedColumns?.length !== 0 || draggedRows?.length !==0))" ngbAccordionItem class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                            <button ngbAccordionButton class="accordion-button p-2 border-0 rounded-2 fw-500 border" type="button" data-bs-toggle="collapse"
                                                                data-bs-target="#collapse" aria-expanded="true" aria-controls="collapse">
                                                                Table Data
                                                            </button>
                                                    
                                                        </h6>
                                                        <div ngbAccordionCollapse id="collapse" class="accordion-collapse collapse customize-accordion-h" aria-labelledby="heading"
                                                            data-bs-parent="#accordionExample">
                                                            <div class="accordion-body p-0  database-dropdown" ngbAccordionBody>
                                                                <ng-template>
                                                                    <div>
                                                                        <div class="sub-menu-item  p-2 mb-0">
                                                                            <div class="row">
                                                                                <div class="">
                                                                                    <div class="font-color-card mb-0">
                                                                                        <p class="mb-0">Fonts</p>
                                                                                        <div class="dropup" ngbDropdown>
                                                                                            <i class="fe fe-chevron-down fs-18 text-body-secondary border rounded-2 dropdown-toggle"
                                                                                                ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                            <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                                <div class="dropup" ngbDropdown>
                                                                                                    <div class="form-group mb-0 p-1">
                                                                                                        <select class="form-select form-select select2 fs-14"
                                                                                                            [(ngModel)]="tableDataFontFamily" (change)="pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                            <option value="'Arial', sans-serif">Arial</option>
                                                                                                            <option value="'Helvetica', sans-serif">Helvetica</option>
                                                                                                            <option value="'Verdana', sans-serif">Verdana</option>
                                                                                                            <option value="'Open Sans', sans-serif">Open Sans</option>
                                                                                                            <option value="'Times New Roman', serif">Times New Roman</option>
                                                                                                            <option value="'Georgia', serif">Georgia</option>
                                                                                                            <option value="'Merriweather', serif">Merriweather</option>
                                                                                                            <option value="'Roboto', sans-serif">Roboto</option>
                                                                                                            <option value="Algerian">Algerian</option>
                                                                                                            <option value="Bahnschrift">Bahnschrift</option>
                                                                                                            <option value="sans-serif">Sans Serif</option>
                                                                                                            <option value="Calibri">Calibri</option>
                                                                                                        </select>
                                                                                                    </div>
                                                                                                    <div class="bold-italic p-1">
                                                                                                        <div class="row">
                                                                                                            <div class="form-group mb-0 d-flex">
                                                                                                                <select class="form-select form-select select2 fs-14"
                                                                                                                     [(ngModel)]="tableDataFontSize" (change)="pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <option value="10px">10px</option>
                                                                                                                    <option value="11px">11px</option>
                                                                                                                    <option value="12px">12px</option>
                                                                                                                    <option value="13px">13px</option>
                                                                                                                    <option value="14px">14px</option>
                                                                                                                    <option value="15px">15px</option>
                                                                                                                    <option value="16px">16px</option>
                                                                                                                    <option value="17px">17px</option>
                                                                                                                    <option value="18px">18px</option>
                                                                                                                    <option value="19px">19px</option>
                                                                                                                    <option value="20px">20px</option>
                                                                                                                </select>
                                                                                                                <div class="bold-text"
                                                                                                                    [ngStyle]="{'background-color': tableDataFontWeight === 700 ? 'var(--primary-color)': '#fafcfc'}"
                                                                                                                    (click)="isTableDataBold = !isTableDataBold;tableDataFontWeight = isTableDataBold ? 700 : 400 ;pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <p>B</p>
                                                                                                                </div>
                                                                                                                <div class="italic-text"
                                                                                                                    [ngStyle]="{'background-color': tableDataFontStyle === 'italic' ? 'var(--primary-color)': '#fafcfc'}"
                                                                                                                    (click)="isItalic = !isItalic;tableDataFontStyle = isItalic ? 'italic' : 'normal' ;pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <p>I</p>
                                                                                                                </div>
                                                                                                                <div class="underline-text"
                                                                                                                    [ngStyle]="{'background-color': tableDataFontDecoration === 'underline' ? 'var(--primary-color)': '#fafcfc'}"
                                                                                                                    (click)="isUnderline = !isUnderline;tableDataFontDecoration = isUnderline ? 'underline' : 'none' ;pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <p>U</p>
                                                                                                                </div>
                                                                                                            </div>
                                                        
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <div class="color-shade-card p-1">
                                                                                                        <div *ngFor="let row of colorPalette" class="row px-4">
                                                                                                            <div *ngFor="let colorClass of row" [class]="colorClass"
                                                                                                                (click)="tableDataColorChange($event)">
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                        
                                                                                                </div>
                                                                                                <li *ngIf="false">
                                                                                                    <p class="more-color-text">More colors...</p>
                                                                                                </li>
                                                                                            </ul>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <span ngbTooltip=""></span>
                                                                            </div>
                                                                            <div class="sub-menu-item mb-0 p-0">
                                                                                <div class="row">
                                                                                  <div class="">
                                                                                      <div class="font-color-card">
                                                                                          <p class="mb-0">Alignments</p>
                                                                                          <div class="dropup" ngbDropdown>
                                                                                              <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                              <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                                  <div class="dropup" ngbDropdown >
                                                                                                      <div class=" p-1">
                                                                                                              <div class="form-group mb-0 text-center" (click)="tableDataFontAlignment = 'left';pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                <button class="btn btn-blue-light Automatic-btn">Automatic</button>                                                                                                 
                                                                                                              </div>
                                                                                                              <div class="form-group mb-0 alignment-sides">
                                                                                                                 <div class="align-left" [ngStyle]="{'background-color': tableDataFontAlignment == 'left' ? 'var(--primary-color)': '#fafcfc'}" (click)="tableDataFontAlignment = 'left';pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <i class="fa fa-align-left"></i>
                                                                                                                </div>
                                                                                                                <div  class="align-center" [ngStyle]="{'background-color': tableDataFontAlignment == 'center' ? 'var(--primary-color)': '#fafcfc'}" (click)="tableDataFontAlignment = 'center';pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <i class="fa fa-align-center"></i>
                                                                                                                </div>
                                                                                                                <div class="align-right" [ngStyle]="{'background-color': tableDataFontAlignment == 'right' ? 'var(--primary-color)': '#fafcfc'}" (click)="tableDataFontAlignment = 'right';pivotTable ? applyDynamicStylesToPivot() : null">
                                                                                                                    <i class="fa fa-align-right"></i>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>                                                                                    
                                                                                                  </div>
                                                                                              </ul>
                                                                                          </div>
                                                                                  </div>
                                                                                </div>
                                                                              </div>
                                                                            </div>
                                                                            <span ngbTooltip=""></span>
                                                                        </div>
                                                                    </div>
                                                                </ng-template>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="!(table || kpi || pivotTable)" ngbAccordionItem class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                            <button ngbAccordionButton class="accordion-button p-2 fw-500 border-0 rounded-2" type="button" data-bs-toggle="collapse"
                                                                data-bs-target="#collapse" aria-expanded="true" aria-controls="collapse">
                                                                Chart Plugin
                                                            </button>
                                                    
                                                        </h6>
                                                        <div ngbAccordionCollapse id="collapse" class="accordion-collapse collapse customize-accordion-h" aria-labelledby="heading"
                                                            data-bs-parent="#accordionExample">
                                                            <div class="accordion-body p-0  database-dropdown" ngbAccordionBody>
                                                                <ng-template>
                                                                    <div>
                                                                        <div class="sub-menu-item  p-2">
                                                                            <div class="form-group mb-0 p-0">
                                                                                <select class="form-select form-select select2 fs-14" [(ngModel)]="selectedChartPlugin"
                                                                                    (change)="customizechangeChartPlugin()">
                                                                                    <option *ngIf="!(radar || calendar || map)" value="apex">Basic</option>
                                                                                    <option *ngIf="!(guage)" value="echart">Advanced</option>
                                                                                </select>
                                                                            </div>
                                                    
                                                                            <span ngbTooltip=""></span>
                                                                        </div>
                                                                    </div>
                                                                </ng-template>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="!((table && chartId) || (pie && chartId) || donut || kpi || funnel || guage || calendar || radar || pivotTable)" ngbAccordionItem  class="accordion-item mb-2 border rounded-2">
                                                          <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                            <button
                                                              ngbAccordionButton
                                                              class="accordion-button p-2 fw-500 border-0 rounded-2"
                                                              type="button"
                                                              data-bs-toggle="collapse"
                                                              data-bs-target="#collapse"
                                                              aria-expanded="true"
                                                              aria-controls="collapse"
                                                              >
                                                              Dimensions
                                                            </button>
                                                            
                                                          </h6>
                                                          <div
                                                            ngbAccordionCollapse
                                                            id="collapse"
                                                            class="accordion-collapse collapse customize-accordion-h" 
                                                            aria-labelledby="heading"
                                                            data-bs-parent="#accordionExample"
                                                             >
                                                            <div class="accordion-body p-0  database-dropdown" ngbAccordionBody>
                                                              <!-- <button type="button" data-bs-dismiss="alert" aria-label="Close" class="btn-close mt-0">
                                                                  <i class="bi bi-arrows-fullscreen drilldown-icon"></i>
                                                              </button> -->
                                                              <ng-template>
                                                                <div >
                                                                  <div class="sub-menu-item  p-2 mb-0" >
                                                                          <div class="row">
                                                                            <div class="" >
                                                                                <div class="font-color-card mb-1">
                                                                                    <p class="mb-0">Fonts</p>
                                                                                    <div class="dropup" ngbDropdown>
                                                                                        <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2 " ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                        <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                            <div class="dropup" ngbDropdown >
                                                                                                <div class="form-group mb-0 p-1">
                                                                                                    <select class="form-select form-select select2 fs-14" [(ngModel)]="xLabelFontFamily">
                                                                                                        <option value="'Arial', sans-serif">Arial</option>
                                                                                                        <option value="'Helvetica', sans-serif">Helvetica</option>
                                                                                                        <option value="'Verdana', sans-serif">Verdana</option>
                                                                                                        <option value="'Open Sans', sans-serif">Open Sans</option>
                                                                                                        <option value="'Times New Roman', serif">Times New Roman</option>
                                                                                                        <option value="'Georgia', serif">Georgia</option>
                                                                                                        <option value="'Merriweather', serif">Merriweather</option>
                                                                                                        <option value="'Roboto', sans-serif">Roboto</option>
                                                                                                        <option value="Algerian">Algerian</option>
                                                                                                        <option value="Bahnschrift">Bahnschrift</option>
                                                                                                        <option value="sans-serif">Sans Serif</option>
                                                                                                        <option value="Calibri">Calibri</option>
                                                                                                    </select>
                                                                                                </div>
                                                                                                <div class="bold-italic p-1">
                                                                                                    <div class="row">
                                                                                                        <div class="form-group mb-0 d-flex">
                                                                                                            <select class="form-select form-select select2 fs-14" [(ngModel)]="xLabelFontSize">
                                                                                                                <option value="10">10px</option>
                                                                                                                <option value="11">11px</option>
                                                                                                                <option value="12">12px</option>
                                                                                                                <option value="13">13px</option>
                                                                                                                <option value="14">14px</option>
                                                                                                                <option value="15">15px</option>
                                                                                                                <option value="16">16px</option>
                                                                                                                <option value="17">17px</option>
                                                                                                                <option value="18">18px</option>
                                                                                                                <option value="19">19px</option>
                                                                                                                <option value="20">20px</option>
                                                                                                             </select>
                                                                                                             <div class="bold-text" [ngStyle]="{'background-color': isXlabelBold ? 'var(--primary-color)': '#fafcfc'}" (click)="isXlabelBold = !isXlabelBold;xlabelFontWeight = isXlabelBold ? 700 : 400 ;">
                                                                                                                <p>B</p>
                                                                                                            </div>
                                                                                                            <div *ngIf="false" class="italic-text" [ngStyle]="{'background-color': isItalic ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontStyle('I')">
                                                                                                                <p>I</p>
                                                                                                            </div>
                                                                                                            <div *ngIf="false" class="underline-text" [ngStyle]="{'background-color': isUnderline ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontStyle('U')">
                                                                                                                <p>U</p>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                       
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="color-shade-card p-1" *ngIf="isEChatrts">
                                                                                                    <div *ngFor="let row of colorPalette" class="row px-4">
                                                                                                      <div
                                                                                                        *ngFor="let colorClass of row"
                                                                                                        [class]="colorClass"
                                                                                                        (click)="dimensionsColorChange($event)">
                                                                                                      </div>
                                                                                                    </div>
                                                                                                  </div>
                                                                                              
                                                                                            </div>
                                                                                            <li *ngIf="false"> <p class="more-color-text">More colors...</p></li>
                                                                                        </ul>
                                                                                    </div>
                                                                            </div>
                                                                          </div>
                                                                          <span ngbTooltip=""></span>
                                                                        </div>
                                                                        <div class="sub-menu-item mb-0 p-0">
                                                                            <div class="row">
                                                                              <div class="">
                                                                                  <div class="font-color-card">
                                                                                      <p class="mb-0">Alignments</p>
                                                                                      <div class="dropup" ngbDropdown>
                                                                                          <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                          <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                              <div class="dropup" ngbDropdown >
                                                                                                  <div class=" p-1">
                                                                                                          <div class="form-group mb-0 text-center" (click)="allignmentChange('center','dimension')">
                                                                                                            <button class="btn btn-blue-light Automatic-btn">Automatic</button>                                                                                                 
                                                                                                          </div>
                                                                                                          <div class="form-group mb-0 alignment-sides">
                                                                                                             <div class="align-left" [ngStyle]="{'background-color': dimensionAlignment == 'left' ? 'var(--primary-color)': '#fafcfc'}" (click)="allignmentChange('left','dimension')">
                                                                                                                <i class="fa fa-align-left"></i>
                                                                                                            </div>
                                                                                                            <div  class="align-center" [ngStyle]="{'background-color': dimensionAlignment == 'center' ? 'var(--primary-color)': '#fafcfc'}" (click)="allignmentChange('center','dimension')">
                                                                                                                <i class="fa fa-align-center"></i>
                                                                                                            </div>
                                                                                                            <div class="align-right" [ngStyle]="{'background-color': dimensionAlignment == 'right' ? 'var(--primary-color)': '#fafcfc'}" (click)="allignmentChange('right','dimension')">
                                                                                                                <i class="fa fa-align-right"></i>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>                                                                                    
                                                                                              </div>
                                                                                          </ul>
                                                                                      </div>
                                                                              </div>
                                                                            </div>
                                                                          </div>
                                                                        </div>
                                                                   
                                                                    <span ngbTooltip=""></span>
                                                                  </div>
                                                                </div>
                                                              </ng-template>
                                                            </div>
                                                          </div>
                                                    </div>

                                                    <div *ngIf="!((table && chartId) || (pie && chartId) || donut || funnel || kpi || guage || calendar || radar || pivotTable)" ngbAccordionItem  class="accordion-item mb-2 border rounded-2">
                                                            <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                              <button
                                                                ngbAccordionButton
                                                                class="accordion-button p-2 fw-500 border-0 rounded-2"
                                                                type="button"
                                                                data-bs-toggle="collapse"
                                                                data-bs-target="#collapse"
                                                                aria-expanded="true"
                                                                aria-controls="collapse"
                                                                >
                                                                Measures
                                                              </button>
                                                              
                                                            </h6>
                                                            <div
                                                              ngbAccordionCollapse
                                                              id="collapse"
                                                              class="accordion-collapse collapse customize-accordion-h" 
                                                              aria-labelledby="heading"
                                                              data-bs-parent="#accordionExample"
                                                               >
                                                              <div class="accordion-body p-0  database-dropdown" ngbAccordionBody>
                                                            
                                                                <ng-template>
                                                                  <div >
                                                                    <div class="sub-menu-item  p-2 mb-0" >
                                                                        <div class="row">
                                                                            
                                                                        </div>
                                                                      
                                                                      <div class="row">
                                                                        <div class="" >
                                                                            <div class="font-color-card mb-1">
                                                                                <p class="mb-0">Fonts</p>
                                                                                <div class="dropup" ngbDropdown>
                                                                                    <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                    <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                        <div class="dropup" ngbDropdown >
                                                                                            <div class="form-group mb-0 p-1">
                                                                                                <select class="form-select form-select select2 fs-14" [(ngModel)]="yLabelFontFamily">
                                                                                                    <option value="'Arial', sans-serif">Arial</option>
                                                                                                    <option value="'Helvetica', sans-serif">Helvetica</option>
                                                                                                    <option value="'Verdana', sans-serif">Verdana</option>
                                                                                                    <option value="'Open Sans', sans-serif">Open Sans</option>
                                                                                                    <option value="'Times New Roman', serif">Times New Roman</option>
                                                                                                    <option value="'Georgia', serif">Georgia</option>
                                                                                                    <option value="'Merriweather', serif">Merriweather</option>
                                                                                                    <option value="'Roboto', sans-serif">Roboto</option>
                                                                                                    <option value="Algerian">Algerian</option>
                                                                                                    <option value="Bahnschrift">Bahnschrift</option>
                                                                                                    <option value="sans-serif">Sans Serif</option>
                                                                                                    <option value="Calibri">Calibri</option>
                                                                                                </select>
                                                                                            </div>
                                                                                            <div class="bold-italic p-1">
                                                                                                <div class="row">
                                                                                                    <div class="form-group mb-0 d-flex">
                                                                                                        <select class="form-select form-select select2 fs-14"  [(ngModel)]="yLabelFontSize">
                                                                                                            <option value="10">10px</option>
                                                                                                            <option value="11">11px</option>
                                                                                                            <option value="12">12px</option>
                                                                                                            <option value="13">13px</option>
                                                                                                            <option value="14">14px</option>
                                                                                                            <option value="15">15px</option>
                                                                                                            <option value="16">16px</option>
                                                                                                            <option value="17">17px</option>
                                                                                                            <option value="18">18px</option>
                                                                                                            <option value="19">19px</option>
                                                                                                            <option value="20">20px</option>
                                                                                                         </select>
                                                                                                         <div class="bold-text" [ngStyle]="{'background-color': isYlabelBold ? 'var(--primary-color)': '#fafcfc'}" (click)="isYlabelBold = !isYlabelBold;ylabelFontWeight = isYlabelBold ? 700 : 400 ;">
                                                                                                            <p>B</p>
                                                                                                        </div>
                                                                                                        <div *ngIf="false" class="italic-text" [ngStyle]="{'background-color': isItalic ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontStyle('I')">
                                                                                                            <p>I</p>
                                                                                                        </div>
                                                                                                        <div *ngIf="false" class="underline-text" [ngStyle]="{'background-color': isUnderline ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontStyle('U')">
                                                                                                            <p>U</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                   
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="color-shade-card p-1" *ngIf="isEChatrts">
                                                                                                <div *ngFor="let row of colorPalette" class="row px-4">
                                                                                                  <div
                                                                                                    *ngFor="let colorClass of row"
                                                                                                    [class]="colorClass"
                                                                                                    (click)="measuresColorChange($event)">
                                                                                                  </div>
                                                                                                </div>
                                                                                              </div>

                                                                                        </div>
                                                                                        <li *ngIf="false"> <p class="more-color-text">More colors...</p></li>
                                                                                    </ul>
                                                                                </div>
                                                                        </div>
                                                                      </div>
                                                                      <span ngbTooltip=""></span>
                                                                    </div>
                                                                    <div *ngIf="isApexCharts" class="sub-menu-item mb-0 p-0 ">
                                                                        <div class="row">
                                                                          <div class="">
                                                                              <div class="font-color-card">
                                                                                  <p class="mb-0">Alignments</p>
                                                                                  <div class="dropup" ngbDropdown>
                                                                                      <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                      <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                          <div class="dropup" ngbDropdown >
                                                                                                <div class=" p-1 mt-2 mb-2">
                                                                                                    <div class="form-group mb-0 text-center" (click)="allignmentChange('center','measure')">
                                                                                                      <button class="btn btn-blue-light Automatic-btn">Automatic</button>                                                                                                 
                                                                                                    </div>
                                                                                                    <div class="form-group mb-0 alignment-sides">
                                                                                                       <div class="justify-bottom" [ngStyle]="{'background-color': measureAlignment == 'bottom' ? 'var(--primary-color)': '#fafcfc'}" (click)="allignmentChange('bottom','measure')">
                                                                                                          <i class="fa fa-align-justify"></i>
                                                                                                      </div>
                                                                                                      <div  class="justify-middle" [ngStyle]="{'background-color': measureAlignment == 'center' ? 'var(--primary-color)': '#fafcfc'}" (click)="allignmentChange('center','measure')">
                                                                                                          <i class="fa fa-align-justify"></i>
                                                                                                      </div>
                                                                                                      <div class="justify-top" [ngStyle]="{'background-color': measureAlignment == 'top' ? 'var(--primary-color)': '#fafcfc'}" (click)="allignmentChange('top','measure')">
                                                                                                          <i class="fa fa-align-justify"></i>
                                                                                                      </div>
                                                                                                  </div>
                                                                                              </div>                                                                                  
                                                                                          </div>
                                                                                      </ul>
                                                                                  </div>
                                                                          </div>
                                                                        </div>
                                                                      </div>
                                                                    </div>
                                                                     
                                                                      <span ngbTooltip=""></span>
                                                                    </div>
                                                                  </div>
                                                                </ng-template>
                                                              </div>
                                                            </div>
                                                    </div>

                                                    <div *ngIf="!((pie && chartId) || donut || calendar || map || pivotTable || (table && draggedRows?.length === 0))" ngbAccordionItem  class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                          <button
                                                            ngbAccordionButton
                                                            class="accordion-button p-2 fw-500 border-0 rounded-2 "
                                                            type="button"
                                                            data-bs-toggle="collapse"
                                                            data-bs-target="#collapse"
                                                            aria-expanded="true"
                                                            aria-controls="collapse"
                                                            >
                                                            Measure Values
                                                          </button>
                                                          
                                                        </h6>
                                                        <div
                                                          ngbAccordionCollapse
                                                          id="collapse"
                                                          class="accordion-collapse collapse customize-accordion-h" 
                                                          aria-labelledby="heading"
                                                          data-bs-parent="#accordionExample"
                                                           >
                                                          <div class="accordion-body p-2  database-dropdown" ngbAccordionBody>
                                                            <!-- <button type="button" data-bs-dismiss="alert" aria-label="Close" class="btn-close mt-0">
                                                                <i class="bi bi-arrows-fullscreen drilldown-icon"></i>
                                                            </button> -->
                                                            <ng-template>
                                                                <div class="sub-menu-item mb-0 p-0" *ngIf="!kpi && !table">
                                                                  <div class="row">
                                                                    <div class="" >
                                                                        <div class="font-color-card mb-1">
                                                                            <p class="mb-0">Fonts</p>
                                                                            <div class="dropup" ngbDropdown>
                                                                                <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                                <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                    <div class="dropup" ngbDropdown >
                                                                                        <div class="form-group mb-0 p-1">
                                                                                            <select class="form-select form-select select2 fs-14" [(ngModel)]="dataLabelsFontFamily" >
                                                                                                <option value="0" selected disabled>family</option>
                                                                                                <option value="'Arial', sans-serif">Arial</option>
                                                                                                <option value="'Helvetica', sans-serif">Helvetica</option>
                                                                                                <option value="'Verdana', sans-serif">Verdana</option>
                                                                                                <option value="'Open Sans', sans-serif">Open Sans</option>
                                                                                                <option value="'Times New Roman', serif">Times New Roman</option>
                                                                                                <option value="'Georgia', serif">Georgia</option>
                                                                                                <option value="'Merriweather', serif">Merriweather</option>
                                                                                                <option value="'Roboto', sans-serif">Roboto</option>
                                                                                                <option value="Algerian">Algerian</option>
                                                                                                <option value="Bahnschrift">Bahnschrift</option>
                                                                                                <option value="sans-serif">Sans Serif</option>
                                                                                                <option value="Calibri">Calibri</option>
                                                                                            </select>
                                                                                        </div>
                                                                                        <div class="bold-italic p-1">
                                                                                            <div class="row">
                                                                                                <div class="form-group mb-0 d-flex">
                                                                                                    <select class="form-select form-select select2 fs-14" [(ngModel)]="dataLabelsFontSize">
                                                                                                        <option value="0" selected disabled>size</option>
                                                                                                        <option value="10px">10px</option>
                                                                                                        <option value="11px">11px</option>
                                                                                                        <option value="12px">12px</option>
                                                                                                        <option value="13px">13px</option>
                                                                                                        <option value="14px">14px</option>
                                                                                                        <option value="15px">15px</option>
                                                                                                        <option value="16px">16px</option>
                                                                                                        <option value="17px">17px</option>
                                                                                                        <option value="18px">18px</option>
                                                                                                        <option value="19px">19px</option>
                                                                                                        <option value="20px">20px</option>
                                                                                                     </select>
                                                                                                     <div class="bold-text" [ngStyle]="{'background-color': isBold ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontStyle('B')">
                                                                                                        <p>B</p>
                                                                                                    </div>
                                                                                                    <div *ngIf="false" class="italic-text" [ngStyle]="{'background-color': isItalic ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontStyle('I')">
                                                                                                        <p>I</p>
                                                                                                    </div>
                                                                                                    <div *ngIf="false" class="underline-text" [ngStyle]="{'background-color': isUnderline ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontStyle('U')">
                                                                                                        <p>U</p>
                                                                                                    </div>
                                                                                                </div>
                                                                                               
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="color-shade-card p-1">
                                                                                            <div *ngFor="let row of colorPalette" class="row px-4">
                                                                                              <div
                                                                                                *ngFor="let colorClass of row"
                                                                                                [class]="colorClass"
                                                                                                (click)="dataLabelsFontColor($event)">
                                                                                              </div>
                                                                                            </div>
                                                                                          </div>

                                                                                      
                                                                                    </div>
                                                                                    <li> <p class="more-color-text">More colors...</p></li>
                                                                                </ul>
                                                                            </div>
                                                                    </div>
                                                                  </div>
                                                                  <span ngbTooltip=""></span>
                                                                </div>
                                                              </div>
                                                              <div class="sub-menu-item  mb-0 p-0" *ngIf="!(kpi || table || guage || calendar || map || radar || barLine || (isApexCharts && (heatMap)))">
                                                                <div class="row">
                                                                  <div class="">
                                                                      <div class="font-color-card p-0">
                                                                          <p class="mb-0">Alignments</p>
                                                                          <div class="dropup" ngbDropdown>
                                                                              <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle border rounded-2" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                              <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                  <div class="dropup" ngbDropdown >
                                                                                    <div class=" p-1" *ngIf="horizentalStocked || grouped || funnel">
                                                                                        <div class="form-group mb-0 text-center" (click)="setDataLabelsFontPosition('top')">
                                                                                          <button class="btn btn-blue-light Automatic-btn">Automatic</button>                                                                                                 
                                                                                        </div>
                                                                                        <div class="form-group mb-0 alignment-sides">
                                                                                           <div class="align-left" [ngStyle]="{'background-color': dataLabelsFontPosition == 'bottom' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontPosition('bottom')">
                                                                                              <i class="fa fa-align-left"></i>
                                                                                          </div>
                                                                                          <div  class="align-center" [ngStyle]="{'background-color': dataLabelsFontPosition == 'center' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontPosition('center')">
                                                                                              <i class="fa fa-align-center"></i>
                                                                                          </div>
                                                                                          <div class="align-right" [ngStyle]="{'background-color': dataLabelsFontPosition == 'top' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontPosition('top')">
                                                                                              <i class="fa fa-align-right"></i>
                                                                                          </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class=" p-1 mt-2 mb-2" *ngIf="!(horizentalStocked || grouped || funnel)">
                                                                                        <div class="form-group mb-0 text-center" (click)="setDataLabelsFontPosition('top')">
                                                                                            <button class="btn btn-blue-light Automatic-btn">Automatic</button>
                                                                                        </div>
                                                                                        <div class="form-group mb-0 alignment-sides">
                                                                                            <div class="justify-bottom" [ngStyle]="{'background-color': dataLabelsFontPosition == 'bottom' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontPosition('bottom')">
                                                                                                <i class="fa fa-align-justify"></i>
                                                                                            </div>
                                                                                            <div class="justify-middle" [ngStyle]="{'background-color': dataLabelsFontPosition == 'center' ? 'var(--primary-color)': '#fafcfc'}" (click)=" setDataLabelsFontPosition('center')">
                                                                                                <i class="fa fa-align-justify"></i>
                                                                                            </div>
                                                                                            <div class="justify-top" [ngStyle]="{'background-color': dataLabelsFontPosition == 'top' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsFontPosition('top')">
                                                                                                <i class="fa fa-align-justify"></i>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                   
                                                                                  </div>
                                                                              </ul>
                                                                          </div>
                                                                  </div>
                                                                </div>
                                                              </div>
                                                            </div>

                                                            <div class="sub-menu-item  p-2 mb-0" *ngIf="barLine && isEChatrts">
                                                                <div class="row">
                                                                  <div class="">
                                                                      <div class="font-color-card">
                                                                          <p class="mb-0">Bar Alignments</p>
                                                                          <div class="dropup" ngbDropdown>
                                                                              <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                              <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                  <div class="dropup" ngbDropdown >
                                                                                    
                                                                                    <div class=" p-1 mt-2 mb-2" *ngIf="barLine">
                                                                                        <div class="form-group mb-0 text-center" (click)="setDataLabelsBarFontPosition('top')">
                                                                                            <button class="btn btn-blue-light Automatic-btn">Automatic</button>
                                                                                        </div>
                                                                                        <div class="form-group mb-0 alignment-sides">
                                                                                            <div class="justify-bottom" [ngStyle]="{'background-color': dataLabelsBarFontPosition == 'bottom' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsBarFontPosition('bottom')">
                                                                                                <i class="fa fa-align-justify"></i>
                                                                                            </div>
                                                                                            <div class="justify-middle" [ngStyle]="{'background-color': dataLabelsBarFontPosition == 'center' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsBarFontPosition('center')">
                                                                                                <i class="fa fa-align-justify"></i>
                                                                                            </div>
                                                                                            <div class="justify-top" [ngStyle]="{'background-color': dataLabelsBarFontPosition == 'top' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsBarFontPosition('top')">
                                                                                                <i class="fa fa-align-justify"></i>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                   
                                                                                  </div>
                                                                              </ul>
                                                                          </div>
                                                                  </div>                                                 
                                                                </div>
                                                              </div>
                                                            </div>
                                                            <div class="sub-menu-item  p-2 mb-0" *ngIf="barLine && isEChatrts">
                                                                <div class="row">
                                                                  <div class="">
                                                                    <div class="font-color-card">
                                                                        <p class="mb-0">Line Alignments</p>
                                                                        <div class="dropup" ngbDropdown>
                                                                            <i class="fe fe-chevron-down fs-18 text-body-secondary dropdown-toggle" ngbDropdownToggle data-bs-toggle="dropdown"></i>
                                                                            <ul class="dropdown-menu custom-dropdown" ngbDropdownMenu>
                                                                                <div class="dropup" ngbDropdown >
                                                                                  
                                                                                  <div class=" p-1 mt-2 mb-2" *ngIf="barLine">
                                                                                      <div class="form-group mb-0 text-center" (click)="setDataLabelsLineFontPosition('top')">
                                                                                          <button class="btn btn-blue-light Automatic-btn">Automatic</button>
                                                                                      </div>
                                                                                      <div class="form-group mb-0 alignment-sides">
                                                                                          <div class="justify-bottom" [ngStyle]="{'background-color': dataLabelsLineFontPosition == 'bottom' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsLineFontPosition('bottom')">
                                                                                              <i class="fa fa-align-justify"></i>
                                                                                          </div>
                                                                                          <div class="justify-middle" [ngStyle]="{'background-color': dataLabelsLineFontPosition == 'center' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsLineFontPosition('center')">
                                                                                              <i class="fa fa-align-justify"></i>
                                                                                          </div>
                                                                                          <div class="justify-top" [ngStyle]="{'background-color': dataLabelsLineFontPosition == 'top' ? 'var(--primary-color)': '#fafcfc'}" (click)="setDataLabelsLineFontPosition('top')">
                                                                                              <i class="fa fa-align-justify"></i>
                                                                                          </div>
                                                                                      </div>
                                                                                  </div>
                                                                                 
                                                                                </div>
                                                                            </ul>
                                                                        </div>
                                                                </div>                                                 
                                                                </div>
                                                              </div>
                                                            </div>
                                                       
                                                              @if(kpi){
                                                                <div class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-2">
                                                                  <label for="col-md-4 form-label px-1 fs-14">Decimal places and Round:</label>
                                                                  <input type="number" class="form-control fs-14" id="decimal-places" style="width: auto;"[(ngModel)]="KPIDecimalPlaces" (change)="formatKPINumber()" min="0">
                                                                  </div>
                                                                  <div class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-2">
                                                                  <label for="display-units">Display Units:</label>
                                                                  <select id="display-units" class="form-select select2 fs-14" style="width: auto;" [(ngModel)]="KPIDisplayUnits" (change)="formatKPINumber()">
                                                                    <option value="none">None</option>
                                                                    <option value="K">Thousands (K)</option>
                                                                    <option value="M">Millions (M)</option>
                                                                    <option value="B">Billions (B)</option>
                                                                    <option value="G">Billions (G)</option>
                                                                    <option value="%">Percentage (%)</option>
                                                                  </select>
                                                                  </div>
                                                                  <div class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-2">
                                                                  <label for="prefix">Prefix:</label>
                                                                  <input type="text" class="form-control fs-14" id="prefix" style="width: auto;" [(ngModel)]="KPIPrefix" (input)="formatKPINumber()">
                                                                  </div>
                                                                  <div class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-2">
                                                                  <label for="suffix">Suffix:</label>
                                                                  <input type="text" class="form-control fs-14" id="suffix" style="width: auto;" [(ngModel)]="KPISuffix" (input)="formatKPINumber()">
                                                                </div>
                                                              }
                                                                <div *ngIf="!(kpi || guage)" class="d-flex align-items-center justify-content-between flex-wrap gap-2">
                                                                    <label>Numbers</label>
                                                                    <div class="btn-group" ngbDropdown>
                                                                        <button type="button" ngbDropdownToggle class="btn btn-primary-light dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" (click)="numberPopupTrigger()">
                                                                            123.456 &nbsp;<i class="fa fa-chevron-down"></i>
                                                                        </button>
                                                                        <!-- <ul class="dropdown-menu" ngbDropdownMenu>
                                                                            <li><a ngbDropdownItem class="dropdown-item" ngbDropdownItem (click)="numberPopupTrigger()">Number(custom)</a></li>
                                                                        </ul> -->
                                                                    </div>
                                                                 
                                                                </div>
                                                              
                                                                @if(numberPopup){
                                                                  <div class="number-formatting number-popup popup-content">
                                                                      <label for="decimal-places">Decimal places:</label>
                                                                      <input type="number" id="decimal-places" [(ngModel)]="decimalPlaces" min="0">
                                                                      
                                                                      <label for="display-units">Display Units:</label>
                                                                      <select id="display-units" [(ngModel)]="displayUnits">
                                                                        <option value="none">None</option>
                                                                        <option value="K">Thousands (K)</option>
                                                                        <option value="M">Millions (M)</option>
                                                                        <option value="B">Billions (B)</option>
                                                                        <option value="G">Billions (G)</option>
                                                                      </select>
                                                                      
                                                                      <label for="prefix">Prefix:</label>
                                                                      <input type="text" id="prefix" [(ngModel)]="prefix">
                                                                      
                                                                      <label for="suffix">Suffix:</label>
                                                                      <input type="text" id="suffix" [(ngModel)]="suffix">
                                                                      
                                                                      <div class="buttons">
                                                                          <button class="btn btn-danger" (click)="numberPopupTrigger()">Close</button>
                                                                          <!-- <button class="btn btn-primary" (click)="updateTableFormat();">Update</button> -->
                                                                      </div>
                                                                    </div>
                                                                }
                                                            </ng-template>
                                                          </div>
                                                        </div>
                                                  </div>

                                                    <div *ngIf="(table && chartId || pivotTable) && (draggedColumns?.length !== 0 || draggedRows?.length !==0)" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                        <div class=""> 
                                                            <label class="mb-0">Banding </label>
                                                        </div>
                                                        <div *ngIf="bandingSwitch" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('banding')">
                                                            <span></span>
                                                        </div>
                                                        <div *ngIf="!bandingSwitch" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('banding')">
                                                            <span></span>
                                                        </div>
                                                        <ngx-colors *ngIf="bandingSwitch && pivotTable"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="bandingEvenColor"
                                                                    (ngModelChange)="applyDynamicStylesToPivot()"
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>
                                                                     <ngx-colors *ngIf="bandingSwitch && pivotTable"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="bandingOddColor"
                                                                    (ngModelChange)="applyDynamicStylesToPivot()"
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>

                                                                      <ngx-colors *ngIf="bandingSwitch && table"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="color1"
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>
                                                                     <ngx-colors *ngIf="bandingSwitch && table"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="color2"
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>
                                                    </div>
                                                    <div *ngIf="(table && chartId) && (draggedColumns?.length !== 0 || draggedRows?.length !==0)" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                         <div class=""> 
                                                            <label class="mb-0">Search </label>
                                                        </div>
                                                        <div *ngIf="toggleTableSearch" class="toggle toggle-sm on mb-0" (click)="toggleTableSearch=!toggleTableSearch;toggleTableSearchBarOff()">
                                                            <span></span>
                                                        </div>
                                                        <div *ngIf="!toggleTableSearch" class="toggle toggle-sm off mb-0" (click)="toggleTableSearch=!toggleTableSearch">
                                                            <span></span>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="(pivotTable && chartId) && (draggedColumns?.length !== 0 || draggedRows?.length !==0)" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                        <div class=""> 
                                                            <label class="mb-0">Column Totals </label>
                                                        </div>
                                                        <div *ngIf="pivotColumnTotals" class="toggle toggle-sm on mb-0" (click)="renderPivotTable(false);pivotColumnTotals = false" >
                                                            <span></span>
                                                        </div>
                                                        <div *ngIf="!pivotColumnTotals" class="toggle toggle-sm off mb-0" (click)="renderPivotTable(false);pivotColumnTotals = true" >
                                                            <span></span>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="(pivotTable && chartId) && (draggedColumns?.length !== 0 || draggedRows?.length !==0)" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                        <div class=""> 
                                                            <label class="mb-0">Row Totals </label>
                                                        </div>
                                                        <div *ngIf="pivotRowTotals" class="toggle toggle-sm on mb-0" (click)="renderPivotTable(false);pivotRowTotals = false" >
                                                            <span></span>
                                                        </div>
                                                        <div *ngIf="!pivotRowTotals" class="toggle toggle-sm off mb-0" (click)="renderPivotTable(false);pivotRowTotals = true" >
                                                            <span></span>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="(table && chartId) && (draggedColumns?.length !== 0 || draggedRows?.length !==0)" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                             <div class=""> 
                                                            <label class="mb-0">Table Pagination </label>
                                                        </div>
                                                        <div *ngIf="toggleTablePagination" class="toggle toggle-sm on mb-0" (click)="toggleTablePagination=!toggleTablePagination">
                                                            <span></span>
                                                        </div>
                                                        <div *ngIf="!toggleTablePagination" class="toggle toggle-sm off mb-0" (click)="toggleTablePagination=!toggleTablePagination">
                                                            <span></span>
                                                        </div>
                                                        <div *ngIf="toggleTablePagination" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2">
                                                            <label class="mb-0">Page Length</label>
                                                            <select  [(ngModel)]="itemsPerPage" (ngModelChange)="tableDisplayPageLength()" class="form-control cursor w-40 p-1">
                                                                <option  [ngValue]="''" disabled> select page length</option>
                                                                  <option  [ngValue]="10"> 10</option>
                                                                  <option  value="50"> 50</option>
                                                                  <option  value="100"> 100</option>
                                                                  <option  value="500"> 500</option>
                                                                  <option  value="1000"> 1000</option>
                                                            </select>
                                                         </div>
                                                         <div *ngIf="!toggleTablePagination" class="w-100 text-muted small mt-1">
                                                            <i class="bi bi-info-circle-fill me-1"></i>
                                                            Pagination is turned off. The data shown in the sheet will reflect only the currently visible set, not the entire dataset.
                                                        </div>
                                                    </div>
                                                    
                                                    <div *ngIf="!isApexCharts && isEChatrts && !(pie || donut || funnel || calendar || radar || kpi || table || pivotTable)" class="d-flex align-items-center justify-content-between  mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                        <div class=""> 
                                                            <label class="mb-0">Zoom </label>
                                                        </div>
                                                        <div *ngIf="isZoom" class="toggle toggle-sm on mb-0" (click)="enableZoom()">
                                                            <span></span>
                                                        </div>
                                                        <div *ngIf="!isZoom" class="toggle toggle-sm off mb-0" (click)="enableZoom()">
                                                            <span></span>
                                                        </div>
                                                    </div>
                                                  
                                                    <div *ngIf="!((table && chartId) || (pie && chartId) || donut || kpi || funnel || guage || calendar || radar || pivotTable)" ngbAccordionItem  class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                          <button
                                                            ngbAccordionButton
                                                            class="accordion-button p-2 fw-500 border-0 rounded-2"
                                                            type="button"
                                                            data-bs-toggle="collapse"
                                                            data-bs-target="#collapse"
                                                            aria-expanded="true"
                                                            aria-controls="collapse"
                                                            >
                                                            X-Axis
                                                          </button>
                                                          
                                                        </h6>
                                                        <div
                                                          ngbAccordionCollapse
                                                          id="collapse"
                                                          class="accordion-collapse collapse customize-accordion-h" 
                                                          aria-labelledby="heading"
                                                          data-bs-parent="#accordionExample"
                                                           >
                                                          <div class="accordion-body p-2  database-dropdown" ngbAccordionBody>
                                                            <!-- <button type="button" data-bs-dismiss="alert" aria-label="Close" class="btn-close mt-0">
                                                                <i class="bi bi-arrows-fullscreen drilldown-icon"></i>
                                                            </button> -->
                                                            <ng-template>
                                                                <div class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >X-label </p>
                                                                    </div>
                                                                    <div *ngIf="xLabelSwitch" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('xlabel')">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!xLabelSwitch" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('xlabel')">
                                                                        <span></span>
                                                                    </div>
                                                                </div>

                                                                <div *ngIf="!heatMap" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >Grid Line </p>
                                                                    </div>
                                                                    <div *ngIf="xGridSwitch" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('xgrid')">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!xGridSwitch" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('xgrid')">
                                                                        <span></span>
                                                                    </div>
                                                                </div>
                                                           
                                                            </ng-template>
                                                          </div>
                                                        </div>
                                                    </div>

                                                    <div *ngIf="!((table && chartId) || (pie && chartId) || donut || kpi || funnel || guage || calendar || radar || pivotTable)" ngbAccordionItem  class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                          <button
                                                            ngbAccordionButton
                                                            class="accordion-button p-2 fw-500 border-0 rounded-2"
                                                            type="button"
                                                            data-bs-toggle="collapse"
                                                            data-bs-target="#collapse" 
                                                            aria-expanded="true"
                                                            aria-controls="collapse"
                                                            >
                                                            Y-Axis
                                                          </button>
                                                          
                                                        </h6>
                                                        <div
                                                          ngbAccordionCollapse
                                                          id="collapse"
                                                          class="accordion-collapse collapse customize-accordion-h" 
                                                          aria-labelledby="heading"
                                                          data-bs-parent="#accordionExample"
                                                           >
                                                          <div class="accordion-body p-2  database-dropdown" ngbAccordionBody >
                                                            <!-- <button type="button" data-bs-dismiss="alert" aria-label="Close" class="btn-close mt-0">
                                                                <i class="bi bi-arrows-fullscreen drilldown-icon"></i>
                                                            </button> -->
                                                            <ng-template>
                                                                <div class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >Y-label </p>
                                                                    </div>
                                                                    <div *ngIf="yLabelSwitch" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('ylabel')">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!yLabelSwitch" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('ylabel')">
                                                                        <span></span>
                                                                    </div>
                                                                </div>
 
                                                                <div *ngIf="!heatMap" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >Grid Line </p>
                                                                    </div>
                                                                    <div *ngIf="yGridSwitch" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('ygrid')">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!yGridSwitch" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('ygrid')">
                                                                        <span></span>
                                                                    </div>
                                                                </div>
     
                                                            </ng-template>
                                                          </div>
                                                        </div>
                                                    </div>

                                                    <div *ngIf="( ((kpi || guage) && draggedRows?.length === 1) || !(calendar || map || table))" ngbAccordionItem  class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                          <button
                                                            ngbAccordionButton
                                                            class="accordion-button p-2 fw-500 border-0 rounded-2"
                                                            type="button"
                                                            data-bs-toggle="collapse"
                                                            data-bs-target="#collapse"
                                                            aria-expanded="true"
                                                            aria-controls="collapse"
                                                            >
                                                            Color Palettes
                                                          </button>
                                                          
                                                        </h6>
                                                        <div
                                                          ngbAccordionCollapse
                                                          id="collapse"
                                                          class="accordion-collapse collapse customize-accordion-h" 
                                                          aria-labelledby="heading"
                                                          data-bs-parent="#accordionExample"
                                                           >
                                                          <div class="accordion-body p-2  database-dropdown" ngbAccordionBody>
                                                            <ng-template>
                                                                <div *ngIf="!((table && chartId) || kpi || calendar)" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p *ngIf="!pivotTable">Background</p>
                                                                        <p *ngIf="pivotTable">Header Background</p>
                                                                    </div>
                                                                    <div *ngIf="backgroundColorSwitch" class="toggle toggle-sm on mb-0" (click)="backgroundColorSwitch = !backgroundColorSwitch; resetBackgroundColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!backgroundColorSwitch" class="toggle toggle-sm off mb-0" (click)="backgroundColorSwitch = !backgroundColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="backgroundColorSwitch"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="backgroundColor" (change)="pivotTable ? applyPIvotHeaderBg() : null"
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>
                                                                </div>

                                                                <div *ngIf="!((table && chartId) || (pie && chartId)||donut||kpi||barLine||sidebyside||stocked||horizentalStocked||grouped||multiLine||heatMap || calendar) && ((!isDistributed && (bar || funnel)) || area || line || (radar && !isRadarDistribution))" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p>Chart</p>
                                                                    </div>
                                                                    <div *ngIf="chartColorSwitch" class="toggle toggle-sm on mb-0" (click)="chartColorSwitch = !chartColorSwitch; resetChartColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!chartColorSwitch" class="toggle toggle-sm off mb-0" (click)="chartColorSwitch = !chartColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="chartColorSwitch"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="color" 
                                                                    (ngModelChange)="marksColor2($event)"
                                                                    [format]="'hex'"></ngx-colors>
                                                                </div>
                                                                <div *ngIf="radar && chartColorSwitch" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p>Color Distribution</p>
                                                                    </div>
                                                                    <div *ngIf="isRadarDistribution" class="toggle toggle-sm on mb-0" (click)="isRadarDistribution = !isRadarDistribution;">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!isRadarDistribution" class="toggle toggle-sm off mb-0" (click)="isRadarDistribution = !isRadarDistribution;">
                                                                        <span></span>
                                                                    </div>
                                                                 
                                                                </div>
                                                                <!-- <div 
                                                                class="dropdown" 
                                                                *ngIf="pie || donut || sidebyside || stocked || horizentalStocked || grouped || multiLine || heatMap || calendar || (funnel && isDistributed)"> -->
                                                                <!-- Dropdown Button -->
                                                                <!-- <button class="dropdown-button" (click)="toggleDropdownColorScheme()">
                                                                  <div class="selected-colors" *ngIf="selectedColorScheme.length > 0">
                                                                    <div
                                                                      *ngFor="let color of selectedColorScheme.slice(0, 9)"
                                                                      class="color-box"
                                                                      [style.background]="color"
                                                                    ></div>
                                                                  </div>
                                                                  <span *ngIf="selectedColorScheme.length === 0">Select Color Scheme</span>
                                                                  <span class="arrow-down"></span>
                                                                </button> -->
                                                              
                                                                <!-- Dropdown Content -->
                                                                <!-- <div class="dropdown-content" [class.show]="isColorSchemeDropdownOpen">
                                                                  <div
                                                                    *ngFor="let scheme of colorSchemes"
                                                                    class="dropdown-item"
                                                                    (click)="selectColorScheme(scheme)">
                                                                    <div class="color-row">
                                                                      <div
                                                                        *ngFor="let color of scheme"
                                                                        class="color-box"
                                                                        [style.background]="color">
                                                                      </div>
                                                                    </div>
                                                                  </div>
                                                                </div>
                                                              </div> -->

                                                                <div *ngIf="barLine" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >bar</p>
                                                                    </div>
                                                                    <div *ngIf="barColorSwitch" class="toggle toggle-sm on mb-0" (click)="barColorSwitch = !barColorSwitch; resetChartColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!barColorSwitch" class="toggle toggle-sm off mb-0" (click)="barColorSwitch = !barColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="barColorSwitch"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="barColor" 
                                                                    (ngModelChange)="marksColor2($event)" 
                                                                    [format]="'hex'">
                                                                    </ngx-colors>
                                                                </div>
                                                                <div *ngIf="barLine" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >line</p>
                                                                    </div>
                                                                    <div *ngIf="lineColorSwitch" class="toggle toggle-sm on mb-0" (click)="lineColorSwitch = !lineColorSwitch; resetChartColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!lineColorSwitch" class="toggle toggle-sm off mb-0" (click)="lineColorSwitch = !lineColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="lineColorSwitch"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="lineColor" 
                                                                    (ngModelChange)="marksColor2($event)" 
                                                                    [format]="'hex'">
                                                                    </ngx-colors>
                                                                </div>
                                                                <div *ngIf="isApexCharts && (xGridSwitch || yGridSwitch) && !((table && chartId) || (pie && chartId) || donut || kpi || funnel || heatMap || guage)" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >Grid Line</p>
                                                                    </div>
                                                                    <div *ngIf="gridLineColorSwitch" class="toggle toggle-sm on mb-0" (click)="gridLineColorSwitch = !gridLineColorSwitch; resetGridColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!gridLineColorSwitch" class="toggle toggle-sm off mb-0" (click)="gridLineColorSwitch = !gridLineColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="gridLineColorSwitch"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="GridColor" 
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>
                                                                </div>

                                                                
                                                                <div *ngIf="!isApexCharts && xGridSwitch && !(pie || donut || calendar || kpi)" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >X-Grid Line Color </p>
                                                                    </div>
                                                                    <div *ngIf="xGridLineColorSwitch" class="toggle toggle-sm on mb-0" (click)="xGridLineColorSwitch = !xGridLineColorSwitch; resetEchartXGridColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!xGridLineColorSwitch" class="toggle toggle-sm off mb-0" (click)="xGridLineColorSwitch = !xGridLineColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="xGridLineColorSwitch"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="xGridColor"  (ngModelChange)="marksColor($event,1)"
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>
                                                                </div>
                                                               
                                                                <div *ngIf="!isApexCharts && yGridSwitch && !(pie || donut || calendar || kpi || radar)" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <div class=""> 
                                                                        <p >Y-Grid Line Color </p>
                                                                    </div>
                                                                    <div *ngIf="yGridLineColorSwitch" class="toggle toggle-sm on mb-0" (click)="yGridLineColorSwitch = !yGridLineColorSwitch; resetEchartYGridColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!yGridLineColorSwitch" class="toggle toggle-sm off mb-0" (click)="yGridLineColorSwitch = !yGridLineColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="yGridLineColorSwitch"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="yGridColor"  (ngModelChange)="marksColor($event,3)"
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>
                                                                </div>
                                                                
                                                                <div *ngIf="kpi" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <label for="color">Color</label>
                                                                    <div *ngIf="kpiColorSwitch" class="toggle toggle-sm on mb-0" (click)="kpiColorSwitch = !kpiColorSwitch; resetKpiColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!kpiColorSwitch" class="toggle toggle-sm off mb-0" (click)="kpiColorSwitch = !kpiColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="kpiColorSwitch"
                                                                    ngx-colors-trigger 
                                                                    [(ngModel)]="kpiColor"
                                                                    [format] = "'hex'"
                                                                     ></ngx-colors>
                                                                </div>
                                                                <div *ngIf="funnel || bar" class="d-flex align-items-center justify-content-between mb-1 flex-wrap gap-2">
                                                                    <label>Distribution</label>
                                                                    <div *ngIf="isDistributed" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('distributed')">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!isDistributed" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('distributed')">
                                                                        <span></span>
                                                                    </div>
                                                                </div>
                                                                <!-- <div *ngIf="!isDistributed && funnel" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-3">
                                                                    <label>color</label>
                                                                    <div *ngIf="funnelColorSwitch" class="toggle toggle-sm on mb-0" (click)="funnelColorSwitch = !funnelColorSwitch; resetChartColor()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!funnelColorSwitch" class="toggle toggle-sm off mb-0" (click)="funnelColorSwitch = !funnelColorSwitch;">
                                                                        <span></span>
                                                                    </div>
                                                                    <ngx-colors *ngIf="funnelColorSwitch" [(ngModel)]="color" ngx-colors-trigger [format]="'hex'">
                                                                    </ngx-colors>
                                                                </div> -->
                                                                <div *ngIf="pie || donut || sidebyside || stocked || horizentalStocked || grouped || multiLine || heatMap || ((funnel || bar) && isDistributed || (radar && isRadarDistribution ))" class="p-2">
                                                                    <div class="d-flex justify-content-between p-1 border rounded-3">
                                                                        <div class="colors-card">
                                                                            <ul class="d-flex flex-wrap">
                                                                                <li
                                                                                *ngFor="let color of selectedColorScheme"
                                                                                [style.background]="color"
                                                                                class="color-box cursor-pointer"></li>
                                                                            </ul>
                                                                        </div>
                                                                        <div class="down-arrow-icon">
                                                                            <div class=" dropdown" ngbDropdown>
                                                                                <a ngbDropdownToggle data-bs-toggle="dropdown" role="button"
                                                                                    aria-haspopup="true" aria-expanded="false" class="dropdown-toggle">
                                                                                    <button class="btn btn-primary" style=" padding: 0px 4px; font-size: 12px;">
                                                                                        <i class="fa fa-angle-down"></i>
                                                                                    </button>
                                                                                </a>
                                                                                <div class="dropdown-menu p-1" ngbDropdownMenu>
                                                                                    <div class="child-color-height pt-1">
                                                                                        <ul class="justify-content-between align-items-center px-1 ">
                                                                                            <li *ngFor="let colorScheme of keysOfColorSchemes; let keyIndex = index" ngbDropdownItem class="dropdown-item p-0">
                                                                                                <div class="d-flex m-0">
                                                                                                    <div class="cursor-pointer rgb-text me-1 p-0" (click)="selectedColorScheme = colorScheme?.colorPalette ?? []" ngbTooltip="{{colorScheme?.key}}"> {{colorScheme?.key | slice:0:10}} </div>
                                                                                                    <div class="d-flex p-0 CustomwWidthScroll" (click)="selectedColorScheme = colorScheme?.colorPalette ?? []">
                                                                                                        <div class="color-box cursor-pointer" *ngFor="let color of colorScheme?.colorPalette"
                                                                                                            [style.background]="color">
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <button *ngIf="keysOfUsersColors.length > 0 && keysOfUsersColors.includes(colorScheme?.key)" class="cursor-pointer border rounded-3 bg-light"
                                                                                                             (click)="removeColorScheme(colorScheme?.key ?? '',keyIndex)">
                                                                                                        <i class="fa fa-remove"></i>
                                                                                                    </button>
                                                                                                </div>
                                                                                            </li>
                                                                                        </ul>
                                                                                    </div>
                                                                
                                                                                    <div class=" dropdown border-top" ngbDropdown #colorPickerDropdown="ngbDropdown">
                                                                                        <div class="d-flex flex-row-reverse p-1">
                                                                                            <a href="javascript:void(0);" ngbDropdownToggle data-bs-toggle="dropdown" role="button"
                                                                                                aria-haspopup="true" aria-expanded="false" class="dropdown-toggle">
                                                                                                <button class="btn btn-primary">
                                                                                                    <i class="fa fa-plus"></i>Add
                                                                                                </button>
                                                                                            </a>
                                                                                        </div>
                                                                                        <div class="dropdown-menu add-color-popup ColorPickerAlign" ngbDropdownMenu>
                                                                                            <div class="p-2">
                                                                                                <div class="p-2">
                                                                                                    <p class="border-bottom">Color Picker</p>
                                                                                                </div>
                                                                                                <div class="rainbow-text d-flex align-items-center p-2 bg-light">
                                                                                                    <p class="mb-0 me-2">Name:</p>
                                                                                                    <input type="text" id="input-placeholder" placeholder="Color Name"
                                                                                                    class="form-control border me-2" [(ngModel)]="colorSchemeName" required>
                                                                                                </div>
                                                                                                <div class="py-2">
                                                                                                    <div class="d-flex">
                                                                                                        <div *ngFor="let color of newColorScheme; let i = index" class="border color-box cursor-pointer" 
                                                                                                        [ngClass]="{ 'border-primary': i === selectedBox }" [style.background]="color" (click)="selectedBox = i;colorInput.click()"></div>
                                                                                                        <div class="cursor-pointer border rounded-3 bg-light"  [class.disabled]="newColorScheme.length >= 10" (click)="addNewBox();colorInput.click()"> 
                                                                                                            <i class="fa fa-plus px-1"></i> 
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <input type="color" #colorInput id="body" name="body" class="w-100" value="#FFFFFF" (input)="newColorScheme[selectedBox] = colorInput.value"/>
                                                                                                </div>
                                                                                                <!-- <div class="py-1">
                                                                                                    <input type="color" #colorInput  id="body" name="body" class="w-100" [(ngModel)]="selectedColor" (ngModelChange)="setColorToBox()"/>
                                                                                                </div> -->
                                                                                                <div class="d-flex justify-content-end">
                                                                                                    <button [disabled]="(newColorScheme.length < 2 || newColorScheme.length > 10) || !colorSchemeName.trim()" class="btn btn-primary me-1" (click)="saveColorScheme(colorPickerDropdown)">Apply</button>
                                                                                                    <button class="btn btn-danger" (click)="closeColorPicker(colorPickerDropdown)">Close</button>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </ng-template>
                                                          </div>
                                                        </div>
                                                    </div>

                                                    <div *ngIf="(draggedColumns?.length !== 0 || draggedRows?.length !==0) && !(kpi || guage || calendar ||pivotTable || (!isApexCharts && funnel))" [class.disabled]="!isTopFilter" ngbAccordionItem  class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                          <button
                                                            ngbAccordionButton
                                                            class="accordion-button p-2 fw-500 border-0 rounded-2"
                                                            type="button"
                                                            data-bs-toggle="collapse"
                                                            data-bs-target="#collapse"
                                                            aria-expanded="true"
                                                            aria-controls="collapse"
                                                            >
                                                            Sort
                                                          </button>
                                                          
                                                        </h6>
                                                        <div
                                                          ngbAccordionCollapse
                                                          id="collapse"
                                                          class="accordion-collapse collapse customize-accordion-h" 
                                                          aria-labelledby="heading"
                                                          data-bs-parent="#accordionExample"
                                                           >
                                                          <div class="accordion-body p-2  database-dropdown" ngbAccordionBody >
                                                            <ng-template>
                                                                <div class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2">
                                                                    <label class="mb-0" for="columnName">Column</label>
                                                                    <select id="columnName" [(ngModel)]="sortColumn" style="width: 50%;" (change)="sortType = 0; changeSelectedColumn();">
                                                                        <option value="select" selected disabled>select</option>
                                                                        <option *ngFor="let column of columnNamesForSort; let i = index" [ngValue]="column">
                                                                            @if(column.alias){
                                                                            {{ column.alias }}
                                                                            } @else if(column.field_name){
                                                                            {{ column.field_name }}
                                                                            }
                                                                            @else if(column.type){
                                                                            {{ column.type }} ({{column.column}})
                                                                            }@else{
                                                                            {{ column.column }}
                                                                            }</option>
                                                                    </select>
                                                                </div>
                                                                <div *ngIf="sortColumn != 'select'" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-3">
                                                                    <label for="sorting">Sort by</label>
                                                                    <select id="sorting" [(ngModel)]="sortType" style="width: 50%;" (change)="sortColumns()">
                                                                        <option value="0" selected disabled>select</option>
                                                                        <option value="none">Default</option>
                                                                        <option value="asc">Ascending</option>
                                                                        <option value="desc">Descending</option>
                                                                    </select>
                                                                </div>
                                                            </ng-template>
                                                          </div>
                                                        </div>
                                                    </div>

                                                    <div *ngIf="((pie && chartId) || donut || radar)">
                                                        <div class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                            <div class=""> 
                                                                <label class="mb-0">Legends </label>
                                                            </div>
                                                            <div *ngIf="legendSwitch" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('legend')">
                                                                <span></span>
                                                            </div>
                                                            <div *ngIf="!legendSwitch" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('legend')">
                                                                <span></span>
                                                            </div>
                                                        </div>
                                                        <div *ngIf="legendSwitch" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 px-2 py-1 border rounded-2">
                                                            <div class=""><label class="mb-0">Allignment</label></div>
                                                            <div class="btn-group " ngbDropdown>
                                                                <button type="button" ngbDropdownToggle class="btn btn-primary-light dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                                    {{legendsAllignment}}
                                                                </button>
                                                                <ul class="dropdown-menu" ngbDropdownMenu>
                                                                    <li><a ngbDropdownItem class="dropdown-item" ngbDropdownItem (click)="changeLegendsAllignment('top')">Top</a></li>
                                                                    <li><a ngbDropdownItem class="dropdown-item" ngbDropdownItem (click)="changeLegendsAllignment('bottom')">Bottom</a></li>
                                                                    <li><a  ngbDropdownItem class="dropdown-item" ngbDropdownItem (click)="changeLegendsAllignment('left')">Left</a></li>
                                                                    <li><a ngbDropdownItem class="dropdown-item" ngbDropdownItem (click)="changeLegendsAllignment('right')">Right</a></li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                        <div class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                            <div class=""> 
                                                                <label class="mb-0" >Data Labels </label>
                                                            </div>
                                                            <div *ngIf="dataLabels" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('dataLabels')">
                                                                <span></span>
                                                            </div>
                                                            <div *ngIf="!dataLabels" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('dataLabels')">
                                                                <span></span>
                                                            </div>
                                                        </div>
                                                        <div *ngIf="donut && !isEChatrts" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                            <div class="" > 
                                                                <label class="mb-0" >Label </label>
                                                            </div>
                                                            <div *ngIf="label" class="toggle toggle-sm on mb-0" (click)="toggleSwitch('label')">
                                                                <span></span>
                                                            </div>
                                                            <div *ngIf="!label" class="toggle toggle-sm off mb-0" (click)="toggleSwitch('label')">
                                                                <span></span>
                                                            </div>
                                                        </div>
                                                        <div *ngIf="donut" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                            <label class="mb-0">Donut Size</label>
                                                            <input type="number" [(ngModel)]="donutSize" min="1" max="100" step="5">
                                                        </div>
                                                        <div *ngIf="donut && label && !isEChatrts" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-2 border rounded-2">
                                                            <label class="mb-0" for="decimalInput">Decimal Places: </label>
                                                            <input  type="number" id="decimalInput" [(ngModel)]="donutDecimalPlaces" min="0" class="w-30">
                                                        </div>
                                                    </div>

                                                    
                                                    <div *ngIf="kpi" class="d-flex align-items-center justify-content-between mb-2 flex-wrap gap-2 p-2 border rounded-2">
                                                        <label class="mb-0" for="font-size" step="1" >Font Size</label>
                                                        <input type="number" [(ngModel)]="kpiFontSize" style="width: 30%;" min="0">
                                                        <!-- <ngx-slider [(ngModel)]="kpiFontSize" [options]="sliderOptions"></ngx-slider> -->
                                                    </div>
                                                   
                                                    <div *ngIf="((pie && chartId) || donut || bar || map)  && draggedColumns && draggedColumns?.length == 1 && (dateList.includes(draggedColumns[0]['data_type']) || isLocationFeild)" ngbAccordionItem  class="accordion-item mb-2 border rounded-2">
                                                        <h6 ngbAccordionHeader class="accordion-header" id="heading">
                                                          <button
                                                            ngbAccordionButton
                                                            class="accordion-button p-2 fw-500 border-0"
                                                            type="button"
                                                            data-bs-toggle="collapse"
                                                            data-bs-target="#collapse"
                                                            aria-expanded="true"
                                                            aria-controls="collapse"
                                                            >
                                                            Drilldown
                                                          </button>
                                                          
                                                        </h6>
                                                        <div
                                                          ngbAccordionCollapse
                                                          id="collapse"
                                                          class="accordion-collapse collapse customize-accordion-h" 
                                                          aria-labelledby="heading"
                                                          data-bs-parent="#accordionExample"
                                                           >
                                                          <div class="accordion-body p-0  database-dropdown" ngbAccordionBody >
                                                            <!-- <button type="button" data-bs-dismiss="alert" aria-label="Close" class="btn-close mt-0">
                                                                <i class="bi bi-arrows-fullscreen drilldown-icon"></i>
                                                            </button> -->
                                                            <ng-template>
                                                                <div *ngIf="dateList.includes(draggedColumns[0]['data_type'])" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-3">
                                                                    <div class=""> 
                                                                        <p >Drill Field </p>
                                                                    </div>
                                                                    <div *ngIf="dateDrillDownSwitch" class="toggle toggle-sm on mb-0" (click)="toggleDateSwitch()">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!dateDrillDownSwitch" class="toggle toggle-sm off mb-0" (click)="toggleDateSwitch()">
                                                                        <span></span>
                                                                    </div>
                                                                </div>
                                                                <div *ngIf="isLocationFeild" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-3">
                                                                    <div class=""> 
                                                                        <p >Drill Field </p>
                                                                    </div>
                                                                    <div *ngIf="locationDrillDownSwitch" class="toggle toggle-sm on mb-0" (click)="toggleLocationSwitch(true)">
                                                                        <span></span>
                                                                    </div>
                                                                    <div *ngIf="!locationDrillDownSwitch" class="toggle toggle-sm off mb-0" (click)="toggleLocationSwitch(true)">
                                                                        <span></span>
                                                                    </div>
                                                                </div>
                                                                                                                
                                                            </ng-template>
                                                          </div>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="guage" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-2">
                                                        <div>
                                                            <label for="minValue">Enter Minimum Value:</label>
                                                            <input type="number" class="form-control fs-14" [(ngModel)]="minValueGuage" id="minValue"  />
                                                          
                                                            <label for="maxValue">Enter Maximum Value:</label>
                                                            <input type="number" class="form-control fs-14" [(ngModel)]="maxValueGuage" id="maxValue"  />
                                                        </div>
                                                    </div>
                                                    <!-- <div *ngIf="bar || funnel && isApexCharts" class="d-flex align-items-center justify-content-between mb-0 flex-wrap gap-2 p-3">
                                                        <label for="sorting">Sort by: </label>
                                                        <select id="sorting" [(ngModel)]="sortType">
                                                            <option value="0" selected disabled>select</option>
                                                            <option value="none">None</option>
                                                            <option value="ascending">Ascending</option>
                                                            <option value="descending">Descending</option>
                                                        </select>
                                                    </div> -->
                                                </div>
                                            </div>
                                        </ng-template>
                                </li>

                                <li [ngbNavItem]="3">
                                    <a ngbNavLink class="p-1" (click)="getChartSuggestions()" >
                                        <button class="copilot-button" matTooltip="Genie AIQ is an AI-powered query engine designed to generate insights from MetaData." matTooltipPosition="above">
                                            <img src="./assets/images/copilot.gif" alt="Copilot" class="copilot-icon border rounded-5" />
                                        </button>
                                    </a>
                                    <ng-template ngbNavContent>
                                        <div class="tab-pane" id="linktabs">
                                            <div class="copilot-container p-1">
                                                <h6 class='rounded-2 genie-aiq-text'>Genie AIQ</h6>
                                                <div *ngIf="chartSuggestions && chartSuggestions.length > 0" class="chart-suggestions mt-3">
                                                    <button *ngFor="let chart of chartSuggestions" type="button"
                                                        class="btn ripple btn-primary inp-btn d-flex align-items-center p1-text-start"
                                                        (click)="fetchChartData(chart)"
                                                        matTooltip="{{ chart.description }}" matTooltipPosition="above">
                                                        <span class="avatar avatar rounded-circle-copilot mr-2 me-2">
                                                            <img *ngIf="chart.chart_id === 1"
                                                                src="./assets/images/Tiled view sheet icons/table-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 6"
                                                                src="./assets/images/Tiled view sheet icons/bar-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 17"
                                                                src="./assets/images/Tiled view sheet icons/area-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 13"
                                                                src="./assets/images/Tiled view sheet icons/line-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 24"
                                                                src="./assets/images/Tiled view sheet icons/pie-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 7"
                                                                src="./assets/images/Tiled view sheet icons/sideBar-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 5"
                                                                src="./assets/images/Tiled view sheet icons/Stacked-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 4"
                                                                src="./assets/images/Tiled view sheet icons/BarLine-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 2"
                                                                src="./assets/images/Tiled view sheet icons/Hstacked-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 3"
                                                                src="./assets/images/Tiled view sheet icons/HGrouped-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 8"
                                                                src="./assets/images/Tiled view sheet icons/multiline-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                            <img *ngIf="chart.chart_id === 10"
                                                                src="./assets/images/Tiled view sheet icons/donut-tiled-icon.jpg" alt=""
                                                                class="rounded-circle-copilot">
                                                        </span>
                                                        <span>{{ chart.chart_title }}</span>
                                                    </button>
                                                </div>
                                                <div class="error-mgs" *ngIf="!chartSuggestions || chartSuggestions.length === 0">
                                                    <a class="cursor-pointer" *ngIf="!qrySetId" (click)="goToConnections()" ><span
                                                        class="add-txt text-info">Connect to DataSource</span></a>
                                                    <p *ngIf="errorMessage" [innerHTML]="errorMessage">{{ errorMessage }}</p>
                                                    <p *ngIf="errorMessage1">{{ errorMessage1 }} <a style="cursor: pointer;color: #05aff8;" (click)="routeConfigure()">Add GPT API KEY</a>to proceed.</p>
                                                </div>
                                                <div class="input-group mt-3 inp">
                                                    <input type="text" class="form-control p-1" [(ngModel)]="userPrompt" placeholder="Enter your prompt">
                                                    <div class="input-group-append">
                                                        <!-- <button (click)="startVoiceRecognition()" style="height: 33px; width:33px"> <img
                                                                src="./assets/images/microphone.svg" alt="Micro Phone" /> </button>
                                                        <button class="btn btn-primary inp-send" (click)="sendPrompt()">></button> -->
                                                        <button type="button" class="btn  btn-icon btn-primary-light rounded-pill" (click)="startVoiceRecognition()">
                                                            <i class="fe fe-mic"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-icon btn-primary brround" (click)="sendPrompt()">
                                                                <i class="fa fa-paper-plane"></i>
                                                            </button>
                                                    </div>
                                                    <!-- <p></p> -->
                                                     <br>
                                                    <p style="font-size: 0.6rem;" class="mt-1">The art of chart suggestion: not magic, but data-driven</p>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="panel-body tabs-menu-body p-1 panel-body-h" >
                        <div class="tab-content">
                            <div [ngbNavOutlet]="nav"></div>

                        </div>
                    </div>
                </div>
            </div>
           
        </div>
        <ng-template #viewQueryModal let-modal>
            <div id="largemodal" tabindex="-1" role="dialog">
                <div class=" modal-lg " role="document">
                <div class="modal-content">
            <div class="modal-header">
                <h6 class="modal-title">Query</h6>
            </div>
            <div class="modal-body viewQuery-hgt">
                
                <div class="form-group select2-sm">
                   <p>{{tablePaginationCustomQuery}}</p>
                </div>
            </div>
            <div class="modal-footer">
                            
                <button type="button" class="btn ripple btn-secondary" (click)="modal.close('Save click')">
                    close
                </button>
                <button type="button" class="btn ripple btn-primary" (click)="copyQuery(); modal.close('Save click')">Copy <i class="fa fa-copy"></i></button>
            </div>
            </div>
        </div>
        </div>
        </ng-template>
    </div>
}

